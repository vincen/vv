# 1. 引言

## 1.1 目的

此设计说明书对象功能设计进行详细说明，目的是确保对需求的理解一致。

## 1.2 参照

此文档是《网上商城概要设计说明书》的进一步深化。

阅读此文档前，应阅读《网上商城需求规格说明书》《网上商城概要设计说明书》。

## 1.3 范围

本文档所描述的需求，仅限于网上商城平台中的：外业需求，和内业需求中的运营需求[^1]。

## 1.4 读者对象

本文档读者对象是所有软件产品，设计，开发，测试，运营人员。

## 1.5 术语

参见《网上商城术语说明书》

# 2. 角色定位

就网上商城系统使用者而言，有三种角色：

1. 商户（包括自营商户）
2. 平台管理者（运营人员）
3. 消费者（公众）

## 2.1 平台管理者

1. 展示并提供网上商城的相关业务；
2. 吸引更多的商户来入驻，并实现入驻业务处理；
3. 规定好所有的商品分类，以供商户选择经营；
4. 商品订单的物流配送和支付管理；可通过权限控制使用权的期限；
5. 与商户之间存在财务结算的过程；与商户的对账体现在系统生成的报表。
6. 对消费者涉及到宣传、售后以及平台服务等内容；需要协助商户；
7. 对整个平台的运作进行全局控制和管理；

## 2.2 商户

平台的商户是指使用网上商城进行网上销售与服务的产品商户。他们接入网上商城的方式是通过一个网上商铺系统，让这些商户在网上经营。

### 2.2.1 商户店铺

网上商城提供一个网上店铺平台，商户可以：

1. 管理自己的店铺，设置商品的介绍和价格以及各种促销信息。
2. 提供商品在平台上商品的上下架处理；
3. 在有订单的情况下，进行备货处理以及相应的出货管理；
4. 与平台之间的财务结算和促销支持等；
5. 协助售后服务管理。

## 2.3 消费者（公众）

而就消费者而言，消费者来网上商城是为了购买商品的，所以他们需要：

1. 一个挑选商品的网上商城站点；
2. 可以针对商品在线提问；
3. 能够在网上下单；
4. 提供在线支付的渠道；
5. 可以对平台的服务进行投诉或表扬；
6. 拥有自己的个人管理空间，记录自己喜欢的商品，查看自己订单进展。

## 2.4 组织结构

网上商城在运营中分成两级管理结构，依次是运营平台、商户。两者的关系如图所示：

![8-2-1](/Users/vincen/Work/vv/1.0版本-update/8.网上商城深化设计/8-2-1.png)

1. 运营平台：

对平台进行统一管理。主要是制定产品分类、规定产品分类属性、权限设置等。拥有所有的管理权限。

2. 商户：

运营平台授权商户在平台上运营销售商品。商户主要工作是对本身商品进行上下架、维护商品价格、相关商品设置、商品推荐发布、分类信息发布、广告设置、订单处理、配送方式设置、支付方式设置、商品库存的查看等统一管理工作，并完成网上订单有效性确认、分配等工作。

## 2.5 盈利模式

建立平台的最终目的是盈利，现有模式如下：

1.	收取交易佣金
* 增值业务收费
* 自营商品盈利

# 3. 系统详细功能

## 3.1 系统功能框图

![8-3-1](/Users/vincen/Work/vv/1.0版本-update/8.网上商城深化设计/8-3-1.png)

## 3.2 运营平台的职能

运营平台拥有绝对的权限，可以全面管理商城系统中所有的日常事务。主要包括：

1. 负责对商品库的统一管理

对商品分类的统一监管、商品资料的统一监管，制定商城系统的商品分类、规范商城系统的商品资料属性、进行各种商品资料数据的审核等等，最终形成标准规范的商品分类与商品资料信息。

2. 负责商户账号的建立以及相应管理操作权限管理

商城系统中，运营平台可以对商户进行独立的后台管理界面登录账号建立、各种栏目菜单的运营操作权限设置。

3. 负责经营范围配置

指定可以经营的商品品类。

4. 负责进行促销活动管理、主题馆管理、信息发布等等促销方式的监管商城的各种促销活动、主题馆组织发布、商品推荐等等，运营平台可以进行全面的监管，做日常维护操作处理。
5. 负责进行客户留言、客户投诉、客户建议等等客户服务的监管与处理

各个分站的与网络客户的沟通交流信息等等，总部都可以进行查看，并可以根据这些收集的留言、投诉、建议等等制定相关决策，使对应的分站进一步提高客户服务的质量；

6. 负责商城系统的会员管理、会员等级制定、会员等级升降级定义等等监管与处理

商城系统的网络注册用户就是通常所说的会员，会员是一笔宝贵的财富。运营平台全面拥有所有会员资料信息，并制定平台统一的会员等级制度，各个会员等级制度享受的购买优惠政策以及各个等级升降规则定义等等；

7. 负责商城系统全局资源的管理与发布，例如广告管理、推荐管理、公告板管理等等
8. 负责商城系统的订单、账务结算监管、各种统计报表查询等等

运营平台可以监管任何订单数据、返利数据以及账务结算处理，并可以查看生成各种统计报表等等；

9. 负责商城系统平台统一参数的配置、初始化以及各项任务计划的配置管理等等

## 3.3 商户的职能

商户管理系统是网上商城平台提供给商户的一套完整的操作工具。平台与商户签订合同之后，就会提供给商户一个网站的登录入口地址，以及一个商户账号和密码。商户由此可以登录进入商户系统进行各项管理操作。

* 信息管理
* 商品管理
* 订单处理管理
* 支付配置管理
* 配送配置管理
* 库存量管理
* 广告管理
* 账务查询。能够了解销售、退货、费用情况
* 套用模板管理；商户店铺套用模板的管理

## 3.4 商户的管理

### 3.4.1 进销存与财务核算

网上商城系统应支持每个商户设立自己独立进货、独立销售、独立库存管理，并可把进销存的业务单据分别导出到第三方财务系统生成财务报表。

### 3.4.2 独立进货

运营平台对属于注册商户进行管理，包括：
	商户档案管理
包括录入并审查商户的基本信息、开通商户账号、冻结/解冻商户、设置商户管理员、设置商户经营范围等等。
	商户商品管理
可以对商户录入的商品进行审核，同意或拒绝商户商品加入商品库。
	商户经营管理
可以对商户录入的价格信息、特价信息、促销信息、商品的上下架等进行监督管理，有强制商品下架的权力。
	商户退换货管理
可以对用户与商户之间的退换货进行监督管理，保证用户和商户的利益不受损失。
	商户结算管理
可以立对商户进行独立的结算。根据销售，退换货，管理费用业务数据形成对账单。

### 3.4.3 独立销售

商户对顾客的销售是独立的。顾客在哪个商户购物，销售业绩就算商户，互不干扰。所以，每个商户都有自己的面向消费者的购物前台和销售订单处理后台。其功能如下：

1. 销售前台

每个商户的销售前台都具有完整的网站拓扑架构。主要包括以下页面：

* 网站首页
* 各品类的频道页
* 个品类的商品列表页
* 商品搜索页面
* 商品详细介绍页
* 品牌专区
* 会员专区
* 特价专区
* 会员自动注册流程

2. 销售后台

销售后台即商户店铺管理系统，可以对销售前台的展现进行管理，并对订单进行处理。

### 3.4.4 独立库存

每个商户都有自己的库存管理。可以实现以下功能：

* 随时查询本商户库存。
* 进出仓记录管理。
* 盘点操作。
* 库存成本核算。

### 3.4.5 独立财务数据

每个商户可以实现财务独立核算工作，能够把本商户的进货、销售、库存数据导出成财务凭证。通过把财务凭证导入第三方（如：用友财务系统），生成成套的财务报表。

### 3.4.6 商户的冻结

在网上商城系统中各个商户直接和运营平台签订合同，商户与商户之间没有任何关系。平台拥有自己独立的商户日常运营维护的全面监管与把控。商城系统提供商户的冻结功能。

商户处于冻结的时候，用户在本商城前台网页浏览的时候，将不可见任何关于此商户的一切运营数据资料。商户的运营状态主要有：0：标识默认建立阶段、1：标识正在运营、2：标识已经冻结。

运营平台管理员也可以针对某个商户进行单个商品的销售终止，例如可以将商户A正在经营的商品P，进行销售终止。

## 3.5 商户店铺管理系统

### 3.5.1 商户系统概述

商户店铺管理系统是网上商城平台提供给商户的一套完整的操作工具。网上商城的运营平台与商户签订合同之后，就会提供给商户一个网站的登录入口地址，以及一个商户账号和密码。商户由此可以登录进入商户系统进行各项管理操作。

商户在这个系统中可以完成的操作包括：

* 信息管理
* 商品管理
* 订单处理管理
* 支付配置管理
* 配送配置管理
* 库存量管理
* 广告管理
* 套用模板管理；商户店铺套用模板的管理
* 把新商品信息录入网城的商品库。
* 在商品库中挑选商品进行经营。
* 查看自己正在经营的商品。
* 设置自己经营商品的价格。
* 对自己经营的商品进行上下架操作。
* 设置特价促销。
* 设置赠品信息。
* 设置相关配件。
* 设置捆绑销售促销。
* 查询并处理未处理的订单。
* 查询已处理过的历史订单。
* 账务查询。能够了解销售、退货、费用情况。

## 3.6 商品管理

### 3.6.1 新商品录入

网上商城具有统一商品库对商品进行统一管理的功能。因此，当某商户结束了与我们的合作，其以前经营过的商品被系统下架，但不删除商品信息。待新商户签署合同、开通账号后，开始部署商品时，可以从这些已经下架、无人经营的“孤儿商品”中挑选出自己即将经营的、已经存在于商品库的商品，捡回到“我经营的商品”中。这样更有利于商品的多样性。

捡回的商品可以重新编辑；新录入的商品会在“我经营的商品”中等待审核。

流程：

![8-3-2](/Users/vincen/Work/vv/1.0版本-update/8.网上商城深化设计/8-3-2.png)

#### 3.6.1.1 商户选择新商品录入

首先进行品类选择。如图：

** 产品草图1 **

在新商品录入的主界面中，商户根据自己经营的商品，按照品类进行检索。由于系统对商品是支持无限级分类的，而且是品类与品牌交叉分类，因此，选择一个分类，就会在后面显示其次分类列表，直至分类结束。同时，系统选出该分类下对应“品牌分类”中的品牌。对于商品库暂时没有的品牌，可手工输入。即刻创新新品牌分类。

系统有记录商户选择品类习惯的功能。商户经营的品类，在第一次选择后，即被记录到“您经常选择的品类”一项中，以后商户再添加新品，就可以直接在此选择了。

当选择了其中的一个品类，点击继续，系统将返回一个“商品库查询”的结果。里面包含了商品库中，该品类下的所有商品。包括已经有商户经营的上架商品，和没有商户经营的已下架的“孤儿商品”。

* 如果有商户经营，图片下有“正在经营”字样，可将商品选入“我正在经营的商品”中。
* 如果无商户经营，可将商品选入“我正在经营的商品”中。

商户可以从页面上直观地看到这些商品的标准名称和图片，点击商品的图片，就可看到商品的详细信息。商户确定该商品和自己即将经营的商品一致，即可将商品捡回到“我经营的商品”中。

如果该分类下没有商户要经营的商品，商户直接点击“重新添加”按钮。进入下一流程。

#### 3.6.1.2 商户添加全新的商品

商户在选择好分类并在该分类下添加新品时，会在主窗口中看到商品信息页面。商品信息页面分为四个区域：商品名称区、属性区、描述区和商户信息区。

** 产品草图2 **

1. 商品名称区：在此定义商品的标准名和个性名。

* 商品标准名。标准名由系统自动生成。是用来描述商品信息的。包含品牌、品类、系列、规格和商品编号。当商品没有个性名的时候，系统才显示商品的标准名。否则，商品个性名优先显示。
* 商品个性名。个性名是商户为了吸引顾客，而为商品赋予的一个用以宣传的生动、可爱的名字。类似淘宝网的“宝贝标题”。

2. 商品属性组区：在此定义该品类下商品的各种专有属性。
3. 商品描述区：商户在该区域内自有编辑对商品的描述内容。该编辑器对图文混排具有良好的支持功能。
4. 商品备注信息区：部分商户有具有自己对商品的编号，例如超市的MIS货号，也在此输入。

** 产品草图3 ** 

修改商品信息的页面，与该页面相同。

商品录入后，可直接将操作标签切换到“价格管理”或“捆绑销售”等其它操作项，继续操作。同时，商户可以在“我经营的商品”——“未经审核的新品”标签中，看到这些商品。

在未选择任何排序方式的前提下，未经审核的商品按照时间顺序由近到远排列。当然，商户此时可以点击商品条目后的“详情”修改商品信息。

### 3.6.2 我经营的商品

该模块为商户提供对商品的价格、相关商品、赠品、配件、特价和上下架等业务操作。

该栏目主要有三个标签：在售商品、下架商品、未经审核的新品。

在售商品是商户正在上架销售的商品，列表中每行显示一条商品记录。在列表中显示商品的货号、商户货号、商品缩略图、所在品类、品牌、名称、售价和扣率。

**价格设定**

商户在输入商品信息后，可直接将操作标签切换到“价格管理”，进行价格的设定。被录入的商品并不能立刻设置价格上架销售，而需要通过网站管理员的审核。该功能见《新品审核》功能模块描述。

设置好价格的商品，需要等待价格及扣率的审核，这时商品仍然没有录入商品库，商户可在“未经审核的新品”标签中看到其状态为“审核中”。

**商品上架/下架**

**上架：**

商品在录入商品库，通过审核后，即可由商户安排上架销售。
在“我经营的商品”中选择“下架商品”标签，可看到所有下架未经营的商品。

点击商品记录后面的“上架”链接，将直接进入该商品的详细页面中的“上/下架”操作标签。设置上架状态。

**下架：**

点击“在售商品”操作标签，每条商品记录后都有一个“下架”操作链接，点击该链接，可进入商品详细页面中的“上/下架”操作标签。其表现形式与上架相同。

所有的下架商品默认按时间顺序由近到远排列。最近下架的商品，排在前面。

**特价管理**

商户可根据自身经营需要对其经营的某款、某类、某系列的商品设置特价经营。在设置特价经营后，其扣率将发生变化。因此，对于商品特价经营，网站将采取“申请——审批”制度。即商户设置特价后，该商品自动下架，进入审核序列。当管理员审核通过后，以特价经营的商品，在“在售商品”标签中，以红字显示售价和扣率。

点击“调价”后，网站将展开一块，商户可直接在此添加调整价格、扣率、特价开始和结束的时间。 

**赠品设置**

商户可以在录入商品的信息、价格的同时，通过顶部的“赠品管理”标签进行自由文本的编辑。

**相关商品/配件设置**

商户可根据商品属性、用途、搭配来为商品设置相关商品及配件。商户点击“配置相关商品”按钮，即可手动为商品添加相关商品或配件。

在商户未手动配置时，系统会自动从某商品所在品类中找出同类商品作为相关商品在前台展示，但是为了更好得运用这种关联销售，商户要根据商品的实际情况来手动配置。

在相关商品中，除了可以配置相关商品，还可以配置相关配件。推荐流程在后台是相同的。在商品详细页面中，清楚地查看到当前商品所相关联的商品，设置前台排列顺序和或者删除关联的商品，另外可以从商品库里搜索商品加入到相关商品推荐的列表中去。

**捆绑销售**

捆绑销售其实是相关商品配置的一种结果。在配置相关商品的时候，选择“相关类型”为“捆绑销售”，即可将所选择的商品进行联合，再在页面中显示。但捆绑销售与相关商品不同的是，相关商品以列表形式表现，而捆绑销售则表现出商品的合计价，并提供购买的按钮。点击按钮后，系统同时将两款商品放入购物车。

**返利管理**

返利管理用于向商户提供应返利商品的查询结果，商户可将其作为返利的依据。

## 3.7 订单管理

### 3.7.1 订货单

商户所看到的订货单就是由用户向商户下的订单。商户接收到这些订单时，需要备货，等待物流前来拿货。

1. 商户查看订货单的操作界面，只能够查看订货单的情况，没有修改状态的操作。

2. 需要区分未发货的订货单数量。
3. 每个订货单可以展开查看明细。
4. 点击订货单号，可以打开提货单页面，在此页面可以打印提货单。打印格式详见“账务系统”关于提货单打印的描述。

### 3.7.2 退货单

商户看到的退货单，也是由用户提出的退货单。管理界面与订货单类似。商户管理员有查看的权限，没有修改状态的权限。

1. 商户查看退货单的操作界面，只能够查看退货单的情况，没有修改状态的操作。

2. 需要区分未退货的退货单数量。
3. 每个退货单可以展开查看明细。
4. 点击退货单号，可以打开退货单页面，在此页面可以打印退货单。打印格式详见“账务系统”关于退货单打印的描述。

## 3.8 账务管理

### 3.8.1 未结账款查询

未结账款查询是让商户看到还有多少款项没有跟网上商城平台结算，也就是还没有生成对账单的部分。

### 3.8.2 历史对账单

对本系统来讲，结算是指已经生成了对账单。历史对账单可以查询到过去生成过的所有对账单。

## 3.9 商品管理系统

在商城系统中，商品的管理好坏，资料的齐全直接影响到业务的运营与开展，对于成千上万甚至是更大的商品信息，商品管理系统提供了快速有效的解决方案。
商品的分类管理、商品资料的录入维护、精美的商品图片、灵活方便的价格设置等，是网上商城平台系统的核心组成部分。

### 3.9.1 无限级商品分类管理

商品的类别是商品的重要属性之一，也是消费者比较习惯的寻找商品的方法。大多数浏览者具有以商品分类为导向的使用习惯。

那么，在网站上，考虑到客户操作的便捷性以及由此而来的购物愉快体验，如何让客户在第一时间看到自己想要的商品，我们应该怎样把客户需要的信息以最方便的途径提供给我们的客户，这成为必须首先考虑的问题，也就是说，需要我们对商品进行最合理的分类。

本节从系统实现上进行描述商品管理系统中的无限级分类功能。

系统采用树状结构来排列商品分类，支持无限级的扩展，商品的类别可以动态增加，商品类别的名称可以随时修改调整，为了保证删除的正确性，系统针对商品类别的删除，进行了慎重控制，一般是不可以随便删除的，如果某一商品类别下有商品，则该商品类别是不可以删除的。即客户在日后的经营中可以动态自定义增加、修改、删除需要的商品分类，动态进行业务品类的经营支持。

### 3.9.3 商品交叉分类管理

在商品分类管理中，我们可以根据不同的分类标准来对商品进行归类设置。

例如我们参考医药行业客户的大型商城系统：药店的商品分类一般可以分成：西药、中成药、美容护肤等等；而同时按照另外一种分类 “品牌”来分，又可以分成：诺华制药、阿斯利康、同仁、辉瑞制药、薇姿等等。这样就会存在一个商品对应多个商品类别的情况，比如既可以属于“抗生素”栏目，也属于“同仁”栏目，这就是业务中的商品交叉分类。

系统提供针对任何某个分类下的商品将其灵活方便的设置到其他任何另外一个分类下的功能。

### 3.9.4 商品属性及属性组管理

商品属性是指每种商品特有的性质。

通过网上商城销售的商品是琳琅满目的，每种商品都存在着某些自己特有的性质。例如，网上出售缝制设备商品，则有用途、功率、最高缝速等特性。

在定义描述商品的数据结构时，我们不可能把所有的商品都定义成共同的属性。但是，如果我们把商品的特性都通过自由文本来描述，那么我们就很难在自由文本中对商品的共同属性进行归类对比。例如，显示器，同样是显示器，就会存在最大分辨率，扫描频率等可比较的指标。客户购买显示器，实际上必须对商品的技术指标、特性进行比较，从而选出最能满足自己需求的商品。

商品属性定义数据结构可以解决对不同商品的性质的描述问题。对同质的商品，往往都有一系列相同的商品特性，这一系列的特性就叫做一个属性组，可以用于指派给全部同质性的商品。

属性与属性组的概念简化了商品的输入步骤。一般同类型的商品属性是可以继承的，所以当同类商品输入了其中一个之后，其他商品都可以继承该商品的相同属性，只要稍微修改一个其他不同的属性值就可以完成商品的输入工作。

商品属性和属性组的管理是由专门的商城管理员来完成的。

商城系统从商品的文字描述、具体数字化的性能参数、不同类型的美丽个性化图片到声音、多个附件、二进制文件等等基本完全支持所有不同类型的商品资料信息的录入。

### 3.9.5 关键属性管理

关键属性是指商品最重要的几个特征参数。例如，墨盒的颜色，洗衣机的容积，电脑的CPU类型等。关键属性在用户进行商品搜索、商城进行同类商品推荐中起到非常关键的作用。

标准值，通常就是指我们对商品描述过程中需要进行严格的参数输入的规定，即参考值。

每个关键属性根据属性的不同类型定义了标准值的配置管理。

### 3.9.6 商品按属性比较

在真实的百货商场，顾客总是喜欢在众多商品之间不断寻求对比，精挑细拣以此来找到最满意的货物，线下比较的方式通常是顾客直接在柜台上将几种商品的说明书或者实物拿出来进行对比，并在销售人员的帮助与建议下进行选择购买。

本系统在整个商品网上销售过程中，根据商品自定义属性以及自定义属性组机制，提供了强大灵活的各种商品之间的比较功能，使用户在浏览网站商品的时候将挑选到的商品进行方便详明对比，直到找到自己最中意的商品。

### 3.9.7 商品图片处理

#### 3.9.7.1 商品自动生成缩略图功能

在商城系统中，同一个商品往往会在不同的页面/位置展现出来，而不同的页面/位置所需要的图片规格不同。如果是每个规格的图片都上传一张，管理员的工作量就会很大；如果只是上传一个图片，那么就不可以适应不同页面/位置的不同规格了，最后严重影响了浏览商品的效果。

有了自动缩略图功能，管理员就只需要维护商品大图就可以了。因为系统会自动生成产品的缩略图，并严格与大图同步。产品图片处理是商城日常维护中一个极为烦琐的工作，此功能对减轻人员工作量，减少差错率非常有帮助。

### 3.9.8 商品自动生成水印功能

一般较大型的商城系统的图片都会有自己的标志，也就是我们所说的水印，在商品录入图片的时候，可以选择是否打上水印，同时选择要使用的某张水印图，系统则会根据所选择的水印自动打到商品图片上面。一般需要打水印的图片就是商品详细页的图片和商品大图。

### 3.9.9 商品按属性搜索

现在许多网上商城都有类似全文检索和按照价格的搜索功能。表面看，实现的操作与功能大同小异，但是深入进行分析，我们可以得出各个网站系统在全文检索体现出来的信息详细性、准确性、快速性等就会存在差异，有些性能卓越，有些性能简陋。那么在我们的商城系统中是怎么样体现的呢？好！那么现在假设您想要买一款价格2000块左右的直板带摄像头手机，那么您怎么做？
通过简单的全文检索，您发现，搜出来上百条商品，一堆的您不感兴趣的手机款式，甚至压根不是手机，这时，您是否会抱怨商城的搜索功能太弱，而影响了您的购买欲望呢？
现在我们分析系统是怎么处理这种情况的：
首先，我们在价格范围框里面输入1800-2300；
接着，如图，输入我们感兴趣的这些信息，点击搜索，看着结果都是自己感兴趣的商品，每一款搜索出来的商品都对自己充满诱惑力，是否觉得这时的购买欲望大增？

那么再看看搜索数码相机，又是一个什么结果？如图：

同样可以对数码相机进行极其精确的查找，把您最感兴趣的商品呈列在您的面前，您自己慢慢对比吧，充分享受淘商品的乐趣。
现在，我们从一个技术的角度来分析这一功能：
能够实现这样的功能，从根本上来说，按属性搜索是基于产品的关键属性来实现的，也就是说只要配置好产品的关键属性，则可以根据关键字对关键属性进行搜索，例如我们可以将这些商品属性生成索引文件，实现全文检索。
不同的类别可以按照不同的属性来进行搜索；如果其他电子商城的商品录入只是简单的在商品描述里录入资料，是没有办法实现根据每个商品的最小属性特征进行检索这些功能的，在整套商城系统中，属性的概念，使我们得到很多好处，不光光是智能搜索，上文提到的商品比较也是建立在属性的基础上的。如果不是在系统架构层面上做到这一点，是很难实现这些功能的，就算实现，也可能带来您更多额外或重复的配置工作。
2.4.8	商品组合设置（DIY）
什么是商品的组合？在电子商城系统中是如何定义与支持的？
我们先来考察企业的实际运营业务中，有时一个完整的或者所指的单件独立的一个实物商品是由多个部件组成的或者就是一个部件组成，而每个部件在企业的商品体系中同时也是一件单独销售或者不可以单独销售的商品。
例如，我们比较容易理解的电脑，我们买某个型号的品牌机，它是一件单件独立的商品或者说是一个特定的组合，可以直接用来销售。品牌机商品是由显示器、机箱、鼠标、键盘等组成，它们也是单件独立可以用来销售的商品，甚至，机箱中的主板、CPU、内存条、电源风扇等也都是单件独立可以销售的商品。同样，这些商品中有些可以指定是不可以独立销售或拆分的。
商城系统的商品体系中已经针对这种商品组合的应用提供了强大的解决方案。

商品组合的概念，主要包括：组合商品、部件、商品。
商品，就是我们通常所说的单件的商品，概念上是一个不可再进行拆分的原子商品或者运营规范中规定的单件整套商品，即组合商品。原子商品就是我们通常所说的单件商品、零件、附加配件、碟片或者碟片中的某个曲目。组合商品可以由多个原子商品或者其他组合商品组合而成，例如针车整机（针车整机包括不同的部件，每个部件又包括很多个零件）。
部件，主要是针对组合商品所定义的，一个组合商品可以包括多个组成部份或者部件。例如我们众多客户中某个销售针车的大型电子商城系统项目中有高速平逢锁眼缝纫机产品，包括头部外装关系、上轴关系、下轴关系、压脚提升架、绕线器组等组成部件，每个部件包括很多不同的零件。部件一般不是独立的可销售商品，而是描述商品的某个组成成份，每个部件也可以由一个或多个商品组成。（如果部件可以作为销售的商品，那部件就是一个组合商品。）
在网上商城系统中，例如上文提到的销售针车的商城系统中整机商品，就是一个普通的商品即原子商品，在进行管理这个整机同时，可以通过各个部分分为很多的零配件，每个零配件同样是一个原子商品，并且具有自己的不同于整机的分类属性信息，例如每个零配件会有对应的国际编码，那么就可以做到分别销售单个零配件而不仅仅是整机。
2.4.9	商品相关性设置
通常，在用户浏览某一个商品的时候，往往会想到这一类近似或者有联系的其他商品与信息，比方说在专门销售打印机耗材商城系统中浏览打印机的时候，会想顺便浏览墨盒、硒鼓或是同个系列/配置的其他商品。
商品的相关性是指当前关注的商品与其他商品或者信息的关联关系建立，主要包括两种商品与商品、商品与信息的相关。
因此系统管理员根据客户的这种要求，将更多的商品以及信息推荐给用户。
2.4.9.1	商品与商品相关
商品与商品的相关，在商城系统中主要体现为商品属性资料之间的相关、商品品牌之间的相关、商品价格之间的相关。管理员可以根据这些相关性手工建立商品与商品的相关。
例如，在商品与商品相关的业务模式中，一般会存在商品列表相关和最佳组合相关。
商品列表相关
就是通常意义上将与此有关系的其他商品建立相关，推荐给客户。
如图所示：

最佳组合相关
针对某一个商品添加最佳组合商品，添加的时候选择一系列的商品进行捆绑销售，出售价格为组合的商品价格之和。例如：与商品A捆绑的商品B和C，A的价格为X，B的价格为Y，C的价格为Z，页面上显示A+B+C的价格为W（W=X+Y+Z）。前台用户在浏览商品详细页的时候，如果该商品有配置最佳组合商品，则在商品详细页的商品图片下显示最佳组合商品。
如图所示：

2.4.9.2	商品与信息相关
商品与信息的相关，在商城系统中主要体现为商品属性资料与信息的相关、商品本身与信息的相关。系统管理员可以根据商品的某个重要的属性参数或者商品本身，手工配置相关的介绍文字信息、咨询信息等。
例如，某个数码相机是单反的，那么管理员可以将“什么叫做单反？”的咨询信息与它关联，当用户订购这款商品的时候，如果对单反这个技术参数不是非常了解，直接就可以通过信息相关找到知识点。
2.4.10	商品配置管理
系统的商品是统一由总站管理的，对于多分站系统可以分配权限给区域管理员对属于自己的经营范围的商品进行上下架管理、价格配置、促销配置、商品附件属性、商品相关性配置、商品查询、商品参数资料维护、商品多分类配置等各项维护操作。
其中比较重要的是：
上下架管理：管理员可以对每个商品进行上下架设置，下架的商品不会出现在前台，并不能进行订购。
是否可卖管理：管理员可以对每个商品进行是否可卖设置，上架不可卖的商品在前台只提供展示。
系统提供批量设置商品上下架或者是否可卖的。
2.4.11	商品点评管理
商品点评是指会员浏览前台商品资料信息时，对商品发表自己的评论、见解或者感想。商品点评的前台体现请见本书的会员管理一节的详细描述。
商城提供集中式的商品点评管理，管理员可以通过后台针对每个商品所有的商品点评进行审核以及发布，并可以对每个点评提供集中式的留言回复管理。
2.4.12	同型多样商品管理
同型多样的商品指的是同样一种型号的商品，它可能有不同的颜色/大小。例如，最常见的是服装类的商品，同一款式的衣服有加大码，大码，中码和小码。虽然是同一款商品但它的价格可能不同，并且它们有各自的库存量。
商城系统中通过设置分类商品的属性实现了同型多样商品的管理功能。同型多样商品的设置的流程是这样的：
1.	选择某一个分类，增加该分类的属性。
	.	然后，为新增的属性增加几个标准的属性值。
	.	同型多样商品的价格设置，在该分类下该商品的价格设置中，就会多了商品属性选择这一项，选择某一个属性后再标定该商品的价格。
	.	同型多样商品的库存设置，同样地在商品的库存管理中同样包括了商品属性这个选项，不同属性对应不同的库存。
示例：
一款诺基亚N95，它有黑色与银白色两款，并且内置存储容量有2G 版 与8G版 ，不同颜色/内存对应不同价格与库存。
在后台商品分类管理中选择“手机”分类，为其设置“颜色”与“存储容量”两个属性，然后设置属性的标准值，颜色：黑色、银白色；存储容量：2G、4G、8G。这样在诺基亚N95的价格与库存配置下面就会出现属性的选择。

	.4.13	商品起订量管理
商品的起订量，指的是允许用户订购某件商品的最小数额。通常的情况下，用户在商城中订购商品的数量是没有限制的，可订购任意数量的商品。在系统中可以定义某个商品分类或者是某件具体的商品的起订量。对于设定了最低订购量的商品在商品前台会有提示信息，购买只有选购等于或都超过该商品分类的起订量，才能下订单。例如，系统设置了商品“泰奇八宝粥 370g”的起订量为5，那么在商城前台该商品的详细页面中会有一个明显的说明文字，标明该商品最低起订量，如果用户将该商品加入购物车的话，系统会默认订购的商品数量为5，当然用户可以在购物车中修改该商品的数量，但必须是要大于5的数。
	.4.14	商品的标签管理
为商品库中的每一件商品都定义标签，通过设置商品标签可以将商品关联起来，更加方便客户找到自己想要的东西。标签的设置使得具有某一特性的商品灵活地有效地联系在一起。系统通过标签的内容来搜索商城中与标签相关联的商品信息。
商品建立标签有两种方式：
一种是从定义好的标签库直接勾选；
另一种是管理员自由录入。
标签库的标签分类进行管理，可以自由添加和删除，标签库的引入的好处是可以重复利用，为录入省去了时间。另外标签自由录入，又可以根据管理员的不同想法加入，完全没有局限。

	.4.15	商品品牌管理
商品品牌其实是商品交叉分类的一种应用。在商城系统中，商品的品牌就当成是商品分类的一种。在后台管理栏目中不同于其它商品分类的是，商品品牌分类栏目有一套不同于其这商品分类中的属性。例如，一个品牌它通常有自己的形象LOGO，这部分通过在后台设置栏目的扩展属性来实现。
在商品的管里中可以将商品添加到指定的品牌栏目下面，具体的设置方法可以参看前面几中提到的“商品交叉分类管理”的相关说明。
	.5	价格管理系统
商品的销售，是离不开价格定义的。从价格定义模式，主要分为根据会员等级以及各个等级对应的价格折扣优惠来进行系统价格策略的配置方法。
商城系统提供针对任何一个商品进行多个价格的配置管理，例如市场价，国家销售价、门店销售价、最低限价、会员价、VIP会员价、银卡会员价、金卡会员价、特价等。
下面我们具体描述商城系统提供的价格配置操作以及价格在前台显示规则。
	.5.1	价格设置
每个会员等级对应的价格，在很多时候，是需要一种策略支持来进行调控的。商城系统的价格管理可以根据每个会员等级对应的价格、或是某一会员的价格、也可以根据独立的价格（与会员等级无关，例如市场价，门店价等）进行设置。

	.5.1.1	自定义多价格设置
如上图所示，对每一个商品进行价格设置，需要设置以下内容：
价格类型：可以选择是会员各个等级的价格或是参考价格等。
价格：该价格类型对应的具体价格。
币种类型：可以选择对应价格的币种，比方说：人民币、美元、港币、积分（特殊的币种，用在商品的积分赠送和积分兑换）、……。
方向：有“扣”和“送”两种，例如，购买商品A可以获得n积分，那么在配置价格的时候要添加多一个价格，币种类型是“积分”，方向选择“送”，就表示“可以送n积分”；如果是商品兑换专区的某一个商品B，需要m积分兑换，那么配置的时候需要添加多一个价格，币种类型是“积分”，方向是“扣”，就表示“m积分兑换商品B”。
是否用于支付：对于某些商品的价格，只是用于显示，不用来支付，那么通过这个开关可以控制。比方说商品市场价，只是用来显示提供参考，设置的时候就可以选择不用于支付。
商品属性：如果同型多样商品的话，在页面中会多出一个属性选择项。不同属性可以对应不同的价格。
	.5.1.2	特价商品设置
如上图所示，对每一个商品进行特价设置，需要设置以下内容：
特价：某些价格类型需要设置特价，例如：VIP特价。
特价时间：每个价格类型的特价都对应着一个时间范围的，设置了时间范围的特价，只有在特价时间段的时候才会在前台显示特价，购买时候才可以用特价购买。
价格的配置机制比价灵活，每个商户（如果是多商户系统）对于每个商品都可以随意配置多个不同的价格，可以很灵活的应用和扩展。
	.5.2	多个价格在页面的显示规则
系统支持多个会员等级（原则上是无限等级，请见本书会员管理一节中关于会员等级管理部份说明），对应的会员等级都会有不同的价格，而在不同页面显示价格的位置、侧重点都不同，所以，我们定义了在所有需要显示价格的页面的价格显示规则：
商城系统前台的每一款商品，显示的价格主要有市场价、网购价或您的价格、享受的折扣、节省金额、购买本款商品可获得的积分（见上文，也是一种特别的价格）。
因为一次性把所有的商品价格显示，会让页面美观、客户体验变得非常杂乱而且也没有必要，因此系统前台价格的显示需要区分客户是否已经登录。
在客户未登录商城系统浏览商品的时候，商品的价格信息只会显示：
市场价：￥98.00  网购价：￥88.20 获得积分：积分88
如果客户（会员）已经登录商城系统进行浏览商品，那么系统会自动的从后台众多价格等级中选择一个与会员等级身份相匹配的价格，并显示所享受的折扣以及节省金额：
	市场价：￥98.00  您的价格：￥88.20  折扣：90折 节省：￥9.80  获得积分：积分88
商城系统只支持会员登录系统后才可以进行交易，默认以普通会员价进行订购。
	.5.3	价格导入
商城商品的价格实现了与第三方系统的对接，可以直接从ERP/SAP中的价格导入到商城系统中。关于价格导入的具体实现，请看下文关于商城系统与第三方系统对接部分。
	.6	会员管理系统
用户是企业最大的宝贵财富。收集用户信息、分析用户行为、人性化的服务提供、各种价值提升与挖掘，都是建立在用户基础之上的。会员管理是专门面向用户提供的交互窗口和客户管理中心。
会员的类型主要分为三种：
	)	普通会员
	)	大客户
商城系统的会员管理系统主要分为专门针对前台会员专区、后台会员管理两个系统。
	.6.1	普通会员专区
普通会员专区是专门提供给前台用户使用的，由用户自己进行维护相关资料信息。主要包括会员的:
	)	注册与登录
	)	会员订单管理
	)	支付帐户管理
	)	积分的查询管理
	)	会员相关个人资料管理
	)	会员找回密码功能
	)	会员与系统站内短信互动
	)	会员的收藏
	)	个性化推荐
	0)	……

	.6.1.1	会员注册与登录
网络用户访问商城前端网页，可以通过网上自助注册或者电话注册的方式申请成为系统的各种类型的会员。其中：
	)	普通会员无须管理员审核即可马上注册成功，并可以进行订购商城商品；
	)	会员可以用登录帐号或者Email直接对应登录密码进行登录；
	.6.1.2	会员订单管理
商城会员在会员专区可以管理自己的订单数据。主要包括：
购物清单
实际上就是被保存了的购物车。如果客户经过挑选的商品，未来得及买单，或者在线支付失败，那么其购物清单可以保存在这里，下次登录后可以继续执行支付过程。如下图所示：

最新订单
保存商城系统管理员正在处理过程中的订单数据，会员可以根据订单处理流程在这里查看订单的处理情况，同时如果商城管理员还没有处理自己的订单，可以在这里取消订单。如下图所示：

历史订单
商城会员已经成交了或者已经取消作废的订单数据，可以从这里查询到。如下图所示：

缺货登记
如果会员看中的商品没有货，可以通过缺货登记来通知网站管理员。提交的缺货登记记录保存在这里。如下图所示： 


2.6.1.3	会员积分管理
商城会员可以在此查询自己的积分帐号情况。主要包括：
积分余额查询
会员可以登录到会员专区查询自己积分余额；如图所示：

积分使用日志查询
查看自己的积分交易日志记录；如上图点击消费积分查询积分的使用情况。
2.6.1.4	会员资料管理
会员资料管理主要包括注册信息资料维护、修改密码、找回密码问题设置以及找回密码。
注册资料维护
会员的注册资料信息主要包括：
1.	登录帐号（必填）
	.	登录密码（必填）
	.	用户名称（必填）
	.	邮箱（必填）
	.	固定电话
	.	移动电话（必填）
	.	联系地址（多个地址本信息）
	.	邮编
	.	所在城市
如下图所示：

修改登录密码
会员可以更换自己的登录密码，设置登录密码必须验证原密码，并验证新密码输入是否正确。如下图所示：

找回密码
会员丢失密码后，可以找回密码。
找回密码的方式主要通过回答密码问题以及发送重置密码链接到注册邮箱找回。
2.6.1.5	会员地址簿
会员用地址簿来保存多个送货地址。这样下订单时，就不需要每次都敲很长的地址，录入过一次，下一次只需要在地址簿里面选择输入即可。如下图所示：


2.6.1.6	会员信息中心
信息中心是会员与网站管理员，会员与会员之间交流所用到的文字收发工具。而网站也可以通过站内信息向会员发送促销信息，回应会员的投诉和建议或者咨询。
这里采用类似邮件的展示方式来管理信息的收发。如下图所示：


收件箱
用于保存其他人发过来的信息。例如网站管理员发送的咨询回复，其他好友发过来的站内信。
发信息
用于发送站内信。可以在这里发送投诉和建议。
已发送信息
已经发送的站内信，保存在这里。
2.6.1.7	信息订阅
会员可以订阅商城的商品或者促销信息。满足订阅条件的商品和信息将会通过群发邮件的方式发送到订阅会员的邮箱。同时，订阅的信息也会发送到用户后台的个性化推荐区。
信息订阅时，对商品类别的选择，可以到达第三级分类。客户可以按照大类选择，也可以进入下一级小类，对选择的分类进行细化。这样会员能够更加准确地表达自己的需求。
用户选择了订阅的分类之后，除了在个性化推荐区会显示被推荐的商品外，客户还可以收到订阅分类的商品推荐邮件。邮件中，通常列出不超过5个商品，更多的商品可以通过点击链接，返回到网站浏览。如下图所示：

2.6.1.8	邀请好友
用户可以通过推荐好友的方式让更多的朋友知道本商城系统，并且从中获得相应的积分或奖励等。如下图所示：

2.6.1.9	我的专区
会员商品点评
我的点评是会员在看到商品后发布的点评的集中存放点。通常点评是在会员浏览到某个商品时发表的。
点评列表
会员点击“我的点评”菜单，进入点评列表页面。在这里可以查看到和管理自己发布过的所有点评，并且可以查看回帖。如图所示：

点评细节
每条列出的点评都可以通过点击进入查看、编辑详情以及回复。如下图：

会员商品收藏
会员在前台点击“收藏”之后的商品就会保存到会员收藏夹。前台客户收藏商品时，进入缺省分类“缺省分类”里面。收藏夹里面的商品可以重新整理类。设置方法是，客户可以在商品列表中，重新选择商品的分类。如下图所示：

2.6.1.10	会员虚拟账户
商城会员可以在此查询自己的预存款帐号情况。主要包括：
预存款余额查询
会员可以登录到会员专区查询自己积分余额； 
预存款使用日志查询
查看自己的预存款交易日志记录；如支付，获得奖励、订单退款、查看符合隶属关系会员订单的提成及奖励金额等。
预存款支付密码管理
会员可以为预存款账户设置和修改支付密码。
预存款充值提现
会员可以设置体现银行账户，申请预存款提现功能，并且可以向账户中进行充值。
2.6.2	后台会员管理
本部分主要是提供给系统管理员进行会员相关信息的维护管理操作。
2.6.2.1	会员增加与删除
后台商城系统管理员：
1)	可以手工增加会员，比如电话注册和门店注册的用户就是由管理员在会员后台管理系统中进行手工增加的
2)	可以设置审核普通会员成为大客户会员或者特殊客户会员
3)	可以将大客户会员审核成为特殊客户会员
4)	可以将特殊客户会员审核成为大客户会员
5)	对三类会员进行增加或者删除
2.6.2.2	客户来源
客户来源类型主要包括有：电话注册、网上注册、会员推荐、其它推广方式。客户的来源在商城系统的后台表现为会员属性的一种。对于商城注册的会员都有“客户来源”这么一个属性。
1.	对于网站注册的会员，系统将会自动将该会员来源记录为“网上注册”。
	.	如果是由本站会员推荐进来的注册的话，则将该其来源记录为“会员推荐”。
	.	电话注册会员，则网站管理员在后台新增是选择来源为“电话注册”。
	.	支持扩展，以后可以定义其它推广方式带来的注册客户。
客户来源的引入可以方便对会员进行统计分析，判断客户的访问的方式，为网站的推广规划作支持。

	.6.2.3	会员冻结与解冻
会员帐号可以临时冻结，也可以解冻，被冻结的会员不能进行系统登录维护自己的资料信息。
	.6.2.4	会员注册资料维护
在会员后台管理可以查询会员资料，对这个会员的信息进行查看、修改。
特别说明：
	)	管理员可以在后台标明会员身份。
	)	在后台管理员还可以查询得到会员的历史购物总金额，会员历史曾获得的积分累积及当前积分，会员登录次数，最后登录时间、产生订单总数。
	.6.2.5	会员关系管理
注册会员可以推荐自己的好友来商城注册，通过推荐发展自己的下线，并且得相应的提成或者奖励。奖励的方式可以是多种多样的，在商城定义了以下几种一种是：推荐注册员送积分。推荐会员交易获得提成，以虚拟币来方式系统将按照一定的比例，自动增加到会员的虚拟账号下面，用户可以申请提现。
会员不断发展自己的下线，越来越多，这样就形成了自己的关系网。在商城的后台的会员管理员可以查看某一个会员所推荐的会员列表，也可以查看到自己的上一级推荐会员。
会员提成/奖励的管理：
	.	注册会员积分，在会员的积分规则中加入会员推荐注册积分的选项，在这里设定推荐会员注册所获得的积分。
	.	会员消费提成，在会员订单虚拟币提成规则中，可以定义提成比率，并可以设置最大提城的额度。或者针对每一笔订单，给推荐会员固定的虚拟币作为奖励。

	.6.2.6	黑名单管理
黑名单用于限制用户的注册与登录。黑名单的增加有两种方式一种是管理后台手工增加，另一种是将已注册的用户移入黑名单中。
		管理员后台手功增加：通常的情况下，管理可以将一些敏感的名词，事先加入到黑名单中，不允许用户注册或使用黑名单中已有的名词。
		将注册会员移入黑名单：有一些注册会员在网站中不遵守相关的规章制度，例如乱发一些违法信息。这样管理员可以将该用户移入到黑名单中，不带允许该用刻登录系统。

	.6.3	会员等级管理
在商城项目中，普通会员有等级划分。其中在商城系统中普通会员等级管理主要包括四个方面：
	)	会员等级的建立
	)	会员等级的维护
	)	会员等级的价格优惠百分比设置
	)	会员等级升降级规则
	.6.3.1	会员等级建立
会员等级的设置一般可以是无限动态增加，级别之间的具体业务关系可以在商城系统中进行自定义动态配置。
通常在企业业务规划中，会员的各个等级首先就会规划好，所以，在商城系统中首先就会将会员的等级数据结构进行初始化。
例如，普通会员等级数据结构共分4级，分别为：
普通会员、银卡会员、金卡会员、钻石会员。
	)	普通会员：浏览者在商城前台注册后，就可以成为商城的普通会员。普通会员享受商城的网购价或者普通会员价。
	)	银卡会员：普通会员满足一定的条件后，即可成升级成为银卡会员，银卡会员购物时可以享受商城银卡会员享受的优惠价格。
	)	金卡会员：普通会员或者银卡会员满足一定的条件后，即可成升级成为金卡会员，金卡会员购物时可以享受商城金牌会员享受的优惠价格。
	)	钻石会员：普通会员或者银卡会员以及金牌会员满足一定的条件后，即可成升级成为钻石会员，钻石会员购物时可以享受商城钻石会员享受的更优惠价格。
	.6.3.2	会员等级维护
会员的相应等级设置，通过以下三种方式进行：
	)	网络注册的会员默认为普通会员，归属于普通会员等级；
	)	通过会员等级升降级规则，系统自动将会员归属于相应的会员等级；
	)	后台管理员手工将某个会员调整到某个对应的会员等级；
本系统会员的升降级规则请见本书会员升降级规则一节的详细描述。
系统可以通过界面来动态设置会员的各个等级以及默认的某个会员等级，设置好会员等级后，在商品列表中，选择一个商品，可以自定义配置各个会员等级所对应的价格。商品价格定义请见本书商品管理系统中关于商品价格配置一节的详细描述。
例如：后台系统有一个专门管理会员等级的栏目菜单，点击，即可动态修改、新增新会员等级。

	.6.3.3	会员等级的价格优惠百分比设置
对于系统中任何一款商品的价格设置，商城系统主要提供了两种配置方式：
	)	进行手工调整、配置各个等级的商品价格；
	)	根据每个会员等级的价格优惠百分比以及基准售价自动算出每个会员等级所对应的商品价格。
第一种方式非常灵活，可以任何时候以任何数值修改任何商品对应的会员等级价格，这种方式主要在商品管理中商品价格设置部分体现，在本书的商品管理商品价格配置一节有详细说明。
第二种方式，首先通过系统定义的各个商品的基准售价，基准售价一般是普通会员等级对应的基本价格，可以在系统中进行设定，也可以通过第三方系统的定价机制获取（例如我们某个经营耗材商城项目就是通过SAP系统的定价策略机制进行获取的）；
然后，根据建立的每个会员等级对应的价格百分比在基准售价的基础上系统自动算出相应的价格。这样，就不需要针对每个商品去手工配置各个会员等级价格。
每个会员等级对应的价格优惠百分比可以动态可调，只要调整会员等级的百分比数值，系统所有的商品对应的这个会员等级的价格将自动调整变化。
这两种方式可以任意组合使用，商城系统设置了解决两个方式冲突的控制开关，可以只让某一种方式起作用，也可以让两种方式并行工作，例如可以设置手工设置的不让自动调整机制冲掉，或者始终通过自动调整机制进行自动控制。
例如，基准售价以及会员等级的百分比可以设定如下：
基准售价：零售价 ，从第三方系统（例如SAP系统）进行接收，并根据各等级设置的价格百分比优惠自动计算对应的价格；
假定各个会员等级的价格优惠百分比规定：
	别	普通会员	银牌会员	金牌会员	钻石会员
	遇	100％	98％	95％	90％
	.6.3.4	会员升降级规则
会员对企业的贡献主要体现在消费与参与两个方面。系统对企业系统做出了大量有价值共享的会员的粘度的加强是有非常重要的意义。在系统层面，让做出了巨大贡献的会员区别于其他会员，这是按劳分配的原则，可以调动广大会员的积极性，也给企业的促销提升了业绩。
会员升降级的规则在业务上主要体现在：
	)	会员等级资格获取
	)	会员等级升降的途径
	)	会员各等级之间升降的规则设置
在商城系统中，提供了会员升降级规则的动态配置来支撑企业的会员策略需要。
一、会员等级资格获取
	)	会员注册即可获得会员等级资格；
会员等级的最低等级，就是系统默认的基本等级，即普通会员，只要顾客在网上商城网站上注册成功就可获得普通会员等级资格；
	)	会员注册后可以通过一定的方式获得其他更高级会员等级资格；
通过一定积分的数量来进行更高会员等级的资格获取；
通过一定的金额来购买一定量的积分数量进行更高会员等级的资格获取；
二、会员等级升降的途径
会员的积分永久有效，并且不能转让，主要通过两种途径获得：
	)	通过销售积分、发表文章、发表商品点评、成功介绍会员注册等方式获得一定积分数量；
	)	通过金额购买一定积分数量；
在商城系统中获取一定的积分数量、金额购买积分的换算比率都可以由管理员动态自定义配置；例如我们可以设置：
	)	购买金额取整数，1元等于1个积分； 
	)	发表商品点评：成功发表1篇字数不少于100字的商品点评文章，即可获得5个积分；
	)	成功介绍1个会员注册，即可获得5个积分；
三、会员各等级之间升降的规则配置
系统可以动态自定义设置各个级别向上晋升的积分换算，系统只支持自动升级规则，会员降级通过管理员手工调整会员等级进行。
例如，会员可通过500个积分兑换获得上一级的晋升； 

	.7	促销管理系统
	.7.1	推荐管理
对于一个大型的商城系统，由于商品繁多，不可能仅仅通过单一的商品浏览方式呈现给前台客户，那将毫无购买吸引力。所以很多经营者都会在网页前台设置很多专门版块，以摆放客户感兴趣的商品，对客户形成促销大大提高网站的整体吸引力。
	.7.1.1	推荐类型设置
推荐类型是指企业对商品的推荐进行归类，让顾客能够方便的接收到自己需要的商品促销信息。
商城系统可以根据企业的促销需要增加任意多个推荐的类型，推荐类型的名称可以动态修改。原则上，可以动态增加任意多个推荐类型，增加的推荐类型需要修改前台已经发布的网页布局才可以进行浏览，因此，根据客户体验规划书，会先定义出网站所有页面的推荐块（即推荐类型），并分好各自的商品类别，初始化到系统中。管理员在运营的过程中，只需要在对应的推荐类型下配置各个品类需要推荐的相应商品即可。
推荐的类型可以是新品推荐、精品推荐、品牌推荐、促销专区（特价推荐）等。
例如：
 ……
	.7.1.2	不同商品分类的推荐设置
不同商品分类的商品有各自的特点，商城系统根据多年的积累经验，在客户体验方面，总结出每种推荐类型在前台推荐商品的页面展示会根据不同的商品分类浏览而不同。
例如，商城系统在某个专门销售音像商品的电子商城系统项目中的商品分类其中有：
	乐	华语流行	华语女歌手
		华语组合/乐队
		华语合集
那么客户在浏览音乐频道页面的时候，它可能需要看到的只是关于音乐这个商品分类的商品推荐，而不是在这个本来属于音乐商品的地方找到一大堆关于游戏娱乐这个商品分类下的商品。
商城系统可以针对每个推荐类型动态自定义配置各个商品分类的多个商品推荐。
例如，商城系统在专门销售医药商品的大型电子商城系统项目中，系统提供不同商品分类的商品推荐功能如图所示：

	.7.2	主题管理
前台页面的内容通常需要根据特有的图片、文字以及链接来动态的进行发布商城系统的促销信息即某类主题促销推荐，系统针对此种需要，提供了灵活的页面管理系统。
根据前台的页面布局的定义规定，在后台可以配置不同的推荐板块分类，然后在每个板块下，进行动态更换推荐数据信息，推荐数据信息可以是一个或者多个，展示到前台的形式可以是广告图片或者海报的方式，主要设置包括：标题、图片、链接地址、顺序。
例如，我们可以在首页像卓越、当当一样发布一系列的主题图片进行推荐与促销，那么我们只要系统后台建立主题的分类，在这个主题分类下面增加需推荐数据信息，数据信息包括特色图片、特色标题文字介绍、点击特色图片需要链接到某个页面的链接地址（管理员可以任意指定）等。
主题馆以及品牌专区的配置与发布，也可以通过广告位、公告板的方式进行。

	.7.3	赠品管理
赠品的定义：赠品本身是一件普通商品，具有自身价格，当符合某个赠品规则时，可以用赠品价格购买。主要提供三种选购赠品的配置管理：
	.	买某件商品获得赠品
	.	买某类商品获得赠品
	.	买满一定金额获得赠品

	.7.3.1	赠品选购流程
赠品选购流程如下：

	.7.3.2	赠品规则
买某件商品获得赠品
会员在购买某个商品后，可以在赠品列表页面中选择满足不同赠品条件的相应赠品，赠品可以配置为某个指定商品分类下面的所有商品。不同的赠品条件是指本规则与其他赠品规则的与或关系，赠品规则可以多个存在也可以独立存在，赠品可以供会员同时选择的个数也可由本规则指定。同样可以指定赠品规则的有效时间。
例如管理员可以在商城系统中设置这个规则适用于某个商品（例如玉兰油乳液嫩白洁面乳），当会员订购这款商品的时候，就可以选择所指定的赠品分类下面的所有商品即赠品。赠品可同时选择的个数也可以通过本规则进行规定，例如购买一个商品可以同时选择1个赠品，购买了两个以上的本商品最多只可以同时选择2个赠品。
如图所示：

买某类商品获得赠品
会员在购买某个商品分类下面的任何一款商品，会员就可以在赠品列表页面选择满足不同赠品条件的相应赠品，赠品可以配置为某个指定商品分类下面的所有商品。不同的赠品条件是指本规则与其他赠品规则的与或关系，赠品规则可以多个存在也可以独立存在，赠品可以供会员同时选择的个数也可由本规则指定。同样可以指定赠品规则的有效时间。
例如管理员可以在商城系统中设置这个规则适用于某个商品分类（例如音乐商品类别），当会员订购这个分类下面任何一款商品的时候，就可以选择所指定的赠品分类下面的所有商品即赠品。赠品可同时选择的个数也通过本规则进行规定，例如购买一个商品可以同时选择2个赠品，购买了两个以上商品最多可以同时选择4个赠品。
如图所示：

买满一定金额获得赠品
只要会员在前台订购的订单商品金额达到A元，会员就可以在赠品列表页面选择满足不同赠品条件的相应赠品，赠品可以配置为某个指定商品分类下面的所有商品。不同的赠品条件是指本规则与其他赠品规则的与或关系，赠品规则可以多个存在也可以独立存在。赠品可以供会员同时选择的个数也可由本规则指定，对于买满一定金额获得赠品的规则，还可以根据购满多少金额可获得赠品即A元的倍数来配置可获得以及可选择的赠品数量。同样可以指定赠品规则的有效时间。
例如，订单商品金额满50元，可以获得音乐这个商品类别下的任何10个碟片中的一个（音乐下面共有10个商品），如果指定了每达到一个等级可获得1件赠品，那么当订单金额为100元，就可以在音乐这个商品类别下的任何10个碟片中的两个。也可以在这个基础上指定一个订单最多可以获得多少个赠品。
如图所示：

2.7.3.3	单品赠品
指定单品赠品
指定单品赠品，也就是当客户购买指定商品时，可获赠商品。
根据赠品是否免费和赠品是否指定，指定单品赠品有以下几种类型：
1.	根据赠品是否免费，单品赠品可以分为以下两种情况：
	)	免费获赠。赠品完全免费；
	)	优惠价格换购。客户可以以现金或积分等商城支持的虚拟货币优惠购买；
	.	根据赠品是否指定，单品赠品可以分为以下两种情况：
	)	赠品指定。买A赠B；
	)	赠品可选。买A可在指定赠品范围内获赠指定数量的商品。

因此，指定单品赠品主要有以下四种规则类型：
1.	买A可免费获赠B，商品A、B均指定，且B免费；
	.	买A可免费获赠指定赠品范围内的任几件商品，商品A指定，而赠品则可由客户在指定的赠品范围内选择指定的数量，例如，购买A，则可在以下10件商品中任意选择3件作为赠品，赠品免费；
	.	买A则可以优惠价格购买B，商品A、B均指定，B的优惠价格和支付方式（现金、积分、购物券或其他商城支持的虚拟货币）也已指定，例如，买A则可以10个积分购买B；
	.	买A则可以优惠价格购买指定赠品范围内的任意几件商品，例如，购买A，则可以10个积分购买B商品，或以15个积分购买C商品，或以20个积分购买D商品，以上三件商品只可任选一件。
同品数量赠品
同品数量赠品，也就是购买多件相同商品获赠赠品。
值得注意的是：
	.	需要考虑赠品有是否免费、是否指定的情况。
	.	需要考虑客户订购时未直接选择多件而在购物车中修改数量或再次下单的情况（见订单数量赠品部分）。
具体赠品规则如下：
	.	买多赠一。买X件A商品可免费获赠B，X、A、B均指定，且B免费；
	.	买多赠多。买X件A可免费获赠指定赠品范围内的任几件商品，X、A指定，而赠品则可由客户在指定的赠品范围内选择指定的数量，例如，购买10件A商品，则可在以下10件商品中任意选择3件作为赠品，赠品免费；
	.	买多换购一。买X件A则可以优惠价格购买B，X、A、B均指定，B的优惠价格和支付方式（现金、积分、购物券或其他商城支持的虚拟货币）也已指定，例如，买10件A商品则可以10个积分购买B；
	.	买多换购多。买X件A则可以优惠价格购买指定赠品范围内的任意几件商品，例如，购买10件A商品，则可以10个积分购买B商品，或以15个积分购买C商品，或以20个积分购买D商品，以上三件商品只可任选一件。
同品金额赠品
同品金额赠品，也就是购买指定商品达到指定金额获赠赠品。
值得注意的是：
	.	需要考虑赠品有是否免费、是否指定的情况。
	.	需要考虑客户订购时未直接选择多件而在购物车中修改数量或再次下单的情况（见订单金额赠品部分）。
具体赠品规则就不一一细述了。
	.7.3.4	订单赠品
订单赠品并非一定是整个订单中的全部商品商品，可以仅是部分商品。也就是说，订单赠品是指客户选择购买的商品负责规则即可获赠。
根据商品类别，订单赠品可分为：
	.	单品赠品；
	.	品类赠品；
	.	品牌赠品。
根据赠品规则类型，订单赠品可分为：
	.	订单数量赠品；
	.	订单金额赠品；
	.	订单组合赠品。
订单数量赠品
订单数量赠品，也就是订单中商品达到指定数量则可获赠赠品。
规则可指定数量有效范围，如单品、品类和品牌或其他商城支持的商品群。例如：
	.	单个订单买商品A达到X件或以上可获赠（见同品数量赠品，之所以在订单赠品中也考虑这种情况，是满足客户在购物车中修改商品数量的需求）； 
	.	单个订单买A品牌商品达到X件或以上可获赠；
	.	单个订单买A品类商品达到X件或以上可获赠。
	.	单个订单所有商品数量达到X件或以上可获赠。
	.	单个订单买A品牌商品达到X件或以上且含指定商品可获赠；
	.	单个订单买A品类商品达到X件或以上且含指定商品可获赠。
	.	单个订单所有商品数量达到X件或以上且含指定商品可获赠。

值得注意的是：
1.	需要考虑赠品有是否免费、是否指定的情况。
	.	以上规则可同时多个，并以梯度递增的形式展现，例如3件以下，4~5件，6~9件，10件以上，共4个梯度分别可获赠；
	.	当客户修改商品数量或增删商品等操作引起满足的赠品规则发生变化时，相应赠品将清空并提示客户已无符合条件的赠品或重新选择赠品。
具体赠品规则就不一一细述了。
订单金额赠品
订单金额赠品，也就是订单中商品达到指定金额则可获赠赠品。
规则可指定金额有效范围，如单品、品类和品牌或其他商城支持的商品群。例如：
	.	单个订单买商品A达到X元或以上可获赠（见同品金额赠品，之所以在订单赠品中也考虑这种情况，是满足客户在购物车中修改商品数量的需求）；
	.	单个订单买A品牌商品达到X元或以上可获赠；
	.	单个订单买A品类商品达到X元或以上可获赠。
	.	单个订单所有商品金额达到X元或以上可获赠。
	.	单个订单买A品牌商品达到X元或以上且含指定商品可获赠；
	.	单个订单买A品类商品达到X元或以上且含指定商品可获赠。
	.	单个订单所有商品金额达到X元或以上且含指定商品可获赠。
值得注意的是：
	.	需要考虑赠品有是否免费、是否指定的情况。
	.	以上规则可同时多个，并以梯度递增的形式展现，例如499元以下，500~999元，1000~1999元，2000元以上，共4个梯度分别可获赠；
	.	当客户修改商品数量或增删商品等操作引起满足的赠品规则发生变化时，相应赠品将清空并提示客户已无符合条件的赠品或重新选择赠品。
具体赠品规则就不一一细述了。
订单组合赠品
订单组合赠品，也就是订单中商品满足指定组合可获赠赠品。
规则可指定商品范围，如单品、品类和品牌或其他商城支持的商品群。例如：
	.	单个订单中同时购买A和B，可获赠；
	.	单个订单中同时购买品牌A和品牌B中任意商品，可获赠；
	.	单个订单中同时购买品类A和品类B中任意商品，可获赠。
值得注意的是：
	.	需要考虑赠品有是否免费、是否指定的情况。
	.	组合内商品数量不限，大于2即可，但一般不超过5个。
	.	当客户修改商品数量或增删商品等操作引起满足的赠品规则发生变化时，相应赠品将清空并提示客户已无符合条件的赠品或重新选择赠品。
在商城系统中的操作是，首先挑选组合商品，然后为这件组合商品增加赠品。
具体赠品规则就不一一细述了。

	.7.4	排行榜管理
排行榜的设置可以根据网站所有商品类别进行设置，可以查看全站的全类别的各排行榜，也可以针对某个分站（如果是多商户系统）、或者某个商品类别设置，这样可以查看到某分站某商品类别的排行榜。排行榜的类别主要包括：销售排行榜；访问量排行榜。
管理员可以设置该排行榜是否使用系统完全自动配置，如果不使用系统完全自动配置，管理员必须手动的来配置排行榜的商品。管理员还可以设置排行榜在前台显示的数量，设置该数量后系统将会算出这个数量的由高到低排序的商品，管理员可以对系统计算的结果进行人工干预。
	.7.4.1	销售排行榜
销售排行榜可以把某时间销售最火暴的商品显示在前台。
	.7.4.2	访问量排行榜
访问量排行榜对商品的访问量进行排行显示在前台。
	.7.4.3	排行榜人工干预
排行榜有多种，每个商品类别又有自己的排行。这样配置的数据量十分巨大，所以，系统又提供了自动的功能，根据不同排行的特性，自动计算排行，当然经营者可以通过手工手段干预自动计算的结果，对自动计算的结果进行重新排序，或者管理员可以手动的设置排行榜的商品。
	.7.5	热门关键字
热门关键字是指在商品浏览信息中点击量或者访问量较高的商品类别名称或者品牌名称等信息。引入了热门关键字的概念，既方便了客户，又有利于提高品牌的知名度和类别商品的销售量。
系统会自动记录访问网站用户的关键字查询，并按查询量自动计算出热门关键字来，并显示在前台的关键字列表中。
管理员只需要设定好显示数量和系统自动记录条件就可以了，同时可以将一些非正常的关键字进行过滤，放到关键字黑名单中，对前端客户进行屏蔽。
	.7.6	网上团购
网上团购是一种非常有利商户的商品出售方式。
团购是商户出售商品的一种方式，商户为商品设定了商品出售数量与对应的价格，一般购买的人越多，出售价格越低，通过这种方式来吸引用户的购买。这种方式已经为不少商户带来了很好的收益，所以越来越多的商户喜欢就种出售商品的方式。
网上团购是一种新式的团购，用户不用像以往一样跑到门店团购。只要上网，就可以方便的与不认识的其它网络用户一齐参与团购。网上团购比门店团购的好处是，参与网上团购的人数会比较多，用户因此很容易得到低价，所以很多用户会选择网上团购的方式进行团购。形成了一种良性循环。非常有利商户。
	.7.7	积分促销
	.7.7.1	积分政策
网站的积分政策主要分为两部分，也就是积分的获取政策和积分的消耗政策。
积分获取
积分的获取方式一般有：
	.	注册获得积分；
	.	购物获得积分；
	.	参与网站活动获得积分，例如对商品进行评论、发表留言、网站建议；
	.	推荐他人注册获得积分；
	.	下级会员购物上级会员获积分；
	.	其他
积分消耗
积分消耗的方式一般有：
	.	积分进行会员等级升级；
	.	积分进行商品兑换；
	.	积分兑换购物券；
	.	积分进行抽奖；
	.	其他
	.7.7.2	积分兑换
兑换专区是专门提供给会员用自己的积分在商城上换购相应商品的促销功能。会员拥有的积分可以用来换购商品。积分兑换专区整站唯一，积分兑换的配置直接由管理员进行设定。
积分管理的配置请见本书积分管理系统一节的详细描述。
	.7.7.3	积分兑换商品配置
在商城系统中，管理员可以在后台兑换专区栏目下增加可以用来进行积分兑换的商品，商品的选择可以任意从各个分类中进行选择，然后针对每个兑换商品配置兑换所需要支付的积分数额、兑换商品的上下架。
会员在前台可以根据管理员配置的积分的范围查看到某一个范围下的可供兑换的商品，点击可直接进行兑换，积分兑换的商品不可再获取系统赠予的任何积分。
会员进行积分兑换订单确认，填写相关联系资料信息，并提示用户通过平邮方式免费邮寄赠品，不需会员选择任何支付方式和配送方式，兑换的订单直接全部统一提交处理。
	.7.7.4	会员积分兑换的流程
如下图所示：

	.7.8	特价管理
	.7.8.1	单品优惠
单品优惠
单品特价有以下几种方式：
	.	单品特价，购买指定商品单件直接特价；
	.	多件优惠，购买指定商品多件享受指定优惠；
	.	满就减，购买指定单品达到指定金额可享受指定优惠。
其中优惠可以是折扣，也可以是直降，也可以是获得积分或购物券。
同品数量递进优惠
同品数量递进优惠，也就是购买指定商品达到指定数量后享受指定优惠。
	.	多件直接优惠：购买指定商品，指定数量之后享受指定直接优惠（折扣或直降），例如，第一件全价，第二件及以上半价；
	.	多件递进优惠：购买指定商品，指定数量之后享受指定递进优惠（折扣或直降），例如，第一件全价，第二件半价，第三件25%……
其中优惠可以是折扣，也可以是价格直降，也可以是获得积分或购物券。
	.7.8.2	组合优惠
商品组合优惠
组合优惠也就是“1+1<2”的情况。
	.	A+B同时购买，A原价，B特价，事实上为指定单品优惠换购的情况；
	.	A+B同时购买，A和B都特价，则为组合优惠，需设置商品组合特价。
注意：
	.	优惠可以是折扣也可以是价格直降，也可以是获得积分或购物券；
	.	组合内商品数量不限，大于2即可，但一般不超过5个。
订单组合优惠
订单组合优惠，也就是订单中商品满足指定组合可获得指定优惠。
规则可指定商品范围，如单品、品类和品牌或其他商城支持的商品群。例如：
	.	单个订单中同时购买A和B，可获得指定优惠；
	.	单个订单中同时购买品牌A和品牌B中任意商品，可获得指定优惠；
	.	单个订单中同时购买品类A和品类B中任意商品，可获得指定优惠。
注意：
	.	优惠可以是折扣也可以是价格直降，也可以是获得积分或购物券；
	.	组合内商品数量不限，大于2即可，但一般不超过5个。
	.7.8.3	订单优惠
订单数量优惠
订单数量优惠，也就是订单中商品达到指定数量则可获得指定优惠。
规则可指定数量有效范围，如单品、品类和品牌或其他商城支持的商品群。例如：
	.	单个订单买商品A达到X件或以上可获得指定优惠（见单品特价，之所以在订单赠品中也考虑这种情况，是满足客户在购物车中修改商品数量的需求）； 
	.	单个订单买A品牌商品达到X件或以上可获得指定优惠；
	.	单个订单买A品类商品达到X件或以上可获得指定优惠。
	.	单个订单所有商品数量达到X件或以上可获得指定优惠。
	.	单个订单买A品牌商品达到X件或以上且含指定商品可获得指定优惠；
	.	单个订单买A品类商品达到X件或以上且含指定商品可获得指定优惠。
	.	单个订单所有商品数量达到X件或以上且含指定商品可获得指定优惠。
需要注意的是，优惠可以是价格折扣、金额直降，也可以是获得积分或购物券。
具体优惠规则就不一一细述了。
订单金额优惠
订单金额优惠，也就是订单中商品达到指定金额则可获得指定优惠。
规则可指定金额有效范围，如单品、品类和品牌或其他商城支持的商品群。例如：
	.	单个订单买商品A达到X元或以上可获得指定优惠（见单品优惠，之所以在订单赠品中也考虑这种情况，是满足客户在购物车中修改商品数量的需求）；
	.	单个订单买A品牌商品达到X元或以上可获得指定优惠；
	.	单个订单买A品类商品达到X元或以上可获得指定优惠。
	.	单个订单所有商品金额达到X元或以上可获得指定优惠。
	.	单个订单买A品牌商品达到X元或以上且含指定商品可获得指定优惠；
	.	单个订单买A品类商品达到X元或以上且含指定商品可获得指定优惠。
	.	单个订单所有商品金额达到X元或以上且含指定商品可获得指定优惠。
需要注意的是，优惠可以是价格折扣、金额直降，也可以是获得积分或购物券。
具体优惠规则就不一一细述了。
	.8	订单管理系统
资金流到位与否是交易成败的关键标志，用户从选择商品到下订单的过程即标识交易已经产生。我们知道，商品的物美价廉在根本上决定了买卖的成功与否，同样完善的、贴心的、快速及时的订单处理也是一个至关重要的因素。
本系统提供了强大的订单处理功能，可以有效的协助管理员便利的处理订单，主要包括：整个订单的查询、订单处理状态标识的改变、订单商品面临客户指定拆分、客户通过电话进行下单、在网上不销售的商品或不具有的商品在线下销售的电话订单处理、管理员在处理订单的岗位权限设置等等。
同时也提供了性能优异完善的订单与其他第三方系统（例如SAP）的对接接口处理机制，可以有效的整合企业内部信息系统的线下资源进行订单的配送与库存处理。
	.8.1	订单产生方式
网上商城订单产生的两种方式：
	.8.1.1	手工订单
手工订单主要是指电话订单。有时很多顾客在网上浏览到所需的商品信息后会通过电话的方式进行订购，商城系统提供简洁、方便的录入界面给客服管理员快速建立手工订单。
当管理员接到客户的电话后，在会员管理栏目输入客户来电号码，查询客户信息，如果能查询到客户信息，则表示客户已经是网站的注册会员，则以客户会员账号进行下单； 
如果根据来电未能查找到客户信息，则询问客户是否已经注册为网站会员：如果有，则要求客户提供会员帐户或注册电话或客户姓名等资料查询会员信息；如果没有注册，则在网站后台为客户进行注册，并将会员账号和密码告知客户，请客户上网查看，并且告知客户下次电话订购时直接报上注册电话或者会员ID或者会员姓名即可。
为客户下单时，首先需要询问客户想订购的是哪期目录的商品，并在目录商品栏目寻找到该期目录，按照客户提供的商品目录号为客户下单。注意：订购价格以目录商品价格为准。
手动订单同样将进入普通网购订单处理流程。

	.8.1.2	网上订单
网上订单主要是用户通过商城系统前台下订单。
网上订单主体流程如图所示：

	.8.2	订单处理流程
	
	.8.2.1	订单处理类型
商城系统提供了标准的订单处理机制。从支付以及配送的角度我们可以将订单的处理划分为两种类型：货到付款、款到发货。
	)	货到付款：
客户要求与商城进行一手交钱一手交货，面对面的交易；一般都是客户在商城提交订单后，由平台线下送货上门之后收款； 
	)	款到发货：
商城需要确认收到用户的付款，才进行送货，一般是通过网上进行支付，例如采取邮局汇款、银行电汇、更多的是网银在线支付。
	.8.2.2		订单处理核心环节
订单处理流程，主要体现在五个环节：
		用户下单
		确认订单
		分配订单
		订单收款
		发运订单
用户下单
用户下单的环节，是指前台顾客即会员浏览商城网站进行商品的挑选并提交订单。系统提供在一定的时间范围内即在会员订单提交至后台管理员还未对订单进行确认操作这段时间内，允许会员自行修改、取消自己的订单。
确认订单
会员订单提交到商城系统后，商城系统管理员对订单的数据信息进行确认，确认的方式通过电话联系会员进行。确认的内容主要包括会员填写的收获地址是否真实有效、商品配送相关情况。
系统提供管理员对订单进行确认有效与无效的操作处理，无效的订单管理员可以直接取消。会员订单如果已经进行确认，将不能再进行修改。
分配订单
订单进行确认有效后，商城管理员将分配订单到物流配送部门或人员进行备货、出货的处理。订单的配送是通过线下进行的。商城管理员根据线下的配送情况修改商城网上订单的配送状态进行标识。
订单收款
订单的收款环节，主要是根据货到付款、款到发货两种类型进行处理。
收款的情况一般是通过财务人员对确认有效的订单进行货款情况确认，如果是货到付款的订单，财务人员将根据配送人员的反馈进行修改订单的收款状态，如果是款到发货的订单，财务人员可以通过邮局的汇款情况、银行帐号到帐情况进行确认订单的收款状态。
订单收款的环节在整个订单处理流程中是一个独立的环节，它不依赖于其他任何环节，只要是确认有效的订单，财务人员即可对其收款情况进行跟踪处理。
发运订单
发运订单就是真正的配送订单过程。系统提供商城管理员进行网上会员订单出货情况的标识修改，在商城系统可以将订单的处理过程视为完成阶段。
订单退货处理
退货的发生的前提是已支付的订单以及货到付款的订单。商城系统提供了增加退货单的处理机制。当会员订单发生退货情况，商城管理员需将当前订单标识为已完成，同时新增加一个对应的退货单订单记录，系统进行冲减操作完成退货处理。网上订单因为退货操作产生的赠品或礼品处理，通过线下进行。
	.8.3	订单状态处理
订单的整个处理过程，每个处理的步骤结果是需要明确标识的，用来表明订单的处理情况。例如，用户下完订单后，客服组人员看到新的订单将马上会与用户进行确定订单的有效性，如果订单是有效的，那么需要将订单定义为是有效的，从而让其他的处理人员执行后续的处理操作。
因此，订单的处理流程以及各个处理过程中的执行步骤结果，定义出订单的各个状态，用来标识订单的不同处理情况，根据订单流程的处理核心环节，电子商城系统提供了标准的订单状态处理机制。
	.8.3.1	订单状态处理流程
请见下面两种标准类型的网上商城订单状态处理流程图：
货到付款

款到发货

2.8.3.2	订单状态类型
商城系统的订单的状态主要分为两种：
订单处理标识状态
订单处理标识状态定义为：
1)	已确认
后台管理员对订单进行确认有效后，将订单状态标识为已确认，已确认的订单信息（商品信息、联系人信息、配送信息）将不允许任何修改，订单也不可再进行取消；
2)	已出货
后台管理员确认订单进行出货进行配送后，将订单状态标识为已出货；
3)	已完成
当订单的货款两清后，后台管理员确定订单已经完结，将订单状态标识为已完成，已完成的订单将不能进行任何形式的修改，包括订单信息、订单各个状态信息都不能进行修改；
4)	已取消
后台管理员对订单进行确认无效后，将订单状态标识为已取消；前台会员在允许的期限内也可以取消订单，同样将订单的状态标识为已取消。
订单收款处理状态
订单收款处理状态定义为：
1)	未支付
订单默认的收款处理状态。财务人员可以将收款状态进行修改，标识为未支付，代表当前订单未进行过支付或者货款还没有确认到帐。
2)	支付失败
财务人员根据订单的支付方式，确认订单的收款状态并进行修改，标识为支付失败只要指通过网银在线支付过程中进行过支付，但是因为支付接口的处理异常造成支付失败的情况，一般是系统根据支付接口的返回自动处理，并标识订单的收款状态为支付失败。财务人员也可以通过与网上银行的对账，将订单标识为支付失败。
3)	已支付
订单的货款已经到帐，财务人员确认网上订单的收款状态，标识为已支付。如果订单是通过网银线上进行支付的，根据支付接口的处理结果，系统也会进行自动处理，标识订单已经支付成功。
2.8.4	订单赠品处理
订单商品行如果有赠品，在管理员修改某个商品的数量或者删除商品时，使其相关联的赠品规则条件不能满足，系统需要自动将赠品标识为取消或者直接删除。在管理员修改订单时，需要进行明确提示并确认修改或者删除操作，删除或者取消的赠品将不可恢复。
订单商品如果没有赠品，在后台管理员修改某个商品的数量使其相关联的赠品规则条件满足，系统不提供进行赠品的任何处理操作。
2.8.5	订单数据对接处理
商城系统项目中，订单的所有处理操作控制在企业ERP系统中。商城系统将确认有效的订单数据发送到ERP系统进行处理，然后根据ERP系统的处理结果自动修改订单的各个相应状态。
订单数据的对接处理请见本书与第三方系统对接处理一节的详细描述。

2.8.6	订单检索功能
订单检索功能可以有效地降低管理员的管理的工作时间，提高工作的效果，检索条件的合理设置相当重要。订单检索分三部分：
一、	基本条件
	订购人关键字
	订单编号
	下单时间
	商品关键字
	订单来源：网上订购、电话订购、门店订购
	订单类型：正常订单、退货订单 、积分兑换订单、预存款冲值订单。


二、	配送/支付/金额/商户
	订单金额上/下限
	商户：作为单商户的系统，它只有一个“总站”选项。
	支付方式：货到付款、邮局汇款、支付宝支付、工商银行支付、云网支付……
	配送方式：免费送货上门、邮政平邮、EMS、用户自提、公路送输……


三、	订单状态/处理人
	订单处理状态：未处理、已取消、用户已确认、已经送货。
	订单支付状态：已支付、未支付。
	订单处理人：订单确认人、订单分配人、财务确认人。

2.9	配送管理系统

系统的配送管理包括配送方式以及配送计费规则管理两部分。

	配送方式：例如快递，EMS,平邮等。
	配送规则：配送规则的包括某地区，某配送方式，某商户是否支持，是否支持送货上门，计费公式等多种配置。
	配送地区：配送地区形成一个树状结构。例如中国包括广东，广东包括广州等等。
	计费公式：可以通过订单价格计算出用户的配送费用。

2.9.1	配送区域管理
配送区域管理主要是配置和管理系统支持的送货地区。送货地区全站统一管理，可以让有权限的管理员进行增加、修改以及删除维护。例如：

设置好地区后，前台会员在生成订单的时候，可以进行选择需要送货的省市地区，然后填写详细的发货地址即可。 

网站前台会员选择好发运的地区后，系统自动根据选择地区列出适合的配送方式。例如会员选择了辽宁省—大连市—高新园区，系统自动列出高新园区支持的配送方式普通平邮、EMS特快专递、客户自提、送货上门等支付方式供用户进行选择，选择后，系统将会根据用户的商品信息、配送方式费用配置参数自动进行配送费用计算。
2.9.2	配送方式管理
商城系统支持的配送方式可以动态设置，根据需要而自定义设定。主要内容有：

	支持的配送方式 
	添加配送方式 
支持以下配送方式： 
送货上门 
普通平邮 
EMS特快专递 
客户自提

可自定义添加配送方式
系统配送方式配置是指整个网站可以支持的配送方式记录设定，在这里无需针对具体配送方式进行费用配置，只需提交一个配送方式的记录即可。

2.9.3	配送费用设置
配送费用设置就是针对各种配送方式进行计费公式或相应费用的设置。
商户对各个配送方式进行设置计费公式或者相应的费用，我们称之为配送规则管理。
配送规则管理，可以设置某个地区的某个配送方式的设置。商城系统对配送的计算公式可以根据商品的重量、体积、订单的总金额进行配送费用的计算，即公式可以按照一种编程语言（例如JS、JAVA）以及预定的变量参数（例如商品的重量、体积、订单商品总金额）遵循一定的格式根据所需要的业务逻辑自定义编写业务代码，商城系统会根据这些代码自动进行编译计算。
支持的配送规则

增加新的配送规则

2.10	支付管理系统
支付管理包括货到付款和款到发货两种方式，其中款到发货又可以包括在线银行支付、邮局汇款、银行电汇等支付方式。在线支付系统支持基本支付网关结构，可以选择不同的支付接口。如：工行，招行，建行，首信，上海银联，广州银联，还可以根据需求定制开发其他支付方式，开发完成即可以立即使用。
商城系统的支付方式主要包括（这些支付方式都可以在后台进行动态配置）：
	货到付款
	网银支付
	邮局汇款
	银行电汇
2.10.1	基本支付网关结构
所谓支付网关实际上就是本系统主体与支付手段之间规定的一个统一的接口，其目的是为了适应目前不断增加的众多支付方式。在本系统的支付网关结构下，用户可以按照此接口的形式增加新的支付方式。
以下是系统的支付网关结构图：

每个支付的接口将作为用户选择该种支付方式的事件的响应函数来调用，所以添加一种新的支付方式的时候可以不影响现有的购买流程。添加一种新的支付方式应只需要一周左右的时间就可以调试完成。
目前本系统的支付网关支持的银行接口有：工行、招行、建行、首信、还迅、上海银联、广州银联，以及支持其它支付方式的定制。
2.10.2	支付配置管理
支付方式是由总部统一来设置的。而每个区域站点又可以在所支持的所有支付方式中选择自己支持的支付方式，甚至可以直接采用总部的参数设置。如图所示：

区域分站选择了支付方式后，这些支付方式就可以在前台用户购物的时候被用户选择了。用户选择了支付方式后，就可以转接到相应的支付处理程序进行处理。支付方式的设置流程：

设置支付方式的界面如下图所示：

2.11	客服管理系统
2.11.1	在线客服系统
我们提供基于web浏览器的即时沟通工具，前期作为客户的咨询，投诉等沟通平台。
在线客户服务系统能够让客户与客户服务人员进行有效的沟通，解决他们购物过程中产生的疑问和障碍。因此，客户服务系统能够非常有效地提高访客到订单的转换率。
目前采用了在线客服系统的网上商城网站，比没有采用客服系统的网站订单成交率提高了2倍以上。典型的如淘宝网，通过淘宝旺旺的在线沟通，使订单转换率高达2.5%以上。这比通常0.5%的订单转换率提高了足足5倍。
2.11.2	缺货登记
用户在浏览商城时候看到一个心爱的、价格合适的商品，却发现该商品已经没有库存而不能购买，不免充满失落的心情；对于商城运营来说，这意味着失去了一个销售机会。其实这样的情况是很经常发生的，为把握这些潜在的销售机会，商城系统提供让用户提交一个缺货登记的信息的功能，对于商城能明确的掌握对某商品感兴趣的用户群体，是非常有作用的；对这些用户的跟进，成功销售商品的机会是非常大的。
后台管理员可以对用户提交的缺货登记信息中进行搜索，筛选，从而跟进这些用户；在有库存的时候再联系客户进行确认，然后可以直接根据商品的当前价格生成订单，进行处理。
用户定制商品
另外一种缺货情况，可能是商城里没有销售顾客所需要的商品。商品可能是属于客户定制的商品。例如，作为珠宝商城，客户要求定制一个戒指，客户可以通过网站留言的方式，提供款式和材质的详细信息（文字及图片），网站为其进行采购。同时系统可以生成用户订单进行处理。
2.11.3	问卷调查
收集用户感兴趣的信息资料的调查系统。模块中总部和分部公用一套操作界面。本文以多商户模式进行定义问卷调查功能（单商户系统已经包括其中）。总部的管理员进去后能见到所有的问卷列表，而各分部只能看到该分部的问卷列表。问卷所属部门按增加该问卷的管理员所属的部门来区分。（如：总部增加的问卷所属部门为总部，门店管理员增加的问卷所属部门为门店）
2.11.3.1	问卷库管理
管理员增加的问卷调查，根据该问卷的可重用性，把它加入到问卷库中，在下次配置问卷调查内容时，可以在问卷库中提取这些问卷的内容。
2.11.3.2	问卷管理
问卷调查内容分全新增加、从问卷库增加，全新增加的内容包括问卷标题、投票截止时间、是否允许匿名投票、是否允许查看统计结果等。

除了问卷的基本信息，还需要设置问卷的题目，题目也分为全新增加和从题库增加，从题库增加可以免去设置问卷的每个题目。
例如我们某个客户项目中的设置问卷界面如下：

2.11.3.3	答卷管理
每个问卷都有一个答卷的列表，管理员可以查看每个用户的答卷结果。

2.11.3.4	调查结果统计
通过问卷调查的答卷结果，统计出问卷的题目回答人数所站的比例，对于一些单选或多选的题目，可以统计出这些选择这些选项的人数和所占的比例。
例如我们某个客户项目中的调查结果界面如下：

2.11.4	帮助中心
在与业务流程相关的地方，列出帮助中心，用户如有疑问，可以先行查找帮助中心。如设置购物帮助，会员帮助等等栏目。帮助中心为信息发布系统。详情请查看“信息发布系统”。

2.11.5	留言管理系统
2.11.5.1	留言管理
系统设置客户点评、客户留言、客户建议、客户投诉四大类的留言管理。例如网络用户对商品的质量投诉、对线下送货人员的服务态度建议、保修的相关注意事项等等，并可以在后台系统对各个分类的留言进行查询和更新。网络用户在浏览网页的时候，可以根据留言的分类有选择的进行提交留言。
2.11.5.2	留言回复管理
管理员在后台系统可以针对网络用户的某个留言进行审核、回复或者根据用户的联系方式和用户进行沟通，例如电话服务方式。网络用户登录会员专区后，可以在线查看其他会员的留言回复以及管理员的留言回复。
2.11.5.3	留言统计
后台系统将提供针对某个分类的留言进行统计，对统计的信息进行分析，例如投诉商品质量的留言数量是多少，投诉是发生在什么时段的。从而可以让管理员针对某类留言采取对应的改良措施或者优化服务提供体系等等。

2.12	预存款管理系统
商城平台提供预存款系统给会员使用；
预存款账户是指用户在网站上的储值账号。通过在线银行充值或汇款充值的方式，用户可以向账户里面存钱。并可以用这些预存的钱在商城内消费。
预存款账户的管理，主要包括以下内容：
1．	账户充值管理
2．	账户消费
3．	退款处理
4．	账户余额查询
5．	账户收支纪录查询
6．	账户冻结/解冻
7．	支付密码管理
2.12.1	账户充值
2.12.1.1	在线充值
在线充值的主要流程描述：
1.	点击账号充值：在预存款充值页面上选择“账号充值”的操作。
	.	填写充值金额：在预存款系统中填写要充值的金额数量（一般一个预存款相当于一元钱），生成充值金额的订单可提交给银行系统。
	.	选择充值银行：选择用来支付的银行的，银行系统根据预存款系统提交过来的订单金额数设定充值金额。
	.	支付充值金额：到相应的银行系统支付要充值的金额。注意，在选择充值银行的时候，是已经限定了充值的金额数的，银行系统只是作为一个付款处理的通道。
	.	充值成功/失败：预存款系统根据银行系统的操作状态返回相应的操作状态。
（参见下面的流程图）

	.12.1.2	汇款充值
用户可以通过汇款方式充值“预存款”，用户去银行把钱汇至商城指定账号，再打电话给商城服务中心，服务中心人员向财务人员查询是否收到用户的汇款，确认后，核实用户资料，实现手工帮助用户充值预存款；如下图：


2.12.2	账户消费
预存款账户消费，也就是当用户商城上进行购物时，使用其预存款账户对其订单金额进行支付的过程，也是一个账户金额减少的过程。
账户消费的主要流程如下：
1.	用户完成订单；
	.	用户选择预存款账户支付；
	.	用户确认订单金额和预存款账户信息，确认支付；
	.	系统从用户预存款系统中扣除相应金额，同时显示订单支付成功；
	.	完成。
（参见下面的流程图）


2.12.3	退款处理
支付平台向用户退款，当出现需要退款的情况时，用户提出退款申请，平台处理审核批准退款申请后，即需要进行实际退款操作。
退款一般为两种，一就是要把钱转到用户指定的银行账号里，简单来说可以通过转账操作。二是，把款退回助用户预存款账号，在用户的预存款账户里手工增加预存款。以下说的退款流程为第二种退款方式，即退款到预存款账户。
当出现下列情况时，系统需要作退款处理：
1.	订单成功，用户已经支付，但是商品缺货，而用户不愿意等待；
	.	订单成功，用户已经支付，但是双方协调交易取消；
	.	订单成功，用户拒收或无法送达，协调不成功；
	.	订单成功，用户收货后，需要退货，退货申请通过；
	.	其他。

而退款的主要流程如下：
1.	出现交易纠纷，经沟通和审核后，双方达成退款协定；
	.	系统显示退款内容，包括订单号、用户预存款账号、退款原因等；
	.	用户确认，系统将相应金额增加到用户预存款账户；
	.	订单状态更改为退款完成。
（参见下面的流程图）


2.12.4	账户余额查询
账户余额查询需要会员登录之后进入会员后台才可以查询到。
余额查询过程需要到预存款数据库系统中实时查询。查询完毕后把账户余额显示给查询者。
账户余额查询流程如下图：

2.12.5	账户收支纪录查询
用户登入会员后台，用户选择“账户收支记录查询”，进入该查询界面，界面会有一个时间范围选择。选择查询系统后会现实收入记录和支出记录详情。如下图所示：


通过“详情….”进入，可以查询到本次交易的详细情况。例如在线购物购买了什么产品，充值卡号等。
2.12.6	账户冻结/解冻
当用户出现诚信问题，或者账户被盗，被黑，平台有权将用户账户冻结。当这些问题解决后后台将账户解冻，用户即可正常使用账户。
冻结流程如下：

账户解冻只需要在后台进行“开通账户”操作即可。
2.12.7	支付密码管理
为了预存款账户的使用安全，使用预存款支付需要输入支付密码。
预存款帐户的所有信息数据的修改调整以及交易支付都必须验证其支付密码进行。会员登录平台系统后，可以直接修改支付密码。支付密码只可以通过会员登录系统后直接修改进行找回。

2.13	购物券系统
购物券，是为了鼓励消费者进入网上商城平台购买而进行的价格折让。平台向会员派发，而会员可以在网购时按照购物券所标识的金额获得优惠。
同时购物券也将是网站宣传和推广的重要方式。
2.13.1	购物券的生成
首先，平台需要确定购物券的数量、购物券的金额、购物券的使用有效期等有效信息，并指定购物券为平台发行并在平台所有商户使用，批数生成。
2.13.2	购物券的发行
购物券的发行方式主要是：
1.	邮件：发送至客户注册邮箱；
	.	平台显示：直接将购物券发送至客户后台“我的购物券”
	.	短信：需短信支持
例如，客户注册为会员即赠送10元购物券，这10元购物券将发送到客户注册邮箱，客户可从邮件中提取该购物券的帐号信息；
	.13.3	购物券的使用
购物券的使用流程图如下：

	.14	界面管理系统
	.14.1	主题馆
主题馆版块：

 一个主题馆主要有以下要素：
	主题馆类别：例如上图中的“笔记本”、“数码”； 
	促销主题标题：一个主题馆下面可以有多个主题，也可以直接就是商品的名称； 
	主题图片：每一个主题都需要有一个展示图片，可以是设计的切合主题的图片，也可以直接是商品图片； 
	链接地址：客户点击主题图片或主题标题，就将进入促销主题页，因此需要有相应的链接地址； 
	顺序：在主题馆的具体内容里面，会展示多个商品，因此涉及到排序的问题，如下图所示：

2.14.2	套用模板
界面管理系统是对页面风格进行管理，主要包括：页面的LOGO形象、边框、底纹、颜色。以模板形式实现颜色、边框、底纹的改换。而商户的LOGO可直接上传，自由更换。
模板是一套已经定义好边框、底纹、颜色的风格统一的模型。打个比方，在一批版面风格类似的网页中，比如网页上面的标题、导航都是可自定义的，而下方的底纹边框颜色是固定了的，那么就可以使用模板了，建模板可以将网页中无需变化的对象固定下来，然后再用来应用到其他风格类似的网页中。这样就可以实现，只修改部分页面就可以快速实现网页制作了。商城系统将提供3套店铺模板供商户选择。
2.15	广告管理系统

由上图所示。前台页面设计的时候，就已经定下一些广告位，管理员只要在系统后台对这些广告位的广告进行增加，修改，删除的操作，就可以更新前台显示的广告，而不用修改到网站的页面或者是连接到服务器进行修改。
2.15.1	广告位管理
网站前台的每个广告显示的位置，后台管理系统都有一个对应的广告位管理，管理员在后台的广告位设置了广告图片后，在网站前台对应的位置就可以看到该广告图。每个广告位都有描述网站前台显示的地方，还有广告位的大小，管理员需要根据这个广告位的说明进行广告的配置。

2.15.2	广告初始化
网站前台的页面，每一个广告图片都可以在系统中配置。在网站初始化的时候，前台的页面全部使用默认的广告，这些广告图片都是网页设计师通过页面的设计风格搭配设计的。所以在网站在初始化和广告位尚未配置广告时，网站页面都会出现初始的广告图，不会出现死图或者空图的情况。
2.15.3	广告的类型
2.15.3.1	静态图片
静态图片是最常见的一种广告类型，管理员只要上传一幅图片就可以在前台显示了，前台规定了显示该广告图片的大小，所以管理员在上传广告时需要对应该广告位的大小，以免图片变形。
2.15.3.2	Flash动画
FLASH动画也是一种比较常见的广告类型，与图片比起来，可以表现的东西更加丰富。同样要注意的也是大小的问题，如果广告图片的尺寸不对应，在前台的显示就会变形。
2.15.3.3	自定义
如果上面两种类型都不能满足要求，就可以使用这种类型。自定义支持任意的html页面，可以将文字、图片等各种媒体展示到一个广告中。同样要注意的也是大小的问题，如果设置的自定义类型广告尺寸过大，在前台就不能显示完整了。
2.15.4	广告管理
对应某个广告位设置广告，一个广告位在前台只能显示一个广告，但是在后台可以对一个广告位设置多个广告。
2.15.4.1	配置广告类型选择
配置广告时可以选择：
	静态图片
	FLASH动画
	自定义

2.15.4.2		广告图片的信息提示与链接设置
配置广告图片时，可以为每个广告设置鼠标经过广告图片时的提示，还可以设置广告图片的连接，FLASH动画的连接设计在FLASH动画内。


2.15.4.3	多广告图片动态轮换显示
对于同一个广告位的每一个广告，显示在前台是通过广告的排列顺序和修改时间决定的，排列顺序越小优先级越高，修改时间越近优先级越高。
对多个广告图片，可以设置轮换显示，同时可以设置每个广告的过期时间，期限到了自动不再显示。
2.16	信息管理系统
信息发布系统，是将商城上的某些需要经常变动的信息，类似新闻、业界动态等更新信息集中管理，并通过信息的某些共性进行分类，最后系统化、标准化发布到商城上。
新闻内容页中支持插入图片、商城商品图片、附件、多媒体的影音文件以及模板文件（html网页文件）等，自由设置新闻类别，自动显示信息的发布时间。
信息还可以录入来源（可能该信息摘自一些媒体的报道）、作者等等相关信息。它大大减轻了网站更新维护的工作量，通过网络数据库的引用，将网站的更新维护工作简化到只需录入文字和上传图片等等（甚至可以从其他资料中拷贝粘贴），从而使网站的更新速度大大缩短，也吸引了更多的长期用户群，时时保持商城的活动力和影响力。    
2.16.1	图文并茂的信息录入
2.16.1.1	支持插入图片
支持任意多个图片的插入排版操作。在编辑的时候可以选择网上的图片连接也可以在本地上传图片进行插入，同时可以调整图片显示的大小等。
2.16.1.2	支持插入商品图片
支持在商城商品目录书中选择商品，那么将有多种商品图片的显示形式供选择插入，插入后图片的连接将直接连接到商品详细页面，同时也可以手工改变连接路径。如图：



选择其中的一种显示方式后，将在信息内容中插入选择的商品信息。
2.16.1.3	支持插入模板
系统提供了信息的模板管理功能。可以在系统中增、删、改、查模板，在编辑新闻信息时候可以应用模板进行，这样只要在已经编辑好的通用模板中修改部分的文字或者图片或者连接等，极大的提高信息编辑管理速度，同时也可以使信息的排版更加美观。
2.16.1.4	支持插入附件
支持任意多个图片的插入排版操作。在编辑的时候可以修改下载的文件的连接显示说明。如下图：


2.16.1.5	支持插入多媒体
支持插入flash、wav等通用的网上传播媒体元素。所有的操作都简单到选择本地文件上传，系统将自动区分上传的文件，做相应的代码插入，直接可以看到预览效果。
2.16.2	信息分类推荐功能
通过将某些特殊的信息经过系统挑选，推荐到前台某些特定的版块进行显示，可以提高用户对感兴趣的信息的快速查看，从而提高信息的影响力，同时丰富了商城的信息发布形式。
比如说，可以在前台设置最新信息专区、热门信息专区等，管理员设置一些有特殊意义或性质的新闻信息，那么通过这些版块，可以大大提高信息发布的功能，从而促进商城商品的销售以及整个网站的影响力和吸引力。
2.16.3	信息无限级分类管理
系统采用树的结构来表示信息分类，支持无限级的扩展，也就是说，客户在日后的经营中可以自己增加删除信息分类，实现灵活的信息分类。
比如，我们现在运营中可以增加一个“商品信息专栏”类别，并且还可以在其下增加子类别，如图：

这些栏目都可以灵活的进行增加、删除、修改、排序等管理操作。
2.16.4	信息灵活、严格的审批发布机制
只要分配了审批权限，管理员就可以对自己拥有权限的栏目信息进行审批。

2.17	站内搜索系统
2.17.1	普通搜索
普通搜索是安排在页头的搜索块。因为网站的所有页面都会采用同一个页头，所以全站搜索会出现在网站的任何一个页面上。普通搜索的功能类似当当、卓越。普通搜索主要有以下几个功能：
1)	可以针对不同的分类，提供关键属性的搜索。例如，对耗材商品，提供商品名称、型号的搜索。
2)	提供热门关键字。可以让用户直接通过点击热门关键字，浏览搜索结果，无需重新录入。

2.17.2	高级搜索
高级搜索向用户提供更细致的搜索功能，包括商品名称、型号、价格、颜色等属性搜索。

高级搜索的体验是：
1)	当客户选择大类之后，中类的选项出现。当客户选择了中类之后，小类的选项出现。
2)	当客户选择了不同的类后，下面需要填写的关键属性会随着变化。
2.17.3	全文检索
商城系统提供商品、信息以及会员信息的全文检索。采用Lucene为全文检索的机制进行提供整站信息的快速便利的查询。
2.18	日志管理系统
网站日志是系统运行很重要的信息。网站日志它是整个系统数据变化的详细记录，它更加方便了管理员对网站的维护，网站管理员通过对日志的分析可以得出系统的运行情况，对各个日志信息的分析更加保证了网站的安全性能。
网站日志进行分类，使其管理更加科学，更加方便维护。
2.18.1	系统管理日志
系统管理日志的类型包括了：
•	管理员登陆/退出。 
操作类型包括：登录记录、退出记录。
操作详情记录：管理员名称、登录IP、登录/退出时间。
•	系统参数管理。 
操作的类型包括三种：增加参数、修改参数、删除参数。
操作详情举例：
操作类型：修改参数
参数名称：发件人电子邮箱
参数内容：test@infoscape.com.cn
修改前内容：test@infoscape.com.cn
修改后内容：market@infoscape.com.cn
操作栏目ID：120
操作栏目路径：后台系统>配置管理>系统参数管理
2.18.2	商户业务数据日志
2.18.2.1	信息管理日志
信息管理日志包括了： 
•	信息分类管理。 
操作类型包括三种：增加信息分类、修改信息分类、删除信息分类。
操作详情举例：
操作类型：修改信息分类
分类名称：最新资讯
分类内容：分类名称：最新资讯；分类说明：包括行业最新动态......
修改前内容：姓名：最新资讯；分类说明：包括行业最新动态......
修改后内容：姓名：资讯信息；分类说明：包括行业最新动态....
操作栏目ID：121
操作栏目路径：后台系统>信息管理>最新资讯
•	信息内容管理 
操作类型包括：信息增加、信息修改、信息删除。
操作详情举例：
操作类型：信息修改
信息名称：网上商城在中国的发展迅速
修改前内容：标题：网上商城在中国的发展迅速；新闻来源：本站；发布时间：2008-07-02；内容：2007年中国的网上商城飞速发展......
修改后内容：标题：2008年是中国网上商城年；新闻来源：本站；发布时间：2008-07-02；内容：2007年中国的网上商城飞速发展......
操作栏目ID：121
操作栏目路径：后台系统>信息管理>最新资讯
•	信息审核 
操作类型包括：信息审核
操作详情举例：
操作类型：信息审核
信息名称：网上商城在中国的发展迅速
信息内容：标题：网上商城在中国的发展迅速；新闻来源：本站；发布时间：2008-07-02；内容：2007年中国的网上商城飞速发展......
审核前：待审核
审核后：审核通过；备注：校对无误审核通过。
操作栏目ID：121
操作栏目路径：后台系统>信息管理>最新资讯

2.18.2.2	商品管理日志
商品信息管理日志包括了：
•	商品分类管理 
操作类型包括三种：增加商品分类、修改商品分类、删除商品分类。
操作详情举例：
操作类型：新增商品分类
分类名称：海尔
分类内容：分类名称：海尔；分类说明：海尔洗衣机
操作栏目ID：121
操作栏目路径：后台系统>商品管理>家电>洗衣机
•	商品内容管理 
操作类型包括：信息增加、信息修改、信息删除、商品类别设置。
操作详情举例：
操作类型：商品修改
商品名称：LG洗衣机XQB50-398SN
商品ID：10000
修改前内容：商品名称：LG洗衣机XQB50-398SN；驱动方式：波轮；颜色：欧洲白色；外形尺寸：505*510*850mm ；
修改后内容：商品名称：LG洗衣机XQB50-398SN；驱动方式：波轮；颜色：欧洲白色；外形尺寸：505*510*850mm ；商品图片：<20080702001.jpg>
操作栏目ID：121
操作栏目路径：后台系统>商品管理>家电>洗衣机>LG
2.18.3	商户经营商品日志
商品经营管理日志包括了：
•	商品上下架。 
操作类型包括：商品上下架。
操作详情举例：
操作类型：商品上下架
商品名称：LG洗衣机XQB50-398SN
商品ID：10000
修改前内容：上架；可卖；
修改后内容：上架；不可卖；
操作栏目ID：121
操作栏目路径：后台系统>商品管理>家电>洗衣机>LG
•	价格管理 
操作类型包括三种：增加价格、修改价格、删除价格、批量生成价格。
操作详情举例：
操作类型：修改价格
商品名称：LG洗衣机XQB50-398SN
商品ID：10000
修改前内容：价格类型：普通会员；价格：1500；货币类型：人民币；方向：扣；是否用于支付：是
修改后内容：价格类型：普通会员；价格：1600；货币类型：人民币；方向：扣；是否用于支付：是
操作栏目ID：121
操作栏目路径：后台系统>商品管理>家电>洗衣机>LG
•	相关商品 
操作类型包括：添加相关商品、移除相关商品。
操作详情举例：
操作类型：添加相关商品
商品名称：LG洗衣机XQB50-398SN
商品ID：10000
相关类型：最佳组合
商品所属分类：后台系统>商品管理>家电>洗衣机
操作栏目ID：121
操作栏目路径：后台系统>商品管理>家电>洗衣机>LG
2.18.4	订单管理日志
系统自动记录每位管理员对订单系统的每一次操作，包括操作时间、类型等具体情况。有权限的管理员可以进行查看，在出现错误操作的情况下可以根据记录追究责任。
订单管理日志类型包括了：
•	订单状态修改 
操作类型包括：订单状态修改、支付状态修改、订单有效性。
操作详情举例一：
操作类型：订单状态修改
订单内部编号：10000
订单外部编号：2008070210001
下单时间：2008-07-02 12:00:00
修改前内容：处理状态 ：未处理；订单支付状态：未支付；完成状态：未完成。
修改后内容：处理状态 ：处理中；订单支付状态：未支付；完成状态：未完成。
操作栏目ID：121
操作栏目路径：后台系统>订单管理
操作详情举例二：
操作类型：支付状态修改
订单内部编号：10000
订单外部编号：2008070210001
下单时间：2008-07-02 12:00:00
支付方式：工商银行
修改前内容：处理状态 ：未支付。
修改后内容：处理状态 ：已支付。
操作栏目ID：121
操作栏目路径：后台系统>订单管理
•	更新商品信息 
操作类型包括：更新商品数量、添加商品。
操作详情举例：
操作类型：更新商品数量
商品名称：LG洗衣机XQB50-398SN
订单内部编号：10000
订单外部编号：2008070210001
下单时间：2008-07-02 12:00:00
支付方式：工商银行
修改前内容：数量：1（台）。
修改后内容：数量：2（台）。
操作栏目ID：121
操作栏目路径：后台系统>订单管理
•	订单分配 
操作类型包括：订单分配
操作详情举例：
操作类型：订单分配
订单内部编号：10000
订单外部编号：2008070210001
下单时间：2008-07-02 12:00:00
修改前内容：订单所属：总部。
修改后内容：订单所属：广州站。
操作栏目ID：121
操作栏目路径：后台系统>订单管理


2.19	权限管理系统
权限管理是系统实现对不同使用者划分对各种系统资源访问和系统操作的权限，是系统最基本的功能模块。
本系统采用类似大多数操作系统的权限管理模式，具有以下权限管理功能：
1)	用户分组功能
可把用户划分为不同的用户组。每个用户组都可以设置为具有不同的权限，用户属于某个组，就自动拥有该组的操作权限。
2)	每项资源对每个用户的权限可单独设置
系统中每一项资源的访问和每一项操作的权限都可以针对特定用户或用户组进行设置。使系统的权限配置具有最大的灵活性。
3)	权限的继承性
如果一个用户具有父项资源的操作权，并且配置为对子资源具有继承性，那么该用户就对子资源具有操作权。

在为管理员设置权限的时候，不同的管理员之间可能存在着相同的操作权限，如果一个网站系统的结构比较复杂，系统的栏目比较多，那么对管理员设置权限将会出现许多的重复工作。为了解决这个问题，我们在系统中增加了管理员组的概念，将许多具有相同操作权限的管理员，加入到同一个管理员组中，然后对这个管理员组进行分配权限。对于管理员和其所在的管理员组在某些权限上有不同分配时，最终有效的权限是对管理员的权限分配，也就是说查看管理员是否有权限，首先看管理员的权限是允许还是被拒绝，其次看管理员组的权限是允许还是被拒绝。例如某个管理员组不分配删除会员功能的权限，但是管理员组里的某个管理员需要有删除会员的权限，那只要针对这个管理员分配删除会员的权限，组里其他管理员将不受影响。
系统将有一个Root管理员账号，可以对其他管理员进行权限的设置，将其设置为最高管理员权限，对所有栏目都拥有最高的权限，可能对所有栏目进行操作，比如栏目中数据资料的浏览，录入，修改，删除等等一些操作。同样也可能对用户组进行权限的设置。例如，建立一个用户组Administrator，给予超级管理员权限，那么该用户组中的用户都拥有了相同的管理权限。权限管理，它可以对指定的栏目设置不同的权限，在栏目之间有继承的功能。
权限继承也是权限设置的一个非常重要的功能。对于系统的栏目设置权限的时候，可以继承到该栏目的父栏目所拥有的权限。这样做能够减少许多权限设置上的重复操作。
下面再一一介绍权限管理系统中所关联各项对象及功能实现的详细介绍。
2.19.1	管理用户和用户组
用户是指在系统中注册单个用户。用户组是指具有共同操作权限的一群用户的集合。用户/用户组的概念与操作系统中的用户/组的概念是一致的。一个用户加入一个组之后，就自动拥有了这个组的所有权限。一个用户除了拥有组的权限之外，还可以被赋予自己独有的权限。
在系统中，用户组可以被定义为对某个特定功能的操作角色。平台管理需要设定一些操作角色，例如专门有一些人去确认订单的有效性，一些人去做支付确认，另外一些人则负责客户的回访工作。我们可以把这些操作角色都设定成用户组，并配以专门的操作权限。以后一旦有新的用户加入，只要把他加入到特定的组，他就立即拥有该组角色的操作权限，马上上岗操作了。
用户与用户组的引入很大程度上减少了工作量，提高了工作效率。保证了系统的维护的方便与快捷。比如，公司新进员工，系统管理员只需要添加一用户账号，并将其加入到某一用户组中，那么他就有了该用户组的操作权根，无需做任何其它工作。
2.19.2	权限的设置
权限的设置是指对系统资源树各个支点所具有的管理权限设置。关于系统资源树上面已经清楚地介绍了。
权限是指特定用户进入该栏目后，对栏目提供的功能的操作权限。每个栏目都会有一个权限设置的功能。如果一个用户具有某栏目的“权限设置”的权限，进入这个界面设置的就是当前栏目的权限。典型的权限操作界面如下：

以上是对订单管理模块的权限设置。
我们看到屏幕左方列出的拥有该栏目操作权限的系统用户和用户组。如果您发现需要分配权限的用户或用户组并不在列表当中，就说明他目前还没有这个栏目的任何管理权限。您可以通过选择“添加用户”或“添加组”把需要分派权限的用户或组加到列表中。在选定了左边的用户或组后，就可以选择右边的功能项来配置被选用户的操作权限了。例如上图，我们可以选择君豪销售部，然后在右边设置相关的权限，也就是设置该用户组用户对订单所拥有的操作。设置完毕后，所属君豪销售部的用户登录后台就拥有了相关的管理权限。
我们还可以看到一个“该栏目用户继承父栏目的权限”的选择框。如果选择了此项，则当前栏目的所有用户都继承自己在当前栏目的父栏目中所拥有的权限。这个就是关于权限继承的问题，下面一点权限的继承将详细的说明。
2.19.3	权限的继承
用户在某栏目下所拥有的权限除了通过自行在本栏目的设置外，还会通过一套继承规则从父栏目和该用户所属的所有组中获得。
我们在介绍用户和用户组的时候有讲过，一个用户属于一个组就会拥有该组的所有权限，这就是组权限的继承。下面，我们来介绍一下栏目权限的继承：
首先，一个用户在某栏目下所拥有的权限先看该用户在本地栏目下所设置的权限，如果某权限在本地没有设置，则找该用户所属的所有组在本地栏目下有没设置，有设置则用户得到该权限。用户在这一环节下所得到的权限，我们称为本地权限，在设置权限页面上显示为可设置。
进入第二个环节，如果该用户和其所属组在本地栏目下某权限都没设置，则这套规则就会找该栏目的父栏目，看看该用户和其所属组在父栏目下该权限有无设置，如果有则用户在本地栏目得到该权限设置，如没有则在按同样规则找他父栏目的父栏目，如没有，再往上找，直到最顶，还没有，那该用户在本地栏目下该权限就为没设置。以上这一环节得到的权限我们称为继承权限，在设置权限页面上显示为不可修改，即选择按钮为灰色DISABLE状态。
例如：现有A，B，C，D四级栏目，A为顶层栏目。每个栏目各有其自身所拥有的权限种类，用数字0~9表示，X表示一用户。表示权限的数字颜色为红色代表其为用户在该栏目的本地设置，为兰色代表为继承权限。（用户X在A栏目有本地权限1，3，4。在B栏目有本地权限4，5，6）
       
系统中每个栏目有一个是否继承的设置，如选择继承则按照上述规则得到用户权限，如设置成不继承，则该栏目下用户得到的权限只是本地设置，并且该栏目下的子栏目的用户权限也只能继承到这个栏目。比如上例，如果B栏目关掉继承，那么用户X在B栏目只有本地设置的4，5，6三种权限，并且C，D俩栏目将不能从B栏目包括B自己以上所有栏目继承得到权限，也就是说D栏目只能从C栏目继承权限了。
2.19.4	权限策略举例
用户组与每个栏目都可以独立指定权限的功能使的权限配置具有极高的灵活性。
例如，一个平台决定运营时划分如下6个操作角色：
	平台管理员：网上商城部管理员为平台最高权限管理员。拥有商品管理、订单管理、连锁管理、用户管理、以及新闻管理、评论管理、数据库维护下载、其他管理员的添加和修改等所有权限
	订单管理员：拥有查看所有订单以及更改订单状态，删除或者修改订单信息的权利，不具备除此以外的其他权利。
	用户管理员：用户管理员可以对平台所有用户的信息进行编辑、可以添加删除用户、可以更改用户积分。不具备除此以外的其他功能。
	信息管理员：针对所有信息的添加、编辑、删除权限。
对于以上角色需求，使用制定的权限策略：
角色	设置方法
平台管理员	1）	设置平台管理员组
2）	把所有栏目的权限都指定给这个组
3）	配置所有栏目继承父栏目权限
4）	把需要当这个角色的全部用户加入到这个组
订单管理员	1）	设置一个订单管理员组
2）	把“订单管理->用户订单管理”栏目的全部权限分配给这个组
3）	配置所有栏目继承父栏目权限
4）	把需要当订单管理员全部用户加入到这个组
用户管理员	1）	设置一个会员管理员组
2）	把“配置->注册会员管理”栏目的全部权限分配给这个组
3）	把需要当用户管理员的用户全部加入这个组
信息管理员	1）	设置一个“信息管理员组”
2）	把“文章管理->信息类别管理”栏目的全部权限分配给这个组
3）	把需要充当新闻管理员的所有用户加入这个组
从上面我们可以看出，通过把一些权限分配给一个组，那么就可以在系统中建立各种操作的角色。在实际平台的运营中，我们需要用到的操作权限管理是复杂的，需要的管理角色远远不止以上所提，管理是通过树管理方式，灵活并可随时可增加，同时还可以通过组和继承功能可以让权限管理功能变得既简便又灵活。
2.20	系统配置管理系统
2.20.1	参数配置
网上商城平台系统中有各种各样的参数，如邮件服务器的ip、登录账号、密码或者是商品水印图片等。这些关系到网上商城平台运作正常与否的参数都统一在系统参数配置模块中配置。
一个系统参数以参数键――参数值这样一种结构存在，程序通过唯一的参数键确定一个参数值。系统参数模块就是对这样的一些参数进行增加、修改、删除、查询等操作的模块。
    一个系统参数包括：
1	参数名：系统参数的简单描述。
2	参数键：用来唯一标识系统参数的名字，由英文字母及数字组成，不区分大小写。
3	参数值：分三种类型
	文本和数字：就是包含任意文本和数字的参数值。
	上传文件路径：上传一个文件，将文件在服务器上的路径作为一个参数值。
	密码：如果有不想被公开的参数值，则可以使用这个类型。
4	描述：详细描述参数的功能及要注意的地方。

2.20.2	任务计划配置
任务计划的作用是配置定时执行程序的模块，包括系统所有的进程程序配置。进程运行的时间与执行的方法，都可以在任务计划中增加、修改或者是删除。

2.21	数据统计分析系统
2.21.1	销售分析
2.21.1.1	总体销售分析
对商城系统的总体销售量进行统计分析：
1）	商品统计：以商城的商品数据为基础，按商品的品类统计商品的数量、商品的库存、商品的价格统计。
2）	销售量和销售额：商城的销售量与销售额，分日周月年进行统计。
3）	成交订单的平均客单价：计算订单的平均价
4）	订单处理成功率：计算订单成交率。
5）	总体销售趋势图：通过选择某一个时间段查看商品销售量和销售额，查看商品总体的销售趋势图。
2.21.1.2	品类销售分析
品类的销售分析功能如下图所示：

主要功能包括：
一、可以查看多级分类的销售占比。
图中是一个缝纫机设备与配件的销售企业的品类销售占比图。这个企业销售的商品除了整机之外，还有配件、辅助物料等商品。图中显示的是整机类商品中，各种类型整机的销售占比。我们可以看到“单针平缝机”占了整机销售数量的43%，是主打产品。
如果我们想知道单针平缝机里面，哪些品牌卖得最好，还可以继续点击“单针平缝机”的分类查看更细的销售占比。
二、可以按照“销量”和“销售额”来统计。
销量大的商品不一定是销售额最高的。因为不同类型的商品的单价相差很远。所以，系统提供了按照销售额和销量两种查询方式。
2.21.1.3	订单统计
订单总体情况
平台的订单数量统计主要是从全局角度统计分析订单的数量。
	订单数量统计按照可供选择某个日期区间、网上订单可供选择的处理状态、订单交易额进行统计分析。
	某个日期区间：系统提供统计计算的某个时间内发生的数据，默认必须指定时间段。
	网上订单的状态：系统可以提供按照订单的处理状态进行数量统计，主要包括全部有效订单数量统计、已经支付订单数量统计、已经完成关闭订单数量统计几种。

订单数量统计包括：订单状态、订单数量、订单交易额
例如：查询9月到10月平台的订单情况。
订单状态	订单数量	订单交易额	操作
已完成订单	30	96，623	查看详情
待确认订单	4	5，220	查看详情
待支付订单	8	7，250	查看详情
.。。。。。。			
点击“查看详情”打开该订单状态下的订单列表，点击订单能查看订单详情。
订单成功率
平台统计订单的处理状态统计订单的成功率。在购物流程中平台允许会员取消订单，当设置订单状态为已取消订单时，系统要求管理输入订单取消的原因。统计订单成功率能有效找出掉单的原因，从而改进流程并优化管理。
订单成功率= 已取消订单 / 订单总数 （某一时间段内）
时间	订单成功率	订单交易额
10月	78%	96，623
9月	69%	45，220
8月	72%	87，250
.。。。。。。		

支付/配送方式统计
根据支付方式与配送方式的不同统计订单的情况。通过不同的条件查找订单，然后再将搜索出来的结果进行统计。例如，可以查找最近的一个月内的订单情况。那么可以录入搜索条件：下单时间为2008-10-11到2008-11-11。在结果列表中选择“支付方式所点比”或者“送货方式所占比”。
订单结果列表：
 分支付方式统计报表：


分配送方式统计报表：


2.21.2	会员分析
2.21.2.1	会员统计
1.	会员基本信息统计：以商城注册的会员信息为基础，通过地区、年龄、教育程度几个维度进行分析商城会员数据。
	.	会员注册来源分析：以商城注册会员数据为基础，以会员来源进行归类，分别列出商城中会员注册来源。会员注册来源一般有：网上注册、电话注册、会员推荐、门店注册。
	.	会员购买情况分析：统计每一个会员在网站中下的订单数，总交易额。
	.21.3	流量分析
	.21.3.1	商品类别访问量统计
商品类别的功能菜单中都设了统计功能，管理员根据需要了解到该类别商品在前台的访问情况，如按天汇总数据分析、按周或按月汇总分析等。

	.21.3.2	商品访问量统计
管理员可以通过该功能，查询到某件商品在某个时间段的前台访问情况，有利于管理员进行商品信息总结。
	.21.3.3	信息访问量统计
系统自动收集各条信息的访问量情况，管理员可以通过信息标题后的功能栏中的“统计”功能进行查看，有助于管理者了解网站浏览者的心理，制定正确的商品促销和销售策略。
	.21.3.4	访问浏览分析
该部分引入第三方统计分析系统，目前在比较受欢迎的第二统计包括有：google统计、Yahoo统计、51LA统计、站长统计。
网站浏览统计一般包括了如下功能：
	.	总体数据：综合统计、最近访问
	.	分时统计：小时统计、每日统计、每周统计、每月统计、每年统计。
	.	内容统计：入口页面、被访页面。
	.	来源统计：来源地址，来源站点，来源地区。
	.	机器配置：操作系统、屏幕宽度、浏览器类型。
	.	搜索引擎：按来源地址、按来源站点、关键词统计、来源站点统计。
	.	IP 统计：P统计、IP三段统计、IP二段统计、IP首段统计。

第三方统计系统在不断的完善当中，他们所能提供的服务大大满足了各大网站用户的需求。第三方统计系统的引用大大节省了开发成本。


2.22	财务管理系统 
商城后台的账务管理，按跟商户的合作方式，分类联销和服务两种，主要处理以下三个方面的内容：
1、	销售报表
2、	商户结算
3、	其他业务收入
2.22.1	联销\代销账务管理
2.22.1.1	销售报表
1、	销售报表主要是统计各品类的商品的销售情况以成本的计算。
2、	系统需要对每天完成并且关闭了的订单进行统计；
3、	销售报表按照需求分四方面的报表：
	按品类
	按单品
	按商户
	按税率
按四个不同的条件，显示不一样字段的报表，如下：

1）	按品类，如下图：


说明：
销售成本的计算说明：如果有扣率的。就按扣率计算成本，如果没有扣率的要按商品的进货价来计算成本。
报表筛选条件：选择时间
导出凭证：点击这里导出按品类的销售报表，导出这个报表的时候，同时把“其他业务收入”里同时间段内的配送费导出同一个TXT文件里。
打印报表：点击这里直接打印列表；
报表的字段：品类、数量、销售额（含税）、销项税率、销售额（不含税）、销项税、销售成本（含税）、进项税率、销售成本（不含税）、进项税、毛得（含税）、毛利（不含税）、毛利率。
2）	按单品，如下图：


说明：
报表筛选条件：选择时间、商品编码、商品名称、商户编码、订单号。
导出凭证：点击这里导出按单品的销售报表，一般为TXT文件
打印报表：点击这里直接打印数据列表；（把筛选出来的结果，打印出来就行）
报表的字段：订单号、单品码、单品名称、商户编码、商户名称、品类、数量、销售额（含税）、销项税率、销售额（不含税）销售成本（含税）、进项税率、销售成本（不含税）、扣率。
3）	按商户，如下图：

说明：
报表筛选条件：选择时间、商户编码、商户名称、选择品类。
导出凭证：点击这里导出按商户的凭证，导出的为成本核算凭证。一般为TXT文件。
打印报表：点击这里直接打印报表；
报表的字段：品类、商户编码、商户名称、数量、进项税率、销售成本（含税）、进项税、销售成本（不含税）。
4）	按税率，如下图：

报表筛选条件：选择时间、按进项税率、按销项税率。
导出凭证：点击这里导出按税率的凭证，TXT文件
打印报表：点击这里直接打印筛选出来的列表； 
报表的字段：销项税率、进项税率、销售金额（含税）、销项税、销售成本（含税）、进项税、含税毛利。
2.22.1.2	商户结算
财务管理后台的商户结算主要管理以下两方面的内容：
	结算单生成
	结算单管理
结算单生成
1、	结算单生成栏目里，列出的全部都是已经完成但“结算单状态”为“未生成”的订单、退货单以及费用单。不会显示已经生成结算单的所有单据。参看商户后台的“单据查询”；
2、	财务人员可以按时间段、商户或者税率进行筛选；
3、	生成结算单界面不可以对结算单进行凭证导出，需要进入到“结算单管理”里面对结算进行凭证导出操作。
4、	结算单的生成，必需是选择了一个商户进行筛选后才能生成结算单


说明：
报表筛选条件：选择日期、选择商户、商户编号、选择税率。
生成结算单：点击这里生成结算单，必需要选择了商户才能生成结算单，生成结算单的单据将不在这里出现；
订单表字段：订单号、完成日期、商品名称、数量、售价、税率、扣率、应付、选择。 
退货单表字段：退货单号、完成日期、商户、退货单金额、税率（进项）、应收（不含税）、选择
费用单字段：费用单号、制单日期、商户、费用单金额、类型、原因、选择。
账期：是财务人员生成结算单时选择的日期，如：选择2008-12-1到2008-12-30  选择商户，后进行筛选，出来结果后，选中这些结果进行生成结算单。选择的这个时间就是账期
商户开发票金额：商户开发票金额＝（销售－退货）对应的成本金额合计－成本型扣款金额合计；
应付金额：应付金额＝商户开发票合计额－扣款合计额（非成本型+成本型）
点击货单号，打开退货单详细页

结算单管理
说明：
①	该处显示所有状态为“未付款”或“已付款”的结算单；
②	财务人员可以在图2.1中对点击状态列的“未付款”状态，对结算单的状态进行修改，将“未付款”的改为“已付款”；对于“已付款”状态不能修改。
③	财务人员可以取消状态为“未付款”的结算单，结算单取消后，该结算单里的所有单据返回到结算单生成的界面里。可以供再次选择生成新的结算单。
④	点击结算单号，可以查看到结算单的详细信息，如图2.2


图2.1说明：
商户开发票金额：商户开发票金额＝（销售－退货）对应的成本金额－成本型扣款金额合计
筛选条件：选择日期、选择商户、结算单号、结算单状态。
字段：结算单号、商户编码、商户名称、账期、制单日期（即生成日期）、制单人、商户开发票金额、扣款金额合计、进项税额、应付金额、状态、操作。
导出凭证：筛选出需要的结果后，点这里可以导出TXT文件。
打印列表：筛选出结果后，可以单选或者合选，点击“打印列表”，即可以对选择的结算单进行打印。


图2.2说明：
打印：在结算单详细页按打印按钮，打印该结算单的明细。打印样式如：图2.4
成本型扣款金额：成本型的费用单的扣款金额，
非成本型扣款金额：非成本型的费用单的扣款金额。
商户开发票价税合计额度：商户开发票价税合计额度＝商户开发票金额+进项税额
表单打印样式，所有需要打印列表的都按些样式打印，只是内容不同：如图2.4：

图式2.3
联销模式的结算单明细打印样式，如下图：

                             图2.4
2.22.1.3	其他业务收入
其他业务收入主要是配送费收入，如下图：

报表筛选条件：选择时间、订单号
导出凭证：配送货用的凭证导出不在这个地方导出，在按分类的销售凭证导出的时候同时导出相同时间段的配送费用凭证。 
打印：点击这里直接打印报表；（打印选中的筛选结果）
报表的字段：订单号、完成日期、配送费。 

2.22.2	服务账务管理
2.22.2.1	销售报表
在财务管理里，服务模式的销售报表只有一张，如下图：

说明：
报表筛选条件：选择时间、商户编码、商户名称
导出凭证：点击这里导出销售报表，一般为TXT文件。
打印：点击这里直接打印报表；
报表的字段：商户名称、单品、数量、代收货款、扣率、应收费用。
2.22.2.2	商户结算
	结算单生成
	结算单管理
结算单生成

说明：
点击退货单号或者费用单号，可以打开详细页。
报表筛选条件：选择日期、选择商户、商户编号、选择提成比例。
生成结算单：点击这里生成结算单，必需要选择了商户才能生成结算单，生成结算单的订单将不在这里出现；
订单表字段：订单号、完成日期、商品名称、数量、售价、扣率、应付、选择。 
退货单表字段：退货单号、完成日期、商户、退货单金额、扣率、选择
费用单字段：费用单号、制单日期、商户、费用单金额、类型、原因、选择。
商户开收据金额：应开收据合计额=应付金额合计-退货合计    
应付金额：应付金额=应开收据合计－费用合计额

结算单管理

说明：应开收据合计额=应付金额合计-退货合计    实际应付款=应开收据合计－费用合计额
筛选条件：选择日期、选择商户、结算单号、结算单状态。
字段：结算单号、商户编码、商户名称、账期、制单日期、制单人、商户开收据金额、扣款金额合计、应付金额、状态、操作。
导出凭证：一般导出TXT文件。
打印列表：筛选出结果后，可以单选或者合选，点击“打印列表”，即可以对选择的结算单进行打印。

点击结算单进入结算单详情：如下图：

按打印直接打印该结算单。

服务模式的结算单凭证打印样式，如下图：

2.22.2.3	其他业务收入
服务模式的“其他业务收入”和联销的“其他业务收入”是同一个表，详情见联销的“其他业务收入”。

2.23	库存管理系统
商品的库存是指各个商品的总参考库存，主要用来提供给商城系统管理员进行跟踪查看，并据此对商品进行上下架、是否可卖以及是否缺货登记。
商品的总参考库存数在商城系统订单出货后，需要冲减更新库存总数。同时，总是以ERP对接更新为主进行，与ERP商品库存的对接详细请见本文与第三方系统对接方案一节相应描述。
2.23.1	仓库管理
仓库管理即系统定义的库区管理。包括了仓库分区，以及管理商品库存、进出仓记录的总集合点。也就是，所有的库存管理，都是基本库区为据点进行操作的。
	每个仓库分区可以独立管理
增加一个独立的库存管理区，可分配置管理员，将权限分配给相应的人员管理。库存管区可动态无限增加的，把这个库区的操作权限分配管理员即可。
	库存查询
 “库存查询”用于查询企业商品的库存，可以查询商品总库存和分仓库查询。可以获得每种商品的库存信息。查询到的数据库资料应有如下内容：库存编号，当前数量，商品名称，安全存量，最后进货日期，最后送货日期。
	同型号不同款商品不同库存
在同一件商品中，可能存在着一些特别属性的区分，比如衣服商品中的颜色与尺码，同款汽车中的手动波与自动波。这一些区分在库存的管理上都要清晰的对应区分开来。
在本商场的库存系统中，可以自定义商品的属性来区分商品库存，无论商品是怎么分款式的，只要能通过属性进行区分，对属性进行库存定义后，都可以把不同款的商品区分开来。
同时，在添加进出仓记录时，如果商品有对库存的自定义属性进行了标准值的设置，在添加进出仓记录时，可以直接采用选择标准值的录入方法，尽大可能的避免失误操作。
2.23.2	进出库记录
进出仓记录是对商品进货及出货的管理，将每一次的进货出货记录都记录保存起来，自动更新库存的数量。在进出仓记录中，除了与货品(商品)相关外，还涉及到往来方管理及进出仓原因的管理。进出仓记录区分库区，各库区对应着自己库区的货品数量管理。
	进出库数量自动统计
在本库存管理中，每个进出仓记录严格对应，自动统计。
货物的进仓出仓，商品数据有增有减，系统需要做到自动把数据统计到最新。
进出仓记录除了严格对应商品名称外，还对录入的与进出仓记录中相应的商品属性也要一一对应，在全部吻合的情况下，将对记录进行智能的增减统计，最后保存当前最新的商品库存数量。
例如：如在昨天进仓了“颜色为蓝色，编号为1000ML的A商品，数量为10”的记录，今天也在同一库区继续就同样的记录添加了“数量为8”的同件同款商品，则查询库存的时候，则可以看到“颜色为蓝色，编号为1000ML的A商品，数量为18”。
	支持批量进出仓操作
本系统支持批量的进出仓操作，如在进仓或出仓一批货物时，可增加多件货品在一条进出仓记录中，添加批量进仓或出仓记录。同时，同一条进出仓记录，可包含进仓与出仓的操作，并可对本次操作进行原因或记录操作说明。
2.23.3	库存盘点
“库存盘点”用于管理企业的库存盘点工作，将实际盘存的商品数量输入计算机，计算机自动与数据库中的库存数量进行核对并产生盘盈盘亏统计信息。的库存数量进行核对并产生盘盈盘亏统计信息。
3	与第三方系统的对接
3.1	支付网关接口
商城系统有一个支付网关配置接口，可以直接在后台进行配置。目前本系统的支付网关支持的银行接口有：工行、招行、建行、首信、还迅、上海银联、广州银联，以及支持其它支付方式的定制。
支付方式的配置在前面“支付管理系统”已经作了详细介绍，本部分就略过不再详细说明。
3.2	邮件接口
邮件系统接口配置项目包括了：
1.	设置邮箱相关参数配置，例如邮件服务器的IP、用户名、密码等。 
	.	设置邮件发送的时间段，系统只有在配置的这一段时间才会给用户发邮件。 
使用邮件进行发送的主要内容有：
一、流程提示
采用邮件模板的流程提示，主要包括以下几部分的内容：
	）	注册流程 
客户前台注册成功后，系统会自动发送邮件提示客户注册成功并将帐户信息发送给客户。
	）	订单流程 
下单成功：客户在前台下单成功后，系统会自动发送邮件通知客户；
	）	取回密码流程 
当客户在前台申请取回密码并成功时，发送邮件通知客户取回密码成功，并将新密码发送给客户。
二、信息订阅
在会员的专区中，会员所订阅的信息就是通过邮件的方式发送给会员的。在后台管理增加订阅信息并将信息发送任务提交给系统，系统会在指定的时间发送邮件给有订阅相关信息的用户。
三、支持扩展
可以在系统中定义一些关键事情，通过邮件接口来发送信息提醒客户。
	.3	淘宝接口
	.3.1	概述
淘宝是一个非常成功的网上商城平台，上面大量的用户流量，每天有大量的交易发生。为了充分利用淘宝的人气，我们可以在淘宝上开多家商店，但是当开多家商店的时候，店铺的管理就会占用大量的人力物力，使得不能开太多的店。

目前平台在淘宝上开了10个店铺，所需要的管理工作已经占用了现有的全部人力，不能在开更多的店铺。

为此我们将提供淘秀商城与淘宝网的接口，使得管理员在平台后台的情况下，就能管理淘宝上的众多的店铺。接口主要包括有如下的功能：

	商品库存同步更新
淘秀和所有的淘宝网店，实际上是共享同样的库存，当平台的库存变动以后，系统会实时的将改变后的库存更新到各个淘宝网店。
各个淘宝网店在接受到订单以后，将会把订单统一汇集到平台的后台订单了处理模块中，统一进行处理（见下面《订单统一处理》一节），因此由于处理订单引起的库存变动会实时的反映到平台，然后又反映到各个淘宝网店。

	商品资料同步更新
商品资料包括商品的图片、说明、价格等统一在平台的后台更改，更改后通过接口自动更新到各个淘宝网店。

	新品录入同步更新
平台新品上架的时候，会自动的添加到各个淘宝网店。

	商品上下架同步更新
平台上的商品上架或者下架，也能同步更新到淘宝网店，使得众多的淘宝网店同时上架或者下架。

	商品推荐同步更新
利用平台的商品推荐栏目对应淘宝网站的商品橱窗，当商品在平台上被推荐到一个推荐栏目的时候，同时也推荐到淘宝网店的商品橱窗里。

	订单统一处理
平台定期通过接口，将淘宝众多网店的订单下载到平台的订单系统中，平台的网上商城人员，登陆到平台的后台就能看到所有的网店的订单信息。订单下载间隔建议设置为1-5分钟。这样基本上客户下单后，差不多马上就能反映到平台的后台，又不会对系统造成很大的负担。

管理员在平台后台进行订单处理，例如确认订单，修改配送状态，支付状态，订单完成后修改库存等。订单的改变系统将通过接口实时的更新到订单所在的淘宝网店上，客户可以在淘宝网店上实时的看到订单的状态变化。

	统一交易评价
系统定期下载交易评价，平台管理员在平台后台就可以统一的查看到各个淘宝店的留言。管理员可以在平台后台就进行回复，也可以批量的给各个店铺发送留言回复等。

下面我们将针对每一点做详细的说明。

3.3.2	商品库存同步更新
在前期的交流中，我们得知库存的同步管理是当前面临的一个比较严重的问题，更新各个淘宝店的库存成为一个工作量巨大的事情，而库存更新不及时，又会引起客户的满意度下降，因此商品库存的同步更新问题是本次工程的一个重点需要解决的问题。

我们的解决方案是在平台里建立一个统一的库存系统（见技术方案中库存部分），所有的网店的库存都以这个统一的库存系统里的为准。

平台的库存有有两个来源，一个是与各个门店共享的库存，这部分库存由集团的erp进行管理。另外一部分是网站特有的库存，只供网站使用，这部分库存是由网站直接管理还是由集团的erp系统一起管理需要进一步的沟通，指定详细的实施方案。

这里我们假设是有网站直接进行管理，这样平台库存的变化就有两个途径，一个是erp数据变化，通过erp导入接口引起平台内库存的变化（详见技术方案中库存管理和erp对接部分部分），另外一个是有平台后台对库存的操作引起。由erp导入的库存实时性会比平台直接管理的库存差，例如erp导入可能只能做到每天一次的频率。更新频率需要与集团的erp部门深入沟通制定具体的更新频率。

无论平台的库存更新实时性如何，平台与淘宝网店之间的更新是实时的，只要平台内的库存一旦发生变化，就会通过淘宝网的接口，将更新后的库存立即更新到各个淘宝网店（具体的时间要视开店的数量，网络的情况，库存更新的数量等情况而定，估计大多数情况下在一分钟以内更新到所有的淘宝网店）

要实现同步更新，就必须要在多个淘宝店中的宝贝，和平台中的商品之间建立对应关系，识别出是相同的商品才行。
我们可以通过给各个淘宝店的宝贝和平台的商品一个统一的sku号来进行识别。通过系统的商品更新，新商品录入增加接口，可以自动维护这个统一的识别号。

3.3.3	商品资料同步更新
当管理员修改了平台中的商品资料的时候，会触发一个时间，通知淘宝接口，更新到每一个淘宝网店。

可以更新的资料包括：
名称	类型	是否必须	描述
iid	string	必须	需要修改商品的id
approve_status	string	可选	商品上传后的状态。onsale出售中，instock库中
cid	string	可选	叶子类目id
num	int	可选	商品数量
price	string	可选	商品价格
title	string	可选	宝贝标题
desc	string	可选	商品描述
location.state	string	可选	所在地省份,如浙江
valid_thru	string	可选	有效期,7或者14
has_invoice	boolean	可选	是否有发票,true/false
has_warranty	boolean	可选	是否有保修,true/false
auto_repost	boolean	可选	自动上架,true/false
has_showcase	boolean	可选	橱窗推荐,true/false
post_fee	string	可选	平邮费用,如5.00
express_fee	string	可选	快递费用,如15.00
ems_fee	string	可选	ems费用,如25.00
list_time	date	可选	上架时间,如2008-05-26 09:12:00
location.city	string	可选	所在地城市,如杭州
freight_payer	string	可选	运费承担方式,seller（卖家承担），buyer(买家承担）。
seller_cids	string	可选	店铺类目列表.这里只做添加操作，不会覆盖原有的分类.
has_discount	boolean	可选	支持会员打折,true/false
increment	string	可选	加价幅度
image	byte[]	可选	商品图片
auction_point	string	可选	商品的积分返点比例
property_alias	string	可选	属性值别名
sku_ids	string	可选	更新的sku的id串，结构如：id1,id2,…
sku_properties	string	可选	更新的sku的属性串，结构如： pid11:vid11;pid12:vid12,pid21:vid21;pid22:vid22,…
sku_quantities	string	可选	更新的sku的数量串，结构如：2,3,…
sku_prices	string	可选	更新的sku的价格串，结构如：10.00,5.00,…
sku_outer_ids	string	可选	更新的sku的外部id串，结构如：1234,1342,… sku_ids, sku _properties, sku _quantities, sku _prices, sku _status, sku _outer_ids在输入数据时要一一对应，如果某个属性没有要更新的就在逗号之间什么都不要写。更新旧的sku属性要写上sku的id，新添加的sku就不用写id和status了。（建议单独更新）
postage_id	string	可选	宝贝所属的运费模板ID，如果没有返回则说明没有使用运费模板
props	string	可选	商品属性列表pid:vid;pid:vid...
stuff_status	string	可选	商品新旧程度(全新:new，闲置:unused，二手：second)

在实际的运营中，某些字段可能用不上，具体更新的详细细节，需要在实施的过程中与平台的经营人员进一步细化确定。
3.3.4	新品录入同步更新
当平台中录入了新的商品的时候，系统自动将会通过接口，将商品发布到各个淘宝网店中。
名称	类型	是否必须	描述
approve_status	string	可选	商品上传后的状态。onsale出售中，instock库中
cid	string	必须	叶子类目id
props	string	可选	商品属性列表
num	string	必须	商品数量
price	string	必须	商品价格
type	string	必须	发布类型,fixed(一口价),auction(拍卖)
stuff_status	string	必须	新旧程度,new(新),second(二手),unused(闲置)
title	string	必须	商品标题
desc	string	必须	宝贝描述,字数要大于5个字节
location.state	string	必须	所在地省份,如浙江
location.city	string	必须	所在地城市,如杭州
freight_payer	string	可选	运费承担方式,seller（卖家承担），buyer(买家承担).设置为买家承担的时候，如果用户设置了运费模板会优先使用运费模板，否则要同步设置邮费（post_fee,express_fee,ems_fee）。
valid_thru	string	可选	有效期天数,7或者14
has_invoice	string	可选	是否有发票,true/false。默认false。
has_warranty	string	可选	是否保修,true/false。默认false。
seller_cids	string	可选	店铺类目列表,按逗号分隔
has_discount	string	可选	是否支持会员打折,true/false
post_fee	string	可选	平邮费用,如5.00
express_fee	string	可选	快递费用,如15.00
list_time	string	可选	上架时间,2008-05-26 09:12:00
increment	string	可选	拍卖的加价幅度
auto_repost	string	可选	自动上架,true/false
has_showcase	string	可选	橱窗推荐,true/false
ems_fee	string	可选	ems费用,如25.00
image	byte[]	可选	商品图片
postage_id	string	可选	宝贝所属的运费模板ID，如果没有返回则说明没有使用运费模板
auction_point	string	可选	商品的积分返点比例，如：5
property_alias	string	可选	属性值别名，如pid:vid:别名; pid1:vid1:别名1
sku_properties	string	可选	更新的sku的属性串，结构如： pid11:vid11;pid12:vid12,pid21:vid21;pid22:vid22,…
sku_quantities	string	可选	sku的数量串，结构如：2,3,…
sku_prices	string	可选	sku的价格串，结构如：10.00,5.00,…
sku_outer_ids	string	可选	sku的外部id串，结构如：1234,1342,… sku_properties, sku_quantities, sku_prices, sku_outer_ids在输入数据时要一一对应，如果没有sku_outer_ids就在逗号之间什么都不写就好
具体的字段和流程，需要在在实施过程中双方沟通，细化确定。
3.3.5	上下架同步更新
管理员在平台进行商品的上下架管理，系统自动的将商品在各个淘宝网店内进行同步的上架和下架操作。在平台上进行了操作1分钟以内，就能在所有的淘宝网店上执行完上下架操作。
3.3.6	商品推荐同步更新
利用我们系统的自定义推荐栏目的功能，在平台上建立淘宝橱窗专门推荐栏目，在平台上将商品推荐到这个栏目的时候，系统会自动调用接口，将商品推荐到所有淘宝店的橱窗位置。

3.3.7	订单统一处理
a）订单的统一显示
系统每隔几分钟从所有的淘宝网店读取一次订单信息，写到平台的订单数据库中。管理员可以在平台的后台就看到所有的淘宝网店以及平台本身的订单信息。

b）订单处理
管理员可以在平台后台进行订单的处理，例如：订单确认，发货，修改库存等操作。管理员可以很清晰的看到订单当前的处理状态。
由于淘宝网目前不提供修改订单状态的API,因此目前无法将订单状态的修改更新回淘宝的网店。如果有必要，可以由管理员手动更新订单状态回淘宝网店。当淘宝网增加了这个功能的API的时候，我们就可以实现订单状态同步更新会淘宝网店的功能。

3.3.8	统一管理交易评价
系统自动的定期获取各个淘宝网店的交易评价信息，管理员登陆到平台的后台就能够看到所有的交易评价。系统提供按照淘宝网店对评价进行筛选的功能。

平台也可以在后台直接对某个交易订单发表评价，系统会调用接口，直接发表到相应的淘宝网店。

3.4	与ERP对接
与ERP对接主要包括了商品基本资料对接、商品价格对接、商品库存和商品订单数据几部分。首先需要确定ERP与B2C商城之间数据结构的定义。对接的实现方式主要有两种：
一、通过生成接口文件以FTP或者Web Service方式来实现对接。（目前系统采用）
B2C商城系统与ERP系统交互的数据结构确定之后，双方系统协定生成指定的接口文件，通过FTP或者Web Service方式传输数据。区间双方系统都有一个接口数据处理的步骤。这种方式就是目前我们系统所采用的方式。详见下一节“附：信使网客通系统数据交互”中将做详细介绍。
二、共用一个中间库实现对接
还有另外的一种方式，就是将商城系统与ERP系统整合在一起通过共用中间库的方式来实现数据的对接。将商城系统与ERP系统之间需要交互的数据定义好一个中间库，分别与访问与保存各自需要的数据。除了数据结构的定义以外，还需要定义交互的流程规范，定义系统交互的先后顺序与交互时间的设置。至于商城与ERP交互数据详细的结构，需要具体定义。中间库数据结构的定义将以上面一种接口文件格式为基础上进行设计。这种对接方式需要B2C与ERP双方系统商户之间的协作，共同定义中间库的格式，并且各自开发为实现数据对接而进行的程序开发工作。
3.5	附：信使网客通系统数据交互
信使网客通产品已经有一套成熟的数据接口标准。数据交互模块是B2C与其它系统（ERP/SCM/MIS）交换数提出据的解决方案，是B2C系统的子系统，也可作为标准的导入数据接口使用。商城系统都是基于这一套接口标准来实现系统对接的。商城提供标准的第三方数据接口，主要包括了三大部分：
一、	商品接口
标准的商品数据接口，省去去了重复录入商品信息的工作，保证商品信息的同步更新，同时也确保了商品信息的准确性。
二、	订单接口
标准的会员数据接口，轻松实现将网上会员与网下会员数据的同步。
三、	会员接口
标准的订单数据接口，实现了网上与网下订单的同步。
3.5.1	系统设计总体架构

3.5.2	业务模块介绍
   目前定义B2C与ERP数据交互数据有：会员数据、订单数据、商品数据，本节介绍B2C V1.0提供的双方交换数据的内容。
B2C系统与ERP系统定义双方数据交换协议，协议内容明确了双方要交换的具体数据内容。
3.5.2.1	会员数据交互
	B2C提供给ERP系统的会员数据
B2C系统将新增或更新的会员资料传送到数据交互模块，由ERP读取更新到ERP系统。
	B2C接收ERP的会员数据
ERP系统将新增或更新的会员资料传送到数据交互模块，由B2C读取更新到B2C系统。
3.5.2.2	订单数据交互
	B2C提供给ERP系统的订单数据
订单头资料：B2C系统将新增或更新的订单资料传送到数据交互模块，由ERP读取更新到ERP系统。
订单项资料：B2C系统将新增或更新的订单项资料传送到数据交互模块，由ERP读取更新到ERP系统。
订单状态：B2C系统将更新的订单状态传送到数据交互模块，由ERP读取更新到ERP系统。
	B2C接受ERP系统的订单状态
ERP系统将更新的订单状态传送到数据交互模块，由B2C读取更新到B2C系统。
3.5.2.3	商品数据交互
	B2C提供给ERP系统的商品数据
B2C系统将新增或更新的商品资料传送到数据交互模块，由ERP读取更新到ERP系统。
	ERP提供给B2C系统的商品基本数据
3.5.2.4	接口文件结构示例
	会员资料：
字段名称	备注
Id	B2c唯一标识
loginId	登陆ID
realName	真实姓名
email	用户的email
homeAddress	用户的家庭住址
officePhone	用户的办公地址
homePhone	用户的家庭电话
mobilePhone	用户的移动电话
province	用户所在的省
city	用户所在的城市
postalCode	邮政编码
gender	用户的性别  0：表示男性；1：表示女性; 2：保密
createDate	用户的创建时间
lastModifiedDate	最后修改时间
birthday	用户的出生日期
education	教育程度  0: 未选(默认值), 1: 小学以下, 2:小学, 3: 初中, 4:高中、中专, 5:大学、专科, 6:研究生以上
income	月收入
marriage	婚姻状况 1: 己婚, 2: 未婚
扩展信息

	订单资料
字段名称	备注
Id	B2c唯一标识
aliasCode	订单的外部ID
ownerID	订单所属用户ID
orderTypeId	0：正常订单1：退货订单2：积分换购订单
processType	订单是货到付款还是款到发货 0：款到发货；1：货到付款；
orderFromId	订单来源ID 0 ---网上订单 1 --- 门店订单 2 --- 电话订单
remark	备注
createDateTime	创建日期
	
buyerTel	购买人固定电话
buyerPostMark	购买人邮编
buyerAddress	购买人地址
buyerMobile	购买人移动电话
……	……
……	……
扩展信息

	商品数据：
字段名称	备注
id	B2C订单唯一标识
Title	B2C订单ID
price_MarketPrice	市场价
price_MemberPrice	普通会员价
price_SilverPrice	银卡价
price_GoldPrice	金卡价
price_DiamonPrice	钻卡价
扩展信息

3.5.3	各业务模块层次结构
3.5.3.1	总体结构

3.5.3.2	B2C业务层
数据是否能达到双方都同步，是需要相互维护对方的主键的。
例如，b2c将某个商品资料同步到ERP，ERP就得根据商品资料里的erpcode作判断，如果erpcode能找到对象的商品资料就可以作更新，同理ERP想要更商品资料到b2c也需要将b2c的商品主键传过来，b2c由这主键找到该商品，然后更新。但并不是这么容易的，维护对方的主键需要双方协议好流程，以下分五种情况进行：

	B2C新增加了数据并同步到ERP
	B2C新增加了数据，这时B2C端只有B2C的主键，没有ERP主键
	B2C将新增加的数据上传到Exchange
	ERP从Exchange模块下载了B2C的数据，分析数据得知结构中ERPPrimaryKey是空值的，ERP将数据新增加到系统中，并把更新后的结果上传到Exchange，目标是把生成的B2CPrimarykey同步给B2C。
	B2C从Exchange模块下载了ERP同步的数据，根据b2cPrimaryKey找到对应的数据，并更新。

 


	B2C修改了数据并同步到了ERP
	在B2C与ERP已经保持数据同步的前提下，这时B2C端拥有了B2CPrimaryKey和ERPPrimaryKey，B2C更新了数据。
	B2C将更新后的数据上传到了Exchange。
	ERP从Exchange模块中下载了数据，并开始分析数据，根据ERPPrimaryKey找到对应的数据并开始更新数据。

 


	ERP新增加了数据并同步到了B2C
	ERP新增加了数据，这时ERP端只有ERP的主键，没有B2C主键
	ERP将新增加的数据上传到Exchange
	B2C从Exchange模块下载了ERP的数据，分析数据得知结构中B2CPrimaryKey是空值的，B2C将数据新增加到系统中，并把更新后的结果上传到Exchange，目标是把生成的B2CPrimarykey同步给ERP。
	ERP从Exchange模块下载了B2C同步的数据，根据ERPPrimaryKey找到对应的数据，并更新。

 


	ERP修改了数据并同步到了B2C
	在B2C与ERP已经保持数据同步的前提下，这时ERP端拥有了B2CPrimaryKey和ERPPrimaryKey，ERP更新了数据。
	ERP将更新后的数据上传到了Exchange。
	B2C从Exchange模块中下载了数据，并开始分析数据，根据B2CPrimaryKey找到对应的数据并开始更新数据。

 


	特殊情况：B2C不新增数据，只接受ERP的数据更新
这种情况出现的情况是，ERP已经拥有了产品的管理规范，他的目标只需要把现在的数据初始化到B2C，则ERP不必维护B2C的B2CPrimaryKey了，只需要把ERPPrimaryKey和其它的信息同步到B2C，然后B2C根据ERPPrimaryKey找到对应的数据并更新或新增。

 

3.5.3.3	传输层
一、B2C传输层

	Webservice 客户端
B2C调IS-Exchange公布的接口（请参考IS-Exchange接口层），将数据提交到Is-Exchange，或者从Is-Exchange下载到B2C并且在服务器端实现文件备份。
具体接口定义查阅 附件 B2CWebService.wsdl
	FTP客户端
B2C上传数据文件到固定的IS-Exchange目录，或者从Is-Exchange下载文件到B2C并且在服务器端实现文件备份。
FTP客户端的实现利用了apache的FTPClient调用FTP服务器端接口。
二、ERP传输层
	Webservice 客户端
ERP调用IS-Exchange公布的接口（请参考IS-Exchange接口层），将数据提交到Is-Exchange，或者从Is-Exchange下载到ERP并且在服务器端实现文件备份。
具体接口定义查阅 附件 B2CWebService.wsdl
	FTP客户端
ERP上传数据文件到固定的IS-Exchange目录，或者从Is-Exchange下载文件到B2C并且在服务器端实现文件备份。
3.5.3.4	IS-EXCHANGE接口层
一、B2C接口
	WebService接口
接口类：
ExchangeWebService.java
Package：net.xinshi.jemall.exchange.server.webservice
接口：
1. 上传文件，传入的参数为  文件压缩后的字节流和文件路径名称
public void upload(byte []bs, String strFile) throws Exception;
2. 下载文件，传入的参数为  文件路径名称，返回文件字节流
public byte[] update(String strFile) throws Exception；
3. 获取一个目录下的所有文件路径名称，返回一个文件路径名称的集合
public List<String> getFileNameList(String path) throws Exception；
4. 剪切一个目录下的全部文件到目标目录，传入的参数为  源文件目录和目标文件目录
public void move(String fromPath,String toPath) throws Exception；
实现类：
ExchangeWebServiceImpl.java
Package: net.xinshi.jemall.exchange.server.webservice

		FTP目录
详情参见附表C  Ser-U FTP安装说明与配置，FTP服务器开放数据文件目录并且设置目录的访问权限为可读、可写、可删除、可移动：

二、ERP接口
与上一节B2C接口其共用一个接口文件，FTP目录也与上面一节相对应。
3.5.4	各层次结构定义、设计
3.5.4.1	B2C提交数据到IS-Exchange流程图

3.5.4.2	B2C更新数据总体流程图






4	网站前台设计
网站主要前台页面有：
	商品频道
	商品详细介绍
	商品推荐
	商品排行榜
	商品搜索
	商品比较
	商品订购
	促销信息
	新闻动态
	会员社区
	用户注册
	用户专区
4.1	主要页面说明
网站前台的拓扑结构图如下图所示：

4.1.1	首页
客户可以通过顶级域名进入到网站首页，首页主要有以下几个版块内容：
	会员专区/注册入口
会员是商城用户管理的基本概念。每个浏览者都可以注册成为商城的会员，并通过会员登录入口进入到自己的个性化管理空间。另外密码取回功能是通常会员系统必备的功能，本系统设计通过邮件取回。
	商品分类
商品分类商品列表栏目及超链接功能。
	商品促销推荐信息
显示该门店现有的促销信息，包括名称、价格、小图等。例如有会员价、促销价等商品。
	商品分类推荐信息
分别以热卖商品、推荐商品等信息块显示商品信息，包括名称、价格、小图等。
	商品排行榜信息
显示该分站的商品销售排行榜和访问量排行榜。
	商品搜索功能
商品搜索功能是最主要的功能之一，我们将设定商品分类搜索，商品高级搜索等功能。通过搜索客户可以直接找到自己想要的商品。
	会员社区入口
显示会员社区的链接入口。
	广告位
广告服务是公司另一项重要的收入来源，广告位可以通过后台广告位管理模块进行管理，具体功能请参阅广告管理系统。
	购物相关信息
放置与购物操作相关的指导信息，引导在网站上的购买。如用户购物、电话购物需知等信息。
	支付方式
相关支付方式信息指导。
	送货方式
列举送货方式，如包括自取货、送货上门等。
	客户须知
列出客户须知信息。
4.1.2	商品分类页
商品分类页是一类商品的专门频道，就是每一类的商品都将有一个专门的分类页，这个页面内容顾名思议主要就是对该类商品进行介绍，提供更多导购信息帮助消费者进行此类商品的选购，有该类商品的业界动态、该类商品的促销、优惠、新品信息等。
商品频道页的主要功能元素有：
4）	购物向导
放置购物导购信息，主要是帮助消费者选择合适自身的商品。
5）	商品导购
以商品搜索为主旨，帮助消费者找到自己想以的商品。
6）	优惠推介
以信息发布的形式向浏览者推介现在的促销信息。
7）	新上市商品
以商品小图及简单介绍方式向浏览者展示新上市的商品。
8）	特价商品
以商品小图及突出价格优惠展示特价商品。
9）	团购商品
以商品小图及突出价格优惠展示特价商品。
10）	销售排行榜
显示商品小图、商品简单介绍、商品销售排行、商品价格等来展示热销商品。
4.1.3	商品详细页面
商品详细页面是对一个商品的详情介绍页面，页面内容除了是对商品的内容参数图片的展示外，还有与该商品相关的相关配件、相关评论外；以及设置与该商品相关的导购信息、温馨服务、小贴士等，指导客户进行该类商品的选购及与该商品相关的服务等；更有商品的订购按钮，客户可以直接在这里对一个商品下订单。另外，也可以在这个页面的页头上，选择其它类商品等功能配备。
商品的详细介绍页面对商品的介绍主要分为：
1）	商品参数
	对商品的各技术参数进行介绍。
2）	相关配件
	显示与这个商品相关的配件。
3）	商品导购
	商品的导购信息。
4）	客户留言
客户可以对商品进行留言操作。
5）	相关评论
	显示网友对这个商品的评论信息。
如下示例图：


4.1.4	商品推荐频道
商品推荐，在网站上查看推荐的商品时，默认是浏览网站的全部商品推荐，用户可以自己选择查看某一品类商品的推荐，或者是某一品类的某一品牌的商品推荐。

4.1.5	商品排行榜频道
商品排行榜，在网站上查看排行榜的商品时，默认是浏览网站的全部商品的排行，用户可以自己选择查看某一品类商品的排行，或者是某一品类的某一品牌的商品排行。排行榜还分日排行、周排行、月排行、年排行，用户可以选择排行的时间，查看当日的排行榜，当月的排行榜，历史年、月的排行榜。如下图：

4.1.6	商品搜索
为方便网站用户对网站商品信息以及新闻信息的搜索，网站提供了快速搜索功能，另外，网站还提供高级搜索功能，可以对商品信息进行更精确的搜索。
4.1.6.1	快速搜索
输入商品的名称的关键字，即可查询出该商品的价格等信息。需要输入多个关键字进行查询的，关键字之间以空格分开，查询结果将返回包含这些关键字的集合。如下图：

4.1.6.2	高级搜索（关键属性搜索）
选择商品分类、品牌，再选择商品分类的关键属性，以及商品的名称、商品的价格等，根据不同的性能及参数定位搜索出更精确的商品信息。如图例。


4.1.7	商品比较
商品比较的功能可以让用户非常方便快捷的将几样商品进行对比，通过对比的结果进行挑选，对不满意的商品可以淘汰，同时对其他比较满意的商品，可以再次加到商品比较队列中进行对比。
对比的信息包括：
	商品名称
	商品图片
	商品价格
	商品属性（例如：电器有屏幕、尺寸、重量、体积等；超市食品有厂家、产地、保质期、配料等）


4.1.8	促销信息与新闻动态
网站用户网站首页的页面上，可以浏览到所发布的促销信息，了解近期的新闻动态。如下图：

4.1.9	购物帮助
4.1.9.1	支付说明
	货到付款
网上用户在下订单的过程中，可以选择货到付款的支付方式，用户在网上下单成功后，在网下收到货品时，才进行订单金额的支付。
	在线支付
网上用户在下订单的过程中，可以选择在线支付的支付方式，用户在下单成功后，将进入网上在线支付的流程，网站提供多个银行的支付接口，用户使用自己的银行卡进行支付，系统提示用户的支付是否成功。
在线支付的两种可能性：
	支付成功，商品购买订单成功。
	支付失败，返回重新进行支付。

4.1.9.2	用户购物配送
	送货上门
网上用户在下订单的过程中，可以选择送货上门的服务，用户在网上下单成功后，订单管理员对订单进行处理，然后分配配送部门上门送货。
	邮购
网上用户在下订单的过程中，可以选择邮递方式收货。用户在网上下单成功后，订单管理员对订单进行处理，然后按客户选择的邮递方式进行发货操作。
4.2	关键业务流程
4.2.1	用户注册方式
网上商城网站的会员主要由以下二种方式产生；
	网上注册
	电话注册
4.2.2	用户注册流程
商城系统二种会员的注册方式如下：
1.	网络用户的注册
	1）	网络用户通过访问网站系统，进行注册
	2）	网站系统提供会员基本注册信息的表单界面
	3）	申请表单提交系统，系统将注册表单数据写入数据库
	4）	系统将会员帐户数据库表对应的会员帐号记录标示已经激活
流程图如下：

注册效果图如下：

2.	电话用户的注册
	1）	用户通过电话的方式，通过管理员进行注册
	2）	管理员记录用户的注册资料信息，并通过网站后台系统提供的用户注册基本信息表单界面将相关数据输入
	3）	电话用户在申请的时候，系统会自动分配用户对应的帐号以及密码，并要求用户必须提供邮箱
	4）	管理员将数据提交系统，系统自动将会员帐号显示给管理员，由管理员告知用户，然后自动将密码发给用户提供的邮箱，并提供激活的链接
	5）	如果用户通过电话立即有销售订单，会员帐户立即自动激活，并让用户自动享受相应的价格优惠，此时点击提供的激活链接系统提示已经激活
流程图如下：

	.2.3	用户购物流程
    请看用户是如何进行购物的：
购物流程如下：

购物详细页面示如下：
	商品订购页


	订购商品，将该商品置于购物车中，可以修改订购数据量，选择礼品等操作

	购物完毕，进入收银台，可以选择两种不同的购买方式：购物直通车或以会员身份进入


	直通车购买方式，填写购买者配送地址信息


	选择配送方式和支付方式


	填写发票及其他信息


	确认订单

	最后购物成功，等待处理。可到会员专区中查看刚下的订单。


注：以上用户购物流程均为示范。
	购物直通车功能
在网站上购物的用户可以是会员，也可以是非会员，网站上没有限制，只要注册成为网上的用户，登陆后就可进行购买。非会员在网站上购买与会员的不同之处在于：非会员不可享受会员价，不能用会员价进行购买；非会员在购买成功后，可以免费的申请会员卡。所以非会员在网站上购买成功后，系统会提示用户是否办理会员卡，用户愿意的话点击进入办理会员卡的流程。用户购买的商品与申请的会员卡由送货人员一起送到。
	会员购物说明
会员在网站上可以按会员价购买有会员价的商品，会员购买商品的积分将记录在用来购买的那张会员卡号上。
4.3	会员专区
会员专区页面也是网站前台主要页面，请参考前面统功能解决方案中的“会员专区”描述。
5	商城系统优化
5.1	搜索引擎优化方案
5.1.1	总体需求
搜索引擎优化，是网站进行网络推广最重要的措施。据信景技术在其客户群中的统计，搜索引擎是网上商城网站访问量的主要来源。
网站新上线在百度和google中被搜索到的机会很小，在缺乏注册用户量的情况下，网站很难带来有效的访问。所以进行搜索引擎优化显得尤为重要。例如我们的一个客户项目在线商品有数万种之多，分布在上千个品牌和数百个品类里面，其中不乏热点产品。品牌、品类和热点产品，都是网民在购物时通过搜索引擎查找的主要关键字。
5.1.2	优化方案
5.1.2.1	网站结构规划表
针对搜索引擎的网站结构规划与网站设计时的结构规划是不同的。针对引擎的结构规划，就是要制定一张这样的表格：
目录	页面URL	页面标题	目标关键字
			
​			
​			

这张表格的目的，是要实现引擎优化目标的清晰化、精细化。只有这样才能够对引擎优化的效果量化监控。表格中各列的意义是：
目录：被优化的网页在网站中的目录位置。
页面URL：被优化的网页的URL。
页面标题：被优化网页的标题。
目标关键字：希望在引擎中录入什么关键字时，该网页排到前面。
关键字、页面URL、页标题的在搜索引擎中的体现与下图：
 制定了网站结构表之后，我们的优化目标就很清晰了——尽量把这些网页在引擎中搜索目标关键字时的排名优化到靠前的位置，越前越好，最好就是第一位。

5.1.2.2	标题与关键字规则
我们网站中，网页的是通过数据库动态生成的，所以，网站结构规划表中所列出的页面数量是非常多的，而且随着我们数据库录入的商品和信息的数量增加也在不断地增加。因此，网站结构规划表，实际上需要借助程序来生成。而页面标题和目标关键字，是需要通过思考去设定的。但是由于页面太多，所以需要系统同一个规则设置功能，让我们能使用规则来自动完成每个网页的关键字和标题设置。
我们网站的输出的动态页面，是给予程序文件而生成的，例如：
product.jsp?productID=1029
这个例子显示了商品详细页的输出规则，随着ProductID的不同，页面所展现的产品页不同。在网站结构规划表里面，对应的页标题和关键字也就不同。例如，我们假设productID=1029的这个产品是一个浴霸，品牌是宝兰，型号是2002EFA。那么，我们希望达到的优化效果是：
目录	页面URL	页面标题	目标关键字
/	product.jsp?productID=1029	宝兰浴霸2002EFA-大连商场	2002EFA
那么，页面标题和页面关键字应该可以通过规则来设定：
	页标题是：[品牌][品类][型号]-[分站名称]
目标关键字是：[型号]
系统提供了以上的配置规则，所有商品详细页的标题和目标关键字就可以按规则自动输出了。那么网站就可以根据优化的需求，随时通过变换规则来达到优化目标。
5.1.2.3	关键字列表
前面是通过页面结构的角度，对网站进行优化。而实际上，引擎优化往往会出现一些“无心插柳”的效果。例如，刚才宝兰浴霸那个商品详细页，我们的目标关键字设置是商品的型号2002EFA，但是当我们在百度搜索“宝兰浴霸”这个关键字时，发现这个网页排到了第二位。虽然目标关键字与我们原来设计的不一样，但是页面排到了第二位显然是更重要的成果。所以，在这种情况下，我们的做法不是继续通过修改这个页面的标题和内容来使目标关键字的搜索结果中该页面排到前面，而是把已经获得的成果锁定下来，并记录下实际搜到这个页面所用的关键字。
那么我们的网站结构规划表，就会变成这个样子：
目录	页面URL	页面标题	目标关键字	实际关键字	百度排名	Google排名	锁定
							
那么，问题是我们如何能够发现所有“无心插柳”的成果呢？答案是，我们必须有一张关键字的列表。我们的系统应该能逐一检查关键字列表中的关键字在引擎中的搜索结果中是否有我们网站的页面，它的排位是多少。
	关键字列表，是把网站结构规划表中的全部关键字抽取出来形成的。
	所以，在关键字列表中还应该有两个功能按钮：
	
	按钮一：检查关键字排名
	检查关键字的排名，启动了一次关键字排名的搜索。系统把关键字在两个主要搜索引擎中的位置找出来。结果关键字表就会变成这个样子：
关键字	百度URL	百度排名	GoogleURL	Google排名
宝兰浴霸	product.jsp?productID=1029	2	没找到	没找到
格力空调	product.jsp?productID=1039	8	product.jsp?productID=1039	25
这个检查结果，应该能够按照百度排名和GOOGLE排名来重新排序。

	按钮二：锁定前XX名的页面
锁定XX名的页面，就会把在前面检查关键字排名时找到的关键字靠前XX名的页面在网站结构规划表中锁定。
5.1.2.4	页面设计要求
网页的结构必须要很清晰，不能存在搜索引擎搜索不到的死角，这样才有利行搜索引擎收录整个网站。网站的被搜索引擎收录只是第一步，怎样才能够在搜索引擎搜索出来的结果中排在最前面，这个才是关键。那这就涉到关键字的定义与，搜索关键字优化的问题。首先需要根据网站的结构定义网站关键字。例如，可以列出这样一个表：
目录	页面URL	页面标题	目标关键字
			
​			
对于关键字的设置网站的后台管理需要提供支持。
1.	除了首先网站的标题设置以外（信息的标题）；
	.	还需要提供关键字的设置；
	.	相关标签的设置等等。
关键字的定义最为关键，责任在于网站的编辑，关键词定义下来了（主题确定下来了），具体的技术实现细节都比较容易。在技术实现细节中需要注意的包括有：
	)	URL中包含要优化的关键词。（用得比较少）
	)	网页Title中绝对匹配和相对匹配要优化的关键词。
	)	meta标签中绝对匹配和相对匹配要优化的关键词。
	)	网页核心内容绝对匹配和相对匹配要优化的关键词。
	)	网页内容标题使用〈h1〉标签优化。


5.1.2.5	网站内容要求
网站信息管理员需要对关键字设置有较好的认识，在编辑网站内容的时候需要注意一些环节：
1)	文章标题，通过关键字的分析，设置标题。
2)	文章内容，文章的第一段话尽可能地突出关键字（标题），一篇文章关键字的密度保持在7%之间比较合适。并且网站的内容不能够太长，当网页内容很长时，可以通过分页来实现。文章详细内容的一些小标题在编辑时可以使用<h2><h3><h4>标签。（h1为文章的标题）
3)	网页主体内容第一段以关键词开头。（这是较好突出关键字的一种方式。）
4)	网页主体内容使用段落格式,每个段落针对不同的组合关键词展开优化,可以的话每个段落都以关键词开头。
5)	对网页中的关键词做适当的特殊处理(加粗、加红、斜体等)，可以设置 粗体、斜体、加红 来突出关键字。
6)	网页中重点图片(内容区、相关内容区、重点图片等)给予合理的包含关键词的ALT文字。
7)	相关内容的展示，即为信息加入站内的链接。一种是，在网页核心内容下设置相关内容展示区，选择包含关键词的文章标题并给予链接到站内相关的地载。（如下图） 另一种是，在文章的详细内容中某个关键词加入到链接到指定的地方。
5.1.3	页面静态化
搜索引擎对静态页面情有独钟。如果页面URL出现太多的参数，搜索引擎蜘蛛可能直接把页面丢弃不收录。那么页面将永远不会在百度和GOOGLE等引擎中找到。因此，需要把所有的页面URL都转换成“.htm”的静态形式。目前中国大多数的知名网站都采用了这种技术，例如新浪、淘宝等等。
对页面URL的改写，不仅仅是首页的问题，而是要把网页内出现的所有链接都要全部改写成”.htm”的形式。只有这样，浏览过程中才永远不会出现带问号的“.jsp”页面。这需要有一个转换过滤器在中间发生作用。URL转换过滤器程序与缓存模块联合工作的原理图如下：

	通过缓存模块与URL重写过滤器的配合，最终使浏览器端看到的网站输出，全部页面都象是静态页面输出一样。这个结果符合引擎蜘蛛的胃口。
网上商城系统提供了网页静态化技术。
网页静态化是有很大好处的。除了加快下载速度，更利于搜索引擎的抓取。通过网页静态化更加有利于搜索引擎的收录。网站静态化是网站优化的重要手段之一。主要效果是静态页面可以引起搜索引擎的重视，而搜索引擎对动态页面的重视远远比不了静态页面。从网站优化来分析，搜索引擎更喜欢静态的网页，静态网页与动态网页相比，搜索引擎更喜欢静的，更便于抓取，搜索引擎SEO排名更容易提高。
	商城系统过滤器自动发布
通过tomcat中的过滤器，我们也可以实现静态页面发布的功能，相当于自己实现一个apache的mod_disk_cache模块，这样就可以不用在tomcat前端再部署一个apache。
过滤器的处理流程如下：
1.	用户访问页面，tomcat接到请求，将请求转给过滤器处理。
	.	过滤器判断这个动态页面是否已经发布及是否过期，如果页面已经发布出来，而且没有过期，将请求forward到磁盘上的静态页面文件。
	.	判断到动态页面没有发布或已经过期，就生成相应的静态页面文件，将请求forward到磁盘上的静态页面文件。
		开源的纯java实现urlrewrite
采用tuckey的urlrewrite filter，这是一个开源的java项目，通过使用过滤器，基本上实现了apache的urlrewrite模块所有功能，由于实现在应用层，所以也可以支持第二部分的url重写，就是将原来动态链接改成静态链接。配置方便，而且程序改动不大，安全稳定。
	.1.4	引擎蜘蛛盲点扫除
搜索引擎的蜘蛛对很多页面内容都看不到。这些内容将不会被蜘蛛收录。由于开发过程是团队开发，那么很难保证每个开发人员都不会使用一些导致蜘蛛盲点的技术。因此，需要全面检查代码中出现的蜘蛛盲点，并采用虚拟蜘蛛程序对网站所有内容进行扫描测试。对出现的盲点进行修正。
着重要解决的蜘蛛盲点如下：
	.	所有页面中，由脚本生成的URL链接，都不会被蜘蛛看到。因为蜘蛛不会去执行这些脚本去生成URL。典型的例子是采用脚本“计算”出来的导航菜单。这个菜单在旧系统中被应用到了国美网站的品类导航条。
	.	选择地区功能。这个功能会“一手遮天”地屏蔽掉引擎蜘蛛对网站页面的抓取。因为引擎蜘蛛的服务器IP地址未必会落在目前42个分站所在的城市里面。按照浏览规则，不能提供销售服务的地区，我们会要求客户选择一个他希望去浏览且能提供服务的分站。而选择分站的动作，蜘蛛不会去做。因此，如果碰到引擎蜘蛛过来，我们最好的办法就是把所有的分站首页都列在那里，然后让蜘蛛去抓取每个分站的信息。而分站的判断不会依赖于COOKIE（COOKIE也是蜘蛛看不到的东西），而是把分站作为URL的一个显要的目录。


5.1.5	评估工具
雅虎站长工具：http://tool.alimama.com/
站长网工具：http://tool.chinaz.com/Default.aspx 
5.1.5.1	关键字密度
关键字密度一般保持在7％之间。关键字密度的工具：
URL：http://tool.alimama.com/keyword.php 

5.1.5.2	页面相似性
搜索引擎会过滤同一个网站中相同或者相似的网页，来保证搜索结果的准备性。那么在网站建设中同样需要考虑这一点。例如网站中的网页都包括了相同的页头与页脚，当网页内容很小的情况下，可能就是造成网站的相似程序太高，而不能被搜索引擎所收录。页面相似度是指网页的内容的相似程度，当两个页面的相似度在80%以上时，很有可能被搜索引擎尤其是Google判断为抄袭页面或复制页面，从而不被收录，甚至降权、删除。那么我们需要检查网站的相似度，可以过网络上的查询工具来进行检查。
网页相似度检查工具：
URL：http://www.webconfs.com/similar-page-checker.php 

5.1.5.3	SEO信息查询
	关键字排名
检查网站关键字在各个不同搜索引擎中的排名。根据返回的结果查看优化的结果。站长网有一个专门的关键字查询工具。
URL：http://tool.chinaz.com/KeyWords/Default.aspx

	网站收录查询
URL：http://tool.alimama.com/seo.php

	PR查询
http://tool.chinaz.com/Ranks/Default.aspx

5.1.6	页面收录情况
页面首先要被引擎收录，才有可能在搜索结果列表里面出现。要细致了解页面收录的情况，实际上包括两个方面：
1）	页面被收录的状况
2）	引擎蜘蛛来访情况
5.1.6.1	蜘蛛访问日志
记录蜘蛛来访的日期，其IP地址，访问过的目录，抓取页面数量统计。
显示每次被蜘蛛抓取的页面的列表。
5.1.6.2	网页被抓记录
网页被抓记录，可以在网站结构规划表中增加一个蜘蛛抓取标志：最新被抓日期
目录	页面URL	页面标题	目标关键字	实际关键字	百度排名	Google排名	锁定	最新被抓日期
								
这个记录由每次蜘蛛抓完，留下访问日志时，填入网站结构规划表。
5.1.6.3	页面死角报警
有了上面的页面被抓记录，我们就可以查询哪些页面长期没有被蜘蛛抓过。只要把抓取时间作为查询条件，就可以把在这个时间之后一直没有被抓过的页面找出来。如果时间条件是设成很久之前，那么没有被抓过的页面就会原形毕露。我们就可以寻找这些页面没有被抓取的原因。
5.1.6.4	网页收录状况
页面收录状况，只需要在昂站结构规划表里面增加一个收录标志就可以了：
目录	页面URL	页面标题	目标关键字	实际关键字	百度排名	Google排名	锁定	最新被抓日期	已收录
									
要检查页面是否已经被收录，只需要在引擎搜索框里面敲入Site命令就可以了。当然这个命令，现在是通过程序来执行的。
5.1.6.5	未收录原因检测
对于已经列入网站结构规划表，但未必引擎收录的页面，最好系统能够告知为什么没有被收录。目前可能的不收录原因主要包括以下2点：
1）	未被蜘蛛抓取
2）	已被抓取，但页面与其他页面重复
对于蜘蛛未抓取，通过抓取记录就可以查到。而对于页面重复性，系统应该提供有效的检测机制。最常见的重复性发生在两个页面相似性太高的状况。而相似性高的页面，往往是同一个文件名，但后续参数不同的页面。系统应该能够把存在这些相似性的页面找出来，并报警。但是要求系统把每个页面都与其他页面进行相似性比较，是计算量极大的，而且没有必要。简单的做法是收取10个文件名一样但参数不同的页面进行对比，我们就可以知道同一组页面是否存在相似性问题。


5.2	性能解决方案
根据未来系统的发展目标，网上商城平台建设在性能需求方面主要包括以下内容：
1.	系统功能可扩展性
	.	系统容量可扩展性
	.	系统性能快速响应性
	.2.1	系统功能可扩展性
系统功能的可扩展性主要建立在一个系统的核心抽象层架构设计上，严格遵循软件设计模式中的开闭原则、接口隔离原则、设计模式等，针对功能的增加与扩展可以快速的进行。
本系统功能的可扩展性主要表现在系统的可成长和权限的继承方面。
	.2.2	可伸展的树状栏目管理
系统资源树是指对网站系统功能模块用树形结构表示的方式。下面首先介绍系统资源树的构架。 如下图：

系统资源树将网站后台管理功能系统地组合起来，资源树上的每一个分支是一个栏目，每一个栏目也就是一个管理模块。系统资源不是固定不变的，随着业务的要求，它还可以不断的动态“长大”，而不会给核心架构带来影响而不可修改。管理员可以根据不同的需求，对分支点进行再分支，可以分为更多不同的小模块，方便管理。
5.2.3	可继承的分组权限管理
权限管理是为了方便管理员管理的一个模块。它可以对网站系统的用户和用户组进行不同的权限设置，使用户和用户组在网站的管理系统中有不同的权限，管理不同的模块。权根的管理使网站的系统管理变得更加简单系统化，提高工作的效率。权限管理，它可以对指定的栏目设置不同的权限，在栏目之间有继承的功能。
下面我们将从管理用户和用户组、权限的设定、权限的继承和权限管理几方面来分析。
	首先，管理用户和用户组。
用户是指在系统中注册单个用户。用户组是指具有共同操作权限的一群用户的集合，在系统中，用户组可以被定义为对某个特定功能的操作角色。例如，负责所有与订单处理有关工作的操作角色可以设定为订单管理专员组。一个用户加入一个组之后，就自动拥有了这个组的所有权限。一个用户除了拥有组的权限之外，还可以被赋予自己独有的权限。
	其次，权限的设置。
权限的设置是指对系统资源树各个支点所具有的管理权限设置。也就是设定特定用户进入该栏目后，对栏目提供的功能的操作权限。典型的权限操作界面如下：


	权限的继承
用户在某栏目下所拥有的权限除了通过自行在本栏目的设置外，还会通过一套继承规则从父栏目和该用户所属的所有组中获得。如上图中，有一个“该栏目用户继承父栏目的权限”的选择框，如果选择是，则表示当前栏目的所有用户都继承自己在当前栏目的父栏目中所拥有的权限。
如果要看某用户是否拥有某一权限，首先看其权限设置栏目里是否有、其组的权限设置是否有，如果都没有，则这套规则就会找该栏目的父栏目，看看该用户和其所属组在父栏目下该权限有无设置，如果有则用户在本地栏目得到该权限设置，如没有则在按同样规则找他父栏目的父栏目，如没有，再往上找，直到最顶，还没有，那该用户在本地栏目下该权限就为没设置。以上这一环节得到的权限我们称为继承权限，在设置权限页面上显示为不可修改，即选择按钮为灰色DISABLE状态。

	最后，权限管理
用户组与每个栏目都可以独立指定权限的功能使的权限配置具有极高的灵活性。
根据各个岗位所负责的工作范围的不同，我们可以分别制定不同的权限，从而通过把一些权限分配给一个组，那么就可以在系统中建立各种操作的角色。例如订单管理专员，其主要的工作职能是：客户订单的全程处理、主动销售的实施和其他销售形式的管理，订单管理专员拥有查看所有订单、更改订单状态、删除或修改订单信息、发布主动销售信息的权利。
5.2.4	系统集群
本系统未来发展中，必然存在这浏览量不断上升的情况。为了能够满足未来大用户量访问的需求，我们今天的系统选型必须考虑未来系统如何扩容的问题。所以，系统演进展望中，首先提到的就是系统集群的问题。所谓系统集群，就是通过增加服务器数量的方式，来提高系统的用户容量。
当服务端特别是WEB服务端工作量迅速增大；为了顺应这种应用需求，对WEB服务器的性能要求越来越高，而单机服务器的性能增长总是有限度的。网络带宽的增长速度大于CPU的增长速度，而内存处理以及I/O处理的增长速度还远跟不上CPU的增长速度，越来越多的瓶颈会出现在服务器端，集群技术恰恰能够极大地缓解这些问题。
在我们网站网上商城平台系统发展中，为了提高整个系统的可用性，除了提高计算机各个部件的可靠性以外，已经启动采用集群技术来解决支持更大的访问量，并且可以随着访问量的增加可以通过增加服务器的方式很容易的增加处理能力，而不增加用户的访问时延；通过集群技术提高系统稳定性，提供几乎永不停机的服务质量。即使某一台服务器软件或者硬件崩溃系统仍然能对客户提供服务。
所谓集群，就是共同为客户机提供网络资源的一组计算机系统。而其中的每一台提供服务的计算机，我们称之为节点。当一个节点不可用或者不能处理客户的请求时，该请求将会转到另外的可用节点来处理，而这些对于客户端来说，它根本不必关心这些要使用的资源的具体位置，集群系统会自动完成。
集群中节点可以以不同的方式来运行，它们是如何设置是关键所在。在一个理想的两个节点的集群中，两个服务器都同时处于活动状态，也就是在两个节点上同时运行应用程序，当一个节点出现故障时，运行在出故障的节点上的应用程序就会转移到另外的没有出现故障的服务器上，这样一来，由于两个节点的工作现在由一个服务器来承担，自然会影响服务器的性能。
我们网站网上商城平台系统主要从以下两方面进行未来的研究发展：
5.2.4.1	WEB服务器集群技术
现在主流的WEB服务器主要包括BEA WEBLOGIC、IBM WEBSPHERE、JBOSS、RESIN、TOMCAT等。其中，JBOSS、RESIN、TOMCAT应用广泛，并且是免费Web应用服务器。网站系统基于不同的WEB服务器分别采用以下几种集群技术：
1.	主/主 (Active/active) 
这是最常用的集群模型，它提供了高可用性，并且在只有一个节点在线时提供可以接受的性能，该模型允许最大程度的利用硬件资源。每个节点都通过网络对客户机提供资源，每个节点的容量被定义好，使得性能达到最优，并且每个节点都可以在故障转移时临时接管另一个节点的工作。所有的服务在故障转移后仍保持可用，但是性能通常都会下降。
	.	主/从(Active/passive) 
为了提供最大的可用性，以及对性能最小的影响，Active/passive模型需要一个在正常工作时处于备用状态，主节点处理客户机的请求，而备用节点处于空闲状态，当主节点出现故障时，备用节点会接管主节点的工作，继续为客户机提供服务，并且不会有任何性能上影响。
	.	混合型(Hybrid) 
混合是上面两种模型的结合，只针对关键应用进行故障转移，这样可以对这些应用实现可用性的同时让非关键的应用在正常运作时也可以在服务器上运行。当出现故障时，出现故障的服务器上的不太关键的应用就不可用了，但是那些关键应用会转移到另一个可用的节点上，从而达到性能和容错两方面的平衡。
	.2.4.2	数据库集群技术应用
数据库集群（SQL通常使用术语称为目录集群），一个数据库集群是一系列数据库的集合，这些数据库可以通过单个数据库服务器的实例访问。
用文件系统的术语来说，一个数据库集群将是一个目录，所有数据都将存放在这个目录中。我们把它称做数据目录或数据区。
我们主要是使用数据库本身的集群技术结合我们的网站系统软件架构进行配置与应用。例如数据库使用Oracle，数据库集群可以采用Oracle RAC。基于RAC的网上商城应用的用户或者中间层应用服务器客户，可以通过虚拟数据库服务名连接到数据库上。Oracle在集群中多个节点之间自动平衡用户负载。不同节点上的Real Application Clusters数据库实例预订所有数据库服务或者部分子集数据库服务。这使得DBA高度灵活地选定，连接到特定数据库服务的特定应用程序客户是否可以连接到某些或者全部的数据库节点。RAC在工作期间，每个节点可以单独的被使用并且被应用程序负载均衡。如果发生意外，如一个节点的失败，可以实现节点的失败切换，保证数据库24*7的高可用性。
	.2.5	系统性能快速响应性
在系统软件架构分析与设计上采用先进的Cache缓存机制算法，保证了高用户量并发访问给系统服务器带来的业务逻辑计算、核心组件计算等对各项共享资源的高性能开销要求降到最低；
	系统效率，主要涉及到高速缓存的问题。
网络用户访问前端页面的时候，首先会将请求提交到服务器，服务器接收请求，并处理请求，这期间包括各种业务逻辑组件执行计算、连接数据库或其他存储系统中实时的检索并获取数据信息、绘制页面相关组件等一系列的操作处理，处理完毕将响应结果发送网络用户的客户端并呈现页面结果。
在这个往返的过程中，快速响应是成就销售交易的重要保证。而我们知道，页面的绘制、业务逻辑计算、访问数据库或者其他存储系统建立数据库连接、读写相关硬盘配置文件信息、套接字等都需要通过的有限的系统资源进行，而Web 服务器以及数据库服务器通常需要处理大量的同时并发请求，从而因为共享资源的争夺造成线程等待而延迟页面请求，直到资源变为可用。
网站系统平台借鉴了业界众多的解决方案，开创提供了一种非常尖端先进的缓存数据技术即Cache技术。缓存的技术实现主要分为两种：
		重量级业务组件对象实例缓存技术；
		页面对象实例缓存技术

我们可以通过图例来分析一下缓存技术的应用：

图一（请求中的页面对象实例不在缓存中）

图二（请求中的页面对象存在于缓存对象中）
从上边两幅图可以很清晰的看到，对于并发访问的页面请求，通过页面的缓存可以极大的减少对紧缺资源（数据库连接）的调用，减少访问响应的时间，从而提高系统的访问速度和整体性能。
5.3	系统安全方案
对于网上商城系统而言，大量的商业数据以及数据文件保存于应用服务器和数据服务器之上。如果不能保证这些数据的传输和访问的安全，可能就会造成严整的商业损失。我们必须对不同的数据和文件进行授权访问，对这些数据和文件进行严格的控制。
由于商城系统整体是采用J2EE构建的应用，因此适应Java2的安全体系。所以系统的安全解决方案中将从以下不同的方面进行安全部署，具体是： 
1.	J2EE对JSP、Servlet的安全控制；
	.	数据库对数据的控制；
	.	系统防火墙管理；
	.	恶意并发访问控制（DoS攻击）
	.	防毒与防黑
	.	容灾与备份
在系统实际的运行过程中，首先浏览器客户端通过URL请求进入应用服务器，服务器根据URL的判断该用户是否有权访问HTML、JSP或Servlet，最终通过业务规则判断该用户是否有权限进行相应的业务处理。我们数据安全体系完全遵循SUN公司发布的JAVA2安全开放标准。整个数据安全的实施对于用户而言是完全透明的，用户完全无须了解其内部构造。
	.3.1	J2EE对JSP、Servlet的安全控制
根据J2EE的规范，JSP、Servlet的安全采用 URL认证机制进行安全访问限制，可以根据实际的用户、用户组以及角色进行安全访问控制。这些访问控制信息在描述文件XML中，同时通过后台访问的前置登陆验证的过滤器（Filter），控制后台连接的访问。
网上商城平台系统将对用户URL请求验证的具体到各模块、各数据节点上的各个操作。通过足够的权限细划而达到灵活的、高适应性的用户访问权限控制，从而保证商业数据的安全访问。
	.3.2	数据库对数据的控制
数据库系统的安全性很大程度上依赖于数据库管理系统。本系统建议采用安全机制强大的Oracle数据库系统,并严格按照Oracle建议的系统安全设置进行配置管理。
	.3.3	系统防火墙管理
根据商城系统对防火墙的需要，现对防火墙的管理作如下建议：
	.	最少的特权，减少因为职务或特权影响开放防火墙的限制条件，并将防火墙规则的预设限制动作设为 "deny"，也就是任何未经特别允许的联机一律禁止。 
	.	彻底防御，防火墙过滤规则尽可能使用多个限制规则取代单一限制条件。 
	.	最少信息，勿将跟企业组织或网络上定有关的信息暴露出来。 
	.	KISS (Keep It Short and Simple)，复杂的配置设定容易造成错误并因此导致安全的漏洞，因此，让 firewall 的设定及配置尽可能的简单化。防火墙系统只能控制有经过防火墙的网络联机，因此，防火墙应该必须为连上 Internet 的唯一网关 (gateway)。 
	.3.3.1	防火墙硬件的安全配置建议：
		将防火墙管理主控台分开－目前许多厂牌防火墙系统皆提供从远程透过另一平台管理 firewall 的能力，未来如有 firewall 增加的需要，也可以将 firewall 的管理工作集中控管。 
		防火墙实体放置地区－建议应当将 firewall 放置于安全环境的实体位置，也就是一天24小时有专人操作控管的环境。 

	.3.3.1.1	防火墙配置建议：
		身份确认及认证 (Identification and Authentication) 
		使用支持对于认证信息加密的任证机制来限制使用者使用存取 Internet 的服务。 
		配置 firewall 成可以显示某标题以便提醒使用者在存取服务之前必须先对 firewall 作他们身份的确认。 
		机密性 (Confidentiality) － 强烈建议任何对于 firewall 的远程管理都必须透过加密的管道。 
		完整性 (Integrity) － 为维护系统的完整性，安装 firewall 机器的操作系统必须针对安全设定作进一步的强化安全性处理。 
		可用性 (Availability) 
		在完成 firewall 系统的安装及测试之后，建立一份完整的系统备份并将它存放在安全的地方。 
		安装新版本操作系统或防火墙系统软件，或实行维护时，防火墙系统应该终止所有的网络连结，在经完整测试确定没问题之后再恢复网络连结。 
		获得以及安装防火墙相关的修正程序 (Fix)。 
		稽核 (Audit)： 
		Firewall 系统上具有安全性考虑的机密事件必须要进行追踪 (trace)，设定操作系统上的稽核功能来追踪对于操作系统以及 firewall 软件档案具有写 (write) 或执行 (execute) 的动作。 
		开启 firewall 系统上的纪录功能，对于被拒绝动作的稽核要以较详细的格式纪录，对于允许动作的稽核则可以以较短的格式纪录。如果纪录的数量太大量而影响正常运作时，可以选择几个规则将它们的纪录功能关闭。  
	.3.4	恶意并发访问控制（DoS攻击）
在实际应用中，我们可能会遇到网站被恶意攻击的情况。比如：某人写了一个程序，不断的循环访问平台中某个消耗资源比较大的页面，造成服务器无法实时处理这些请求，从而另其它用户也无法使用系统了，这就是一般所说的拒绝服务攻击（DoS）。
对于这个问题，网上商城系统平台实现了一个过滤器，限制在指定时间内，多次访问某些资源的请求。当某个客户端的请求符合过滤器的过滤条件时，系统会在一段时间内直接显示错误提示，而不作任何操作，保证了其它合法用户能正常的使用系统。
比如：有个ip为59.123.11.1的客户在半分钟内，连续访问了搜索功能15次，被过滤器捕捉到了，系统就会禁止这个ip访问搜索功能10分钟，并会记录到黑名单，当下次这个ip再次恶意访问时，系统会根据这个黑名单延长禁止访问的时间。
除了过滤器的限制，平台对于一些重要功能，如文件上传、用户注册、管理员登录等加上验证码的功能，用户必须输入系统随机生成的验证码才能使用这些功能，
通过这样双管齐下，就可以有效防止恶意的并发访问了。
	.3.5	防毒与防黑
防毒防黑需要在多个不同的层次上进行防卫。首先是应用层，由于网上商城程序直接开放给外部，因此如果应用层序本身有安全漏洞则其它的一切的措施都是枉然的。我们的应用程序已经在多个高访问量的网站，成功运行了多年，从来没有发生过因为应用程序产生的安全事故，这充分说明我们的应用本身是非常稳定和安全的。
对于需要与内部系统交换数据的时候，我们将采用数据交换前置机，采用专用的协议于内部系统交换数据。这样可以完全隔离内部网络，使得内部网络上不会受到外网的攻击。

正确的配置防火墙，使得外部只能通过应用程序这个唯一的访问点访问服务器资源，这样只要能够保证应用程序本身的安全性，则可以杜绝黑客与病毒的入侵。另外，为了进一步防范病毒的入侵，我们建议在网络的入口处安装病毒防火墙。
例如，在很多项目案例中系统建设的第二第三阶段，我们采用了业界安全性与稳定性最高的小型机系统作为对外服务的应用服务器，以及数据库服务器，这样的配置也将大大地减少系统受到病毒与黑客攻击的可能性。同时在系统的运营过程中，应该建立严格的管理制度，对于及时更新安全包，定期分析入侵日志根据情况迅速地做出反应，这样就能有效地建立一个防毒防黑屏障，保证系统的健康稳定运行。
5.3.6	容灾以及备份
随着业务的不断发展，数据量不断增长，对数据的安全性与稳定性的不断增加，我们将采用多个级别的数据备份和容灾方案，确保数据的安全和业务的不间断。
根据容灾系统对灾难的抵抗程度，可分为应用容灾和数据容灾。数据的存放会因为各种特别情况例如黑客入侵破坏、服务器硬件限制或故障、不可抵抗的自然灾害而遭到灾难性的破坏，本系统根据应用服务器和数据库横向扩展的集群技术手段为基础，对系统软件程序内部管理与系统业务重要数据库进行本地以及异地分布式集群技术实现，从而实现本地或异地的容灾和数据备份。例如，可以在整个系统中采用在每个数据中心中的关键性业务均采用群集系统进行双机热备进行系统应用的保护。数据备份与容灾将分三步，逐步完善：
1.	第一阶段实现磁带备份；
	.	第二阶段将在第一阶段的基础上增加本地集群，实现本地备份容灾；
	.	第三步将在第二阶段的基础上实现异地集群从而实现异地的容灾和数据备份。


6	技术架构及运行环境
6.1	系统技术架构
本系统构建于J2EE平台，采用分层提供服务支持的设计思想，将系统划分为数据库层、中间件层、EMALL基础服务层、业务表现层和系统接口层。系统对每一层定义明确的功能接口，同时在层次内实现组件化的接口实现。层次化、模块组件化的实现，使系统具备了最大程度的灵活度，从而能对业务需求的变化作出快速的反应，使系统具有很好的扩展性。
6.1.1	多层技术架构

上图可以清晰的了解到整个系统的层次划分，系统从最底部的数据库层开始，一层一层的向上提供接口服务，最终实现用户按业务要求的可见操作界面和其他系统接口。各层次专著于自身功能的接口实现，整个层次保持相对的稳定。系统通过不改变接口，各个层次、各个组件进行优化的策略，能在不影响整个业务的前提下，不断的完善和改进。 下面将对各个层次进行进一步的论述。

6.1.1.1	数据库层
对于平台中的所有应用，都存在着各种各样的配置信息、业务数据、系统运行状态等信息。数据库层对这些数据信息本身进行归档、提供快速查询的底层接口、并保证数据的完整性、可靠性。
在数据库方面，我们采用Oracle  或者是 MySQL 。这两种数据库分别有不同的适用环境。

	Oracle 
适合大型的网上商城应用。
能使用所有的网客通平台功能。如访问量排行榜、降价排行榜、销售排行榜、访问量统计等等，就以往的经验来看，这些功能每天要处理的数据都会超过一千万。这种数据量如果使用传统的统计方法，统计一次的时间就可能会以天来计算了。如果使用Oracle，再配合我们专门对Oracle进行优化的高效率的统计程序，那么只需十数秒便可完成。
此外，如果只用一台数据库无法应付日益增长的服务器访问量，可以使用Oracle RAC（真正应用集群），通过增加数据库服务器进行集群。

	MySQL 
适合中小型的网上商城应用。
无法使用网客通平台一些高级应用，如排行榜、统计分析、MIS系统对接等。这是由于MySQL设计上强调访问速度，牺牲了一些数据库的高级功能，虽然用程序也可以实现这些功能，但是在性能上无法满足需求。
不支持数据库集群。

6.1.1.2	中间件层
中间件层主要是网客通平台使用的J2EE中间件，包括平台使用到的应用服务器和中间件技术。

6.1.1.2.1	应用服务器
应用服务器为网客通提供的整个J2EE平台实现，EMALL基础服务层和应用层、业务层都是建立在应用服务器之上。
网客通设计上遵循SUN公司提出的J2EE规范，这样能够尽可能的保证在不同的J2EE应用服务器中进行移植。
经过测试、网客通平台支持Tomcat、WebLogic、JBoss这几种J2EE应用服务器。

6.1.1.2.2	中间件技术
本着重用的设计原则，网客通在一些功能中采用了已有的成熟技术，这些都是经过实践考验的中间件。主要以java标准包和开源项目为主，大部分都针对系统作了相应调整，以便适合系统的需要。

1.	Apache commons：著名的开源组织Apache的一个java工具包，提供很多实用的功能。
	)	commons-beanutils：
提供对Java反射和自省API的包装。
在平台中用于通用的接口设计。

	)	commons-codec：
包含一些通用的编码解码算法。Hex，Base64， 以及URL encoder。
平台中主要用来做消息摘要，实现数据加密等功能。

	)	commons-collections：
提供一个类包来扩展和增加标准的Java Collection框架。提供了比j2sdk更全面的数据结构，
平台中继承并实现了一些特殊的数据结构

	)	commons-pool：
提供了通用对象池接口，一个用于创建模块化对象池的工具包，以及通常的对象池。
我们在原有的基础上进行了优化，在性能和使用性方面有所提高。

	)	commons-dbcp：
这是一个基于apache的对象池（apache commons pool）实现的数据库连接池。
我们在原有的基础上进行了优化，对数据库连接进行了特别的处理，防止数据库连接泄漏的问题，并提供了监控的功能。

	)	commons-discovery：
供工具来定位资源（包括类） ，通过使用各种模式来映射服务/引用名称和资源名称。

	)	commons-el：
提供在JSP2.0规范中定义的EL表达式的解释器。
对平台中的JSP提供EL表达式支持。

	)	commons-fileupload：
强大和高性能的文件上传功能。
平台中被用于上传各种图片、Flash、文档等资源，我们在原有的基础上进行了优化。

	)	commons-logging：
提供通用的日志操作接口
主要用于程序调试和服务器日常的日志输出。

	0)	commons-validator：
提供了一个简单的，可扩展的框架来在一个XML文件中定义 校验器（校验方法）和校验规则。支持校验规则的和错误消息的国际化。
平台中用来校验各种xml数据。

	.	Cewolf / JFreeChart：
Cewolf 是一个用于生成各种图表的标签库。它支持在JSP中嵌入图表图片。运行servlet 容器的任意的Web应用程序服务器都可以使用它。因为Cewolf 是一个功能完整的标签库，所以不需要使用Javascript。
JFreeChart是开放源代码站点SourceForge.net上的一个JAVA项目，它主要用来各种各样的图表，这些图表包括：饼图、柱状图(普通柱状图以及堆栈柱状图)、线图、区域图、分布图、混合图、甘特图以及一些仪表盘等等。这些不同式样的图表基本上可以满足目前的要求。主要用于生成统计图表。
	这两个技术一起提供了网客通平台的统计分析图表，JFreeChart主要用于输出图表，Cewolf对其进行了封装。

	.	Dom4j：
Dom4j是一个易用的、开源的库，用于XML，XPath和XSLT。它应用于Java平台，采用了Java集合框架并完全支持DOM，SAX和JAXP。
主要用来处理XML数据。
XML在网客通有广泛的应用，主要是作为配置文件使用。由于XML严格的格式要求和层次结构，也有用来作为参数在HTML表单中传递。如组合商品功能，因为组合商品中的商品是由管理员挑选的，参数数量并不确定，如果每从组合商品中添加/删除一个商品都直接更新到数据库话，会对系统造成负荷。所以，在组合商品的管理中，将操作的数据类转换成XML传递，就可以一次进行修改。

	.	Hibernate：
Hibernate是一个开放源代码的对象关系映射框架，它对JDBC进行了非常轻量级的对象封装，使得Java程序员可以随心所欲的使用对象编程思维来操纵数据库。Hibernate可以应用在任何使用JDBC的场合，既可以在Java的客户端程序实用，也可以在Servlet/JSP的Web应用中使用，最具革命意义的是，Hibernate可以在应用EJB的J2EE架构中取代CMP，完成数据持久化的重任。
在平台中，我们采用Hibernate进行数据库操作，只有在一些对数据库性能有特别要求的模块，才直接使用jdbc进行连接。

	.	Ehcache：
Ehcache出自Hibernate，在Hibernate中使用它作为数据缓存的解决方案。这是Hibernate必须的包。

	.	JCrontab：它是由Java语言编写的日程处理程序，它目的是提供强大的定时处理功能，让我们的应用程序可以按照提供的时间表来执行不同的应用。
我们主要用Jcrontab管理以下一些定时任务：
	)	年排行榜后台更新进程：自动计算年排行榜。
	)	月排行榜后台更新进程：自动计算月排行榜。
	)	周排行榜后台更新进程：自动计算周排行榜。
	)	日排行榜后台更新进程：自动计算日排行榜。
	)	更新对象缓存：实现对象缓存的更新，处理那些长期没被再一次访问的对象缓存。
	)	清页面缓存：当管理员使用的手工刷新页面缓存的功能时，系统会将这些需要刷新的缓存加到一个队列中，由本进程负责刷新。
	)	相关产品自动实现间隔：相关产品的计算对系统消耗比较大，所以系统不会对所有几十万个商品进行计算，只有在用户查看单个商品时算出这个商品的相关产品并进行缓存。那么当用户下一次访问这个商品的相关产品时就直接从缓存中读取出来。而这个进程就是为了定时更新这个缓存。
	)	自动推荐后台更新进程：进程根据商品推荐规则进行自动推荐。 
	)	新闻推荐后台更新进程：进程根据新闻推荐规则进行自动推荐。
	0)	关键字后台进程：当用户在前台搜索栏中输入一个查询值时，系统并不马上将其统计到关键字，而是放到内存中，由此进程定时统计。
	1)	保存访问量信息进程：用户每访问一次系统，系统并不马上统计，而是放到内存中，由此进程定时保存到数据库，供统计进程进行统计。
	2)	年访问量排行计算：计算年访问量排行榜。
	3)	月访问量排行计算：计算月访问量排行榜。
	4)	周访问量排行计算：计算周访问量排行榜。
	5)	日访问量排行计算：计算日访问量排行榜。
	6)	年降价排行计算：计算年降价排行榜。
	7)	月降价排行计算：计算月降价排行榜。
	8)	周降价排行计算：计算周降价排行榜。
	9)	日降价排行计算：计算日降价排行榜。
	0)	统计计算：每天对访问量进行统计。
	1)	生成订阅邮件列表进程：根据用户的订阅设置，生成需要发送的邮件队列。
	2)	发送订阅邮件进程：根据要发送的邮件队列发送邮件。
	3)	拍卖自动出价进程：实现拍卖模块中的自动出价功能。

	.	JCS：
JCS是Jakarta的项目Turbine的子项目。它是一个复合式的缓冲工具。可以将对象缓冲到内存、硬盘。具有缓冲对象时间过期设定。还可以通过JCS构建具有缓冲的分布式构架，以实现高性能的应用。
对于一些需要频繁访问而每访问一次都非常消耗资源的对象，可以临时存放在缓冲区中，这样可以提高服务的性能。而JCS正是一个很好的缓冲工具。缓冲工具对于读操作远远多于写操作的应用性能提高非常显著。
网客通平台中使用jCS提供缓存功能，主要是页面缓存和对象缓存，通过JCS，系统将用户访问过的页面和对象缓存到内存中，对于访问量巨大，内存缓存已经不能负荷的情况下，我们还可以将缓存设置到硬盘中保存。
使用缓存的话，能将系统可负载和性能大幅度的提升。当没有使用集群环境的情况下，缓存是一种必不可少的技术。

	.	JSF / MyFaces:
JavaServer Faces (JSF) 是一种用于构建 Web 应用程序的新标准 Java 框架。它提供了一种以组件为中心来开发 Java Web 用户界面的方法，从而简化了开发。
JSF 的主要优势之一就是它既是 Java Web 用户界面标准又是严格遵循模型－视图－控制器 (MVC) 设计模式的框架。用户界面代码（视图）与应用程序数据和逻辑（模型）的清晰分离使 JSF 应用程序更易于管理。为了准备提供页面对应用程序数据访问的 JSF 上下文和防止对页面未授权或不正确的访问，所有与应用程序的用户交互均由一个前端“Faces”servlet（控制器）来处理。
MyFaces是JavaServer Faces（JSF） Web框架 （JSR 127）的一个实现。提供了很多常用控件。
我们平台中采用一些基于JSF框架的MyFaces控件。这样使程序结构十分清晰。

	.	Log4j：
Log4j是Apache的一个开放源代码项目，通过使用Log4j，我们可以控制日志信息输送的目的地是控制台、文件、GUI组件、甚至是套接口服务器、NT的事件记录器、UNIX Syslog守护进程等；我们也可以控制每一条日志的输出格式；通过定义每一条日志信息的级别，我们能够更加细致地控制日志的生成过程。最令人感兴趣的就是，这些可以通过一个配置文件来灵活地进行配置，而不需要修改应用的代码。
这是一个可选包，如果不使用Log4j的话，commons-logging会自动使用SUN J2SDK的日志包，不过我们还是推荐使用Log4j，它的功能非常强大。

	0.	Lucene：
Lucene是一个开放源程序的搜寻器引擎，利用它可以轻易地为Java软件加入全文搜寻功能。Lucene的最主要工作是替文件的每一个字作索引，索引让搜寻的效率比传统的逐字比较大大提高，Lucen提供一组解读，过滤，分析文件，编排和使用索引的API，它的强大之处除了高效和简单外，是最重要的是使使用者可以随时应自已需要自订其功能。
我们使用Lucene建立索引，并在这基础上实现了全文搜索功能。

		.	Ant：
Ant是一个基于Java的自动化脚本引擎，脚本格式为XML。
我们除了用Ant做Java编译相关任务外，还通过插件实现很多应用的调用。包括程序编译、打包、Hibernate配置文件自动生成、部署、以及单元测试等操作。
当一个代码项目大了以后，每次重新编译，打包，测试等都会变得非常复杂而且重复，因此c语言中有make脚本来帮助这些工作的批量完成。在Java中应用是平台无关性的，当然不会用平台相关的make脚本来完成这些批处理任务了，Ant本身就是这样一个流程脚本引擎，用于自动化调用程序完成项目的编译，打包，测试等。除了基于JAVA是平台无关的外，脚本的格式是基于XML的，比make脚本来说还要好维护一些。

		.	Axis：
Axis是一个SOAP引擎，提供创建服务器端、客户端和网关SOAP操作的基本框架。SOAP是被广泛作为新一代跨平台、跨语言分布计算Web Services的重要部分。
网客通平台使用Axis提供WebService支持，广泛应用于通用数据接口，对外系统提供服务等功能。
如：
			商品查询服务：提供接口让外接系统可以查到平台中的商品信息。
			新闻发布服务：提供接口让外接系统可以取到各类新闻。
			订单服务：提供接口让外接系统可以在平台中生成订单，并获取各种订单信息。
注：上述服务都有严格的权限控制。

		.	JavaMail：
JavaMail是Sun发布的用来处理email的API。它可以方便地执行一些常用的邮件传输。
我们使用JavaMail实现了平台中邮件发送、群发等相关功能，供业务系统使用。

		.	XDoclet：
XDoclet是一个开源项目，可以通过在java源代码中的一些特殊的注释信息，自动生成配置文件、源代码等等。例如web、ejb的部署描述文件等。
我们用XDoclet来生成Hibernate的hbm配置文件。

		.	JSTL：
JSP 标准标记库（JSP Standard Tag Library，JSTL）是一个实现 Web 应用程序中常见的通用功能的定制标记库集，这些功能包括迭代和条件判断、数据管理格式化、XML 操作以及数据库访问。
我们使用JSTL封装各种业务逻辑。

		.	Jakarta ORO：
Jakarta ORO Java 类是一套文本处理Java类，提供了与Perl5 兼容的规则表达式，类AWK规则表达式，glob 表达式，以及用于执行替换、分割、过滤文件名等的工具。这个包是OROMatcher, AwkTools, PerlTools, and TextTools libraries originally from ORO, Inc的后续产品。
网客通平台使用ORO处理正则表达式，广泛应用于各种文本处理中。

		.	SwarmCache / JGroups：
SwarmCache是一个简单且有效的分布式缓存，它使用IP multicast与同一个局域网的其他主机进行通讯，是特别为集群和数据驱动web应用程序而设计的。SwarmCache能够让典型的读操作大大超过写操作的这类应用提供更好的性能支持。SwarmCache使用JavaGroups来管理从属关系和分布式缓存的通讯。
JGroups是一个开源的纯java编写的可靠的群组通讯工具。其工作模式基于IP多播，但可以在可靠性和群组成员管理上进行扩展。其结构上设计灵活，提供了一种灵活兼容多种协议的协议栈，对于每个产品都有不同的可靠性需求。这种协议栈可以让用户定义的自己可靠性指标和性能指标。
当使用集群环境时，系统存在着缓存同步的问题，需要对集群中每一台服务器的缓存进行同步，这样就必须要有一个缓存同步的机制，SwarmCache和JGroups就是为了解决这个问题而被加到网客通中。

		.	JUnit：
JUnit是由 Erich Gamma 和 Kent Beck 编写的一个回归测试框架（regression testing framework）。Junit测试是程序员测试，即所谓白盒测试，因为程序员知道被测试的软件如何（How）完成功能和完成什么样（What）的功能。
我们主要用JUnit来进行单元测试。

		1.1.3	EMALL基础服务层
基础服务层构建于J2EE平台之上，借助于中间件的接口服务，提供网上商城平台系统所需要的通用服务接口组件。系统将提供以下主要的服务接口支撑不同业务需求的实现。

		栏目管理模块：
栏目是一个抽象资源对象，是一种特殊的内容类型。栏目可以表示产品、新闻信息类别、资源节点、导航栏的项、菜单中的项等等。栏目是一种组织管理型的资源。
系统设计上支持多级子栏目，采用虚拟文件系统（Virtual File System）技术以支持直观的树型导航风格，一个栏目节点相当于一个虚拟的文件目录。
    对于大型网上商城系统，栏目的节点是个非常大的数字，这对系统栏目树展示的速度和
性能有极高要求。考虑到以上原因系统采取了栏目对象缓存策略，同时对于页面节点的呈现通过动态JavaScript输出的技术，从而使系统能很好的支持上万个栏目数据节点操作管理。能平滑、高效的展示树型风格的栏目结构。

		用户权限管理模块：
大型网上商城应用系统有用户多，模块多，权限多的特点，因此必须采用分组的用户管理系统，并设置一个具有最高权限的管理员，负责对整个系统用户设置，为每个用户角色、用户指定不同的权限，依照不同的权限在系统中可以使用不同的功能。
系统设置了Administrator用户组，并设置了root这个具有最高权限、不可删除的用户。您可以根据您的需要使用root这一个管理员用户。管理员可以创建、编辑和删除用户组，您可以根据您的需要给每个用户组合理的权限划分，并给每个用户组添加、编辑和删除用户。用户登录系统后，系统会根据该用户的权限提供相应的功能，并对用户的每个操作检查用户的使用权限。
系统采用Window用户权限的思想，将用户、用户组的权限通过各个栏目节点进行绑定，在各个栏目节点上实现继承与非继承的设置管理，从而使管理员可以进行灵活的配置。 

		属性管理模块：
在现实情况中，不同的事物对象存在其特殊的信息描述；比如一个手机，存在 “网络类型—GSM”、“外观样式—翻盖”等等；同时这些特殊的信息描述在同类别的数据对象下经常存在共性；比如TCL和 联想 生产的手机，应该都存在以上两种属性的描述。
针对以上的情况，系统进行了一个数据抽象，定义了一套属性管理组件，可以方便、有效的描述相关的需求情况，同时对于存在共性描述的对象采用继承模式来描述，从而很好的表现一个事物对象的特征。

		继承性管理模块：
继承是面向对象接口特性之一。考虑到抽象事物的通用性，系统通过一个通用的对象继承模型接口，对所有需要实现继承的功能提供基础的支持。从而提高系统的重用性和降低系统的偶合度。

		日志服务管理模块：
日志是一个成熟的网上商城应用系统所必备的功能。日志可以用于数据统计，为系统其他功能提供初始数据；用于查看一个对象的修改历史记录，用于方便追踪对象的修改状态和明确事务责任。
通过对系统各种操作数据的分析，根据各操作功能，系统将日志进行类别的划分：
1、系统日志：记录系统各种操作的信息数据。（比如：用户某个时间登陆了系统。。。）
2、商品日志：记录系统商品数据发生改变的信息。（比如：商品价格发生变化）
3、信息日志：记录系统信息数据发生改变的信息。（比如：某管理员增加了一个新的促销公告。。。）
4、订单日志：记录系统订单数据发生改变的信息。（比如：某个订单已经进行了送货处理。。。）
系统通过抽象出一个Log日志接口，采用Abstract Factory 模式，通过不同的构造参数来获取不同分类的Log日志实现。系统将各中类别下的日志，又区分不同的操作。日志组件将通过抽象和封装后，给各功能模块提供统一接口服务，方便系统各模块的日志功能的开发和维护。

		缓存服务管理模块：

页面访问的时候，生成动态 Web 页会耗用各种各样的系统资源。当 Web 服务器收到页面请求时，它通常必须从数据库或其他存储系统中实时的检索所请求的信息。对这些资源的访问通常需要通过有限的资源池（如数据库连接、套接字或文件描述符）进行。因为 Web 服务器通常需要处理很多并发请求，所以对这些共享资源的争夺可能会延迟页面请求，直到资源变为可用。在将请求发送后，仍然必须将结果转换为 HTML 代码以便进行显示。
使系统速度更快的一种显而易见的方法是购买更多、配置更好的硬件。此方法可能很吸引人，因为硬件便宜，而且不必更改程序，但更多的硬件只能在未达到其物理限制之前才会对性能有所帮助。系统中实施缓存管理，是一个有效的解决方案。

系统中存在两中缓存对象：
1、	Java对象缓存：对于一些经常被使用的Java对象保存于规定的内存空间，通过配置的更新规则，同步更新数据库内容。
2、	前台页面缓存：对于前台的html页面按不同的块来区分，然后通过一个key对象，通过开源JCS技术存储于内存或磁盘空间。


（请求中的页面对象不在缓存对象中）

（请求中的页面对象存在于缓存对象中）

从上边两幅图可以很清晰的看到，对于并发访问的页面请求，通过页面的缓存可以极大的减少对紧缺资源（数据库连接）的调用，减少访问响应的时间，从而提高系统的访问速度和整体性能。

	集群模块：

集群目标：
	支持更大的访问量，并且可以随着访问量的增加可以通过增加服务器的方式很容易的增加处理能力，而不增加用户的访问时延。
	提高系统稳定性，提供几乎永不停机的服务质量。即使某一台服务器软件或者硬件崩溃系统仍然能对客户提供服务。

网客通平台集群实现了以下功能：
1.	Session复制
使用应用服务器自带的Session复制功能。
如开源的Tomcat，Tomcat5.5带有Session复制功能。Tomcat5.5的Session复制功能有如下的特点：
		需要保证Session中的所有的对象都是可序列化的。
只有调用session的SetAttribute、removeAttribute方法时才会触发session的复制。例如有一个user类型的对象u保存在Session之中，如果u.setName(“aaa”)是不会触发Session复制的，只有u.setAttribute(“user”,u)才会触发Session的复制。
		Session的复制是一个all-all的复制，也就是说Session的每次复制都复制给集群中的每一台服务器。

由于Session的复制是All-All的，因此当服务器中的集群数量过多时，有可能发生集群之间的Session复制流量过大，本身成为了性能的瓶颈。针对这个情况一方面要尽量的减少复制的数据量，这就要求将保留在session中的对象尽量变得更小，例如应该尽可能的拆分开对象。因为一个大对象只要一个小的属性发生了变化则整个对象都要被复制，如果将对象拆分开则只要复制一个小对象就可以了，尽量将保存在session中的对象变小。
另一方面，当集群中的服务器数目真的变得很大时，单靠缩小session中的对象已经是没用了，这样的话我们还有两种技术方案：
	将集群分域，即将大的集群分成几个小的集群，Session复制只在小集群内部发生。
	主——从session复制，即将所有session 保留在中心的一台或几台服务器中，并不向集群中的所有服务器复制。

2.	Cache复制和更新
网客通平台的Cache分成两类，页面Cache和对象Cache。页面Cache我们现在采用jcs包。Jcs包中带有Cluster功能，能够将Cache内容复制到整个集群的服务器中。该功能需要满足以下条件：
		需要保证Cache中的所有的对象都是可序列化的。
		只有调用Cache的setObject、removeObject方法时才会触发session的复制。
事务型的cache
在实际的使用中，Cache起到了巨大的作用，但是也存在有问题。Cache是非事务化的，即如果在使用过程中，在没有关闭Cache的情况下突然关闭服务器，或者服务器突然Down了，则缓存有可能被破坏。在集群环境下，则缓存会在服务器重起的时候从其他服务器中复制过来。
在正常使用时 Cache能达到上 G的数量级，如果集群中某台服务器崩溃后损坏了Cache则在服务器重起的时候将有几G的数据需要复制过来，这样有可能造成网络诸塞，成为整个系统的性能瓶颈，因此我们采用事务型的 Cache，保证系统崩溃后，重起的时候只有少部分的数据需要从其他服务器上复制过来。
对于cache的事务管理，我们采用Berkeley DB，Berkeley DB是历史悠久的嵌入式数据库系统，主要应用在UNIX/LINUX操作系统上，其设计思想是简单、小巧、可靠、高性能。当数据类型较少（特别注意：这并不是说需要管理的数据量小），数据管理本身不复杂，且对数据操作要求高效率时，使用Berkeley DB是一个很好的选择。Berkeley DB是一个具有工业强度的嵌入式数据库系统，数据处理的效率很高。Berkeley DB功能的稳定性历经时间的考验，在大量应用程序中使用便是明证。可以想见，在同等代码质量的条件下，软件的BUG数和代码的长度是成正比的，相对几十兆、几百兆大型数据库软件，Berkeley DB的只有不到500K的大小，但可以管理大至256T的数据量。从这些特性看来，cache非常适合使用Berkeley DB进行管理。

	.	上传文件的共享
我们采用共性文件形式的文件共享，主要使用磁盘阵列技术，简称RAID(Redundant Arrays of Inexpensive Disks)。磁盘阵列是由一个硬盘控制器来控制多个硬盘的相互连接，使多个硬盘的读写同步，减少错误，增加效率和可靠度的技术。
磁盘阵列有以下优点：
		传输速率快
		储存容量可提升
		提升I/O每秒的数量
		增加数据安全性及稳定性
		大量数据快速及简易管理
		增加可用运时间，减少维护
		通过磁盘阵列，可以将不同服务器上传的文件统一管理。


如图所示：各台服务器共享磁盘阵列，这样所有的上传的文档都放到磁盘阵列之中。

4.	Cookie的共享
采用负载均衡器使得多台服务器对外有相同的IP这样就能使所与的服务器都能共享Cookie。同时采用这个方案还能保证系统的高可用性。具体可参照下一点。

	.	高可用性
我们建议采用负载平衡器，负载均衡器可以根据实际的响应时间制定优先级交付决策，从而实现高性能、智能化流量管理，达到最佳的服务器群性能。采用第七层应用控制还可以减少通信高峰期的错误讯息，因为差错控制和流量管理技术可以侦测到一些错误信息，并透明地将会话重定向到另一个服务器，使用户顺利地进行使用。例如，服务器A不可用或者数据库出现错误，错误信息将会返回到负载均衡器上，然后会将客户的访问指向服务器B或者将消息重放到其他数据库中去，整个过程对用户是透明的。
将内部的多个私有ＩＰ的服务器，对外映射成一个相同的IP。而且当其中某台服务器Down掉的时候，负载均衡器将不会将这个服务器映射出去。

 

6.	数据库集群
如果数据库是用Oracle的话，数据库集群可以采用Oracle RAC。基于RAC的网上商城应用的用户或者中间层应用服务器客户，可以通过虚拟数据库服务名连接到数据库上。Oracle在集群中多个节点之间自动平衡用户负载。不同节点上的Real Application Clusters数据库实例预订所有数据库服务或者部分子集数据库服务。这使得DBA高度灵活地选定，连接到特定数据库服务的特定应用程序客户是否可以连接到某些或者全部的数据库节点。RAC在工作期间，每个节点可以单独的被使用并且被应用程序负载均衡。如果发生意外，如一个节点的失败，可以实现节点的失败切换，保证数据库24*7的高可用性。
虽然每一个节点有一个不同的物理IP地址时，应用客户仍可以在一个逻辑数据库服务名的水平上进行连接。因此客户端对于不相关的事情如多服务器的多个地址可以毫不关心。


	任务调度模块：
对于电子大型的成熟的网上商城平台系统，每天都有很多特定的数据需要进行分析或处理（比如：每天都有大量的邮件需要发送）。对于大数据量、高数据运算的处理功能，往往不希望在系统繁忙的时间进行处理。
针对这种状况，系统采用Jcrontab提供的基础服务，通过Jcrontab接口的扩展，实现对系统自动执行的任务灵活的、人性化的配置。管理员可以根据系统的实际情况，配置相应的系统任务来执行。
6.1.1.4	应用层
应用层提供各种业务实体的操作，使用EMALL基础服务进行搭建。
应用层的基本设计都是建立在EMALL基础服务层之上。就是栏目——属性/权限——业务实体。所有业务都可以在栏目中统一管理，从而使用统一的权限配置，使用分层的动态属性这些基础功能。
这样做的好处是，当业务实体发生改变或者是有新的业务时，系统的基础架构都不需要做出任何调整，直接就可以使用原有的功能。比如说订单系统，订单系统可以处理的就是一个业务实体，如果平台现在要加上网上购买服务的功能，那么只需要新加一个订单类型，就可以好像处理一般的商品订单那样处理这种购买服务的订单。

一、	商品管理
1)	商品分类管理：包含对商品分类的增删功能。
商品分类使用栏目实现，这样的话就可以动态添加无限级的商品分类，而且由于是树状结构，父级分类与子级分类之间可以实现继承。

2)	商品属性和属性组管理：对商品类别设置属性，属性组的功能。
属性组建立于商品分类之上，这样做的好处是可以实现属性的继承，只要在某类商品加一个属性组，就可以对此分类下所有商品配置属性组中的属性。
对于属性中的图片类型，系统可以做特别处理
	生成指定大小的图片：通过ImageIO将图片大小改变后输出，可以生成jpg、bmp、png、gif这几种格式。
	对图片加上水印：将水印图覆盖到原图上，生成一幅带水印的图片。可以配置多张水印图，在配置商品的时候选择其中一张来加水印。

3)	商城商品管理功能：可以对商品数据进行增删改等操作。
商品管理重点在于配置商品属性，商品属性来自于商品类别中配置的属性组。使用商品属性有以下优点：
	可以实现在前台根据商品属性来实现智能化搜索（比如可以在前台空调类别页面中输入一个“匹数”范围来搜索，也可以输入一个“功率”范围来搜索。）
	可以实现很强大的相关产品功能，系统可以把属性匹配，价格接近的商品放到商品的相关商品列表中，由于这些商品很接近用户浏览的当前商品，所以可以起到吸引客户的作用。
	可以实现基于基准值的商品资料录入，就是可以限制某个属性管理员能够输入的值，一定程度保证了商品资料的准确。
	商品属性配置使用标签库输出，可重用性高。

4)	组合商品管理：配置组合商品。
组合商品分为普通组合商品和高级组合商品：
	组合商品是指：一个商品包括一个或一个以上的配件，每一个配件都包含若干个普通的商品。当客户在商城前台将此组合商品加到购物车时，客户需要对每个配件选择一个商品，整个组合商品的价格就是这些选择了的商品价格之和。
	高级组合商品是指：一个商品包括一个或一个以上的配件，每一个配件都包含若干个普通的商品。当客户在商城前台将此高级组合商品加到购物车时，客户需要对每个配件选择一个商品，和组合商品的不同在于，高级组合商品的价格是由管理员在系统后台对于每一种组合都设置的一个价格，而不是选择出的商品的价格之和。
组合商品的配置：选择商品加到组合商品中，并可以设置商品是否为可选。
	配置界面主要用javascript实现，操作方便，减少服务器负担；
	由于参数是动态的，为了一次将配置传到服务器，将参数转成xml格式传递，到服务端再进行解析。

5)	分站配置商品功能：包含分站对商品价格，组合商品价格，商品上下架状态等管理。
需要特别说明的是对于普通组合商品的价格是不用配置的，因为这是根据客户选择的商品组合计算出来，而高级组合商品的价格则需要对于每个组合配置价格。
		
6)	商品推荐功能：包括手工推荐和自动推荐功能。支持复杂的自动推荐规则。
为了有效管理摆放在前台页面上的商品，系统商品推荐模块。它的功能包括：
	设置前台推荐类型。
	为各推荐类型配置推荐的规则。
	系统自动根据推荐规则推荐商品到前台。
	手动把商品推荐到前台。
	手动设置推荐商品的前台显示位置。
	给商品图片上压上推荐的小图标。由于推荐有时间限制，所以不像商品图片那样生成又水印的图片、而是利用网页的层将水印图叠在商品图上。
	设置系统自动推荐的开关以及推荐商品的数目。
推荐规则采用通用规则的设计方法，即预先设计好几种通用的规则，如某个属性等于一个整数，或是某个属性在一个时间范围内。当需要增加一个规则设置时，只需要在数据库中增加一条记录。

7)	商品导入功能：将MIS系统的商品数据导入到本系统。
从MIS系统中导出一个规定格式的数据文件，通过商城系统的web界面上传到服务器，系统将读取上传的数据文件，经过初步分析保存于临时表中，以提供下面的管理员分析筛选后最终更新到商城的商品信息中。
从MIS导入的数据是不能保证完全正确或者符合业务规则的（比如在MIS数据中发现一个手机的价格1元，第一个反应就知道这是个错误的数据）；在MIS数据导入处理时候，将提供对这些数据进行分析筛选，避免在商城中也有错误数据出现的情况。
系统可以自动分析筛选出如下数据：
	价格和库存信息符合规则的并且与现在商城中的价格和库存信息比较发生了变化的数据。这些商品信息可以更新到商城的商品信息中，这个称为“可导入的商品列表”。对这个列表可以选择部分进行更新，也可以全部批量进行更新。
	价格和库存信息不符合规则的并且与现在商城中的价格和库存信息比较发生了变化的数据。这些商品信息不可以直接更新到商城的商品信息中（比如：市场价<网购价，这些规则根据业务定义），这个称为“价格冲突列表”。对这个列表的数据管理员可以进行更新处理，然后加入到“可导入的商品列表”。
	类似于1元手机这样的商品列表，这个称为“价格异常商品列表”。
	在商城中没有找对应的上传的MIS数据商品信息，这个称为“商城没有经营的商品”。对这些MIS数据商品信息，管理员可以选择进行自动经营。
可能上边提到的一些分析、筛选并不适合你要运营的业务需求，其实具体的数据分析筛选，是根据商城运营的业务规则来定义的，我们可以从具体的业务出发，实现更多的功能。
在进行大批量数据更新、筛选处理时，可能出现长时间等待的情况，那么系统实现了将该处理操作放进队列中，管理员进行其他的管理操作，过一段时间后再回来检查处理的完成情况。

8)	商品特卖功能：可以对商品设置特卖，在特卖期的商品按特卖价销售。
特卖商品：在某一段时间内对某商品进行限定数量的以特殊价格进行销售，同时限定一个用户一次最多可购买的数量。
在特买设置中，可设置分部经营商品对应的一个或多个网站MIS商品进行设置，如果只设置该分部经营商品对应的部分的网站MIS商品为特卖商品，那么没有设置为特卖商品的网站MIS商品将在其他商品的特卖期内前台用户不能进行选购。

9)	商品缺货登记管理：可以对处于缺货状态的商品进行管理。
处理通过客户对缺货商品的需求，管理员可根据当前商品库存手工生成订单。

10)	相关产品/相关配件功能：可以对商品设置相关的配件或商品，让前台用户浏览。支持自动计算。
相关产品是指通过一定的规则，将多个商品和某个商品关联起来，当客户在商城前台浏览商品的时候，可以通过相关产品找到与某个商品类似的其他商品，方便客户购买。
	相关产品的规则：
a)	与当前产品有三个以上的相同的重要属性。
b)	相关产品的价格与当前产品的价格相差在（－N，＋N）之间。
	相关产品主要通过系统自动生成，管理员也可以手工进行修改。
	组合商品和高级组合商品由于没有一个固定的价格，所以无法对组合商品和高级组合商品自动生成相关产品。
	由于规则涉及到价格，所以相关产品只能在分站中配置。

11)	商品后台搜索功能：可以方便的对商品进行搜索并进行常用的操作。

二、	拍卖管理
	自动出价功能：此功能方便竞拍用户。帮助用户为想要出价的产品自动出价。
	一口价功能：提供了另一种时尚的拍卖方式。只要为拍卖商品设定一口价后，前台用户就可以用一口价购得商品。
	支持荷兰式拍卖：出价较高者优先获得所需数量的商品，最后一位购买者可以拒绝购买未达到所需数量的商品。例如，如果用户出价购买5件商品，拍卖结束后仅得到2件，则用户不必购买其中任何一件商品。所有购买者对每件商品都以相同的价格付款，即最低成功出价的金额。此金额可能低于一些用户的出价。荷兰式拍卖的简单原则：价高者优先获得商品，相同价格先出价者先得。成交价格是最低成功出价的金额。
	最低价：为商户提供了拍卖商品的最安全的保证。如果为拍卖的商品设定了最低价和代出价用户后，每隔一段时间（管理员设定），系统就会检查此拍卖商品的当前价格是否小于最低价，如果小于最低价，就会以设定好的用户为商品出价。这一过程直到拍卖商品的当前价格大于等于最低价，或商品拍卖结束。这样就可以为商户提供了保证，使商品不会低于预期的价格被卖出。

三、	网上团购
网上团购是一种非常有利商户的商品出售方式。
团购是商户出售商品的一种方式，商户为商品设定了商品出售数量与对应的价格，一般购买的人越多，出售价格越低，通过这种方式来吸引用户的购买。这种方式已经为不少商户带来了很好的收益，所以越来越多的商户喜欢就种出售商品的方式。
网上团购是一种新式的团购，用户不用像以往一样跑到门店团购。只要上网，就可以方便的与不认识的其它网络用户一齐参与团购。网上团购比门店团购的好处是，参与网上团购的人数会比较多，用户因此很容易得到低价，所以很多用户会选择网上团购的方式进行团购。形成了一种良性循环。非常有利商户。

四、	广告管理
广告位：系统根据前台页面的设计，定义一个区域用于显示广告内容，那么这个区域就是一个广告位。对应这个区域有相关的属性（比如：宽，高等等）。后台管理员可以对这个区域进行广告设置，前台动态的根据管理员设置，在区域内显示相应的内容。
意义：对商城的页面进行广告位的划分，可以对不同的位置定义相应的广告内容，有效的管理；同时可以对不同页面的访问量等参考资料信息进行不同广告位广告的设置，以达到最佳的效果。
系统支持对一个广告位设置多个广告，同时在广告位中设置相关的属性（比如：是否对广告位进行轮换，轮换的时间等），前台将按广告位设置的规则对设置的广告进行轮换显示。这个功能可以对相使紧缺的广告位资源得到更充分的利用。
系统支持多种广告类型的设置（比如：flash广告,图片连接广告，自定义广告，浮动的广告），其中自定义广告支持广告模板功能。
系统可以对商城中所有商户的广告位设置一个默认广告，默认广告位中显示的广告商城管理员可以动态的设置处理。如果某个商户因为人力原因或者其他原因没有对某广告位进行设置，那么前台在该广告位显示默认商城默认的广告位，从而保证了前台显示界面的美观、协调。

五、	信息发布
信息编辑使用javascript编写的一个编辑器，和一般网上编辑器相比，有以下特殊功能：
	支持任意多个图片的插入排版操作。在编辑的时候可以选择网上的图片连接也可以在本地上传图片进行插入，同时可以调整图片显示的大小等。
	支持在商城商品目录书中选择商品，那么将有多种商品图片的显示形式供选择插入，插入后图片的连接将直接连接到商品详细页面，同时也可以手工改变连接路径。
	系统提供了信息的模板管理功能。可以在系统中增、删、改、查模板，在编辑新闻信息时候可以应用模板进行，这样只要在已经编辑好的通用模板中修改部分的文字或者图片或者连接等，极大的提高信息编辑管理速度，同时也可以使信息的排版更加美观。模板是一个html的资源包，格式为zip，里面可以包括html、javascript、css、图片等文件，系统读入此资源包并将其作为一个模板。模板中资源的文件路径会自动进行替换。
	支持任意多个图片的插入排版操作。在编辑的时候可以修改下载的文件的连接显示说明。
	支持插入flash、wav等通用的网上传播媒体元素。所有的操作都简单到选择本地文件上传，系统将自动区分上传的文件，做相应的代码插入，直接可以看到预览效果。

六、	排行榜管理
排行榜分为降价排行榜，销售排行榜，访问量排行榜三种。每种排行榜在计算时间段上又分为日排行，周排行，月排行，当前月排行，年排行，当前年排行几种，下面对各种排行榜及各种时间段类型的计算规则进行说明。
	排行榜计算时间段规则
1)	系统计算日排行时，是计算当前日的前一天的0点0分到前一天的24点0分的排行，根据排行榜计算公式计算出来的排行。比如，3月4号某用户在前台查看访问量日排行，看到的排行就是对3月3号0点0分到3月3号23点59分的商品访问量的一个排行。
2)	系统计算周排行时，是计算当前周的前一周的周一0点0分到周日的24点0分的排行，根据排行榜计算公式计算出来的排行。比如，3月15号某用户在前台查看访问量周排行，看到的排行就是对3月7号（上周1）0点0分到3月13号（上周日）23点59分分的商品访问量的一个排行。
3)	在前台或者后台，查看月排行时，默认看到的是当前月的排行（即当月第一天0点0分到系统计算排行的时间这个时间段的排行），当在前台或者后台历史查看中选择查看某月排行，看到的就是，系统计算出该月的第一天0点0分到最后一天23点59分的排行。
4)	在前台或者后台，查看年排行时，默认看到的是当前年的排行（即当年第一天0点0分到系统计算排行的时间这个时间段的排行），当在前台或者后台历史查看中选择查看某年排行时，看到的就是，系统计算出该年的第一天0点0分到最后一天23点59分的排行。
	各类别排行榜计算公式
1)	自动计算的销售排行某时间段（时间段规则参照上面的排行榜计算时间段规则）的销售量。在不手动干预的情况下，销售量大者排前。
2)	自动计算的降价排行某时间段（时间段规则参照上面的排行榜计算时间段规则）的降价比，并排序。降价比的计算公式为：（起始时间产品商城价-终止时间产品商城价）*100/起始时间产品商城价。
比如计算2月的降价排行，那么就把2月1号0点0分某产品商城价和2月28日23点59分该产品商城价套入上面公式计算出降价比，降价比高者排前。
3)	自动计算的访问排行某时间段（时间段规则参照排行榜计算时间段规则）的产品访问量。在不手动干预的情况下，访问量大者排前。

由于计算排行榜数据量巨大，所以为了提高性能，程序计算出排行榜后会把结果保存，以后当用户再去查看时，就直接取出结果，然后过一段时间，系统进程就会自动重新计算排行，具体重新计算的时间根据排行榜时间段类型不一而不同，月排行和日排行，年排行每日更新，而周排行每周更新一次。
由于对每个商品类别都有一个排行榜，通常的统计方法对系统会造成很大负荷，我们经过多次优化，已经可以用一个sql计算出所有商品品类的访问量或降价或销售排行榜，而且计算时间只需15秒（参与计算的数据在千万级以上）
进程还提供了开关功能，当开关关上时，可以使管理员手工设置的商品一直保持在排行榜上，反之，系统更新排行榜时，会按照真实情况重新发布排行榜。

七、	问卷调查
用于收集用户感兴趣的信息资料的调查系统。模块中总部和分部公用一套操作界面。总部的管理员进去后能见到所有的问卷列表，而各分部只能看到该分部的问卷列表。问卷所属部门按增加该问卷的管理员所属的部门来区分。
问卷调查的设计思想是通用，问卷的题目囊括了所有常见类型：
	单选题：只能选择一个答案。
	多选题：可以选择一个或多个答案。
	填空题：填写简单答案。
	问答题：可以输入较长答案
	分支：实际上是单选题的变种，通过选择不同的答案，转到不同的题目中，就好像一些心理测试题。
可以将配置好问卷作为题库保存，以供重用。

八、	订单管理
	订单查询功能
在信使网客通电子商城系统中，管理员可以根据订单号、收货人或购买人的姓名、固定电话、移动电话、电子邮件、订单的金额、下订单的时间、用户注册网站的帐号、订单处理过程中的不同状态、不同的地区或商户进行快速的整个检索，迅速的找到需要处理的订单。
	改变订单状态
订单的处理过程中可以根据支付方式以及送货方式分为货到付款和款到发货两种。订单的处理状态也就可以定义为用户自行取消、订单开始处理、数据验证有效订单、是否有货处理、缺货等待或是可出货订单、是否已经完成支付、交易成功等等订单状态。
每一个状态可以明确的标识订单处理的情况。
	订单拆分
在很多时候，用户通常要求我们对已经下好的订单做以下处理：
	因为用户的原因，整个订单商品用户确认只要其中一部分商品舍弃另外的商品
	因为缺货，整个订单商品用户确认先送有货的商品舍弃缺货的商品
	因为缺货，整个订单商品用户确认先送有货的商品等待缺货的商品有了货再配送
这样，我们就面临着将订单进行拆分的工作。
信使网客通电子商城系统可以完全解决此类问题，可以将任何订单商品进行有效性的拆分，将暂时不能满足用户的商品从当前订单中拆分出去。
	订单调拨
订单调拨就是我们通常所说的转单。
在商城中，不同的商户具有属于自己的订单，将自己的订单转给其他的商户进行处理，我们称之为订单的调拨。
订单的调拨往往是因为商户可能经营的商品库存不足、经营范围发生改变或者送货地区太远等等原因造成的。
	订单商品销售统计
实时的对某款商品进行销售数量的统计，可以查询到包含当前商品的所有订单记录。
	电话订购单功能
很多时候，有些用户不是通过浏览网页来进行订购商品，他们会直接通过电话的方式联系我们的电子商城的管理员进行指定商品的购买，用户指定的商品包括我们网站商城所有的商品，也甚至会包括在我们网站商城不存即网上不销售在但在线下进行销售的商品。我们称这种方式进行下订的订单为电话订购单。
在信使网客通电子商城系统中，提供了易操作的输入界面给商城管理员根据用户的电话进行手工增加订单的功能，同时在手工增加订单的时候可以记录那些只在线下进行销售的商品，生成订单后，进行统一的订单流程处理。
	按岗位分权处理订单
将订单分岗位处理。

九、	管理员管理
	管理员组管理：
管理员组是用于方便对管理员的管理，管理员组的设计主要是针对权限系统的。例如：你可以对某个组赋权限，组的成员也会继承这样权限，方便管理。在这个模块中，你可增加管理员组，查看管理员组，删除管理员组，还可以把管理员加到组中，或把管理员从组中删除。
	管理员管理：
管理员管理模块用于管理员用户进行管理。此模块提供增加用户和修改用户密码等功能。

十、	用户管理
管理员可以对注册的网站用户进行统一管理。如果用户信息有误需要修改时，可以在前台的用户专区进行修改，也可以让管理员在后台进行修改。同样，如果用户的登陆密码忘记了，可以在前台找回密码，管理员也可以对用户的密码进行修改，然后通知用户并让其进行修改新的密码。如果出现非正确性的用户资料，管理员可以将其删除。

十一、	支付方式
当用户在商城进行购物的时候，商城支持自定义的支付方式，如货到付款、或者各种银行的网上支付。注意，此模块的增删改操作都需要程序方面的支持。
总站配置的支付方式，可以提供给分站使用，每个分站都可以由自己特有的支付方式。
支付方式使用面向接口的方式设计，通过实现接口的方法，可以很方便的增加新的支付方式。而不需要修改已有的程序。
更为方便的是，支付模块实现了接口模板，管理员只需要直接在网站上输入支付接口部分代码，系统会自动将代码填到模板中并编译成class文件，就是说管理员不需要有java环境也可以更新支付方式。

十二、	配送方式
配送方式主要是针对送货费用的计算。
总站配置的配送方式，可以提供给分站使用，每个分站根据自己送货费用的计算方法不同而配置。
配送方式使用面向接口的方式设计，通过实现接口的方法，可以很方便的增加新的配送方式。而不需要修改已有的程序。
更为方便的是，配送方式实现了接口模板，管理员只需要直接在网站上输入配送方式接口部分代码，系统会自动将代码填到模板中并编译成class文件，就是说管理员不需要有java环境也可以更新配送方式。

十三、	热门关键字
每个商户都可以在自己的首页上配置一些关键字，用户点击了这些关键字就可以搜索到相应内容。
热门关键字可以由商户手工配置，手工配置时，可以从现有的关键字访问量排行列表中选取（后台根据用户在前台搜索框中输入的内容计算的关键字访问量排行），也可以自己另行增加。
默认情况下，系统自动根据后台关键字访问量排行，选取前几个配置上去。
可以把某些关键字设置到黑名单中，这样该关键字就不会计算这些关键字的访问量了，以后也不会把这些关键字自动配置到前台了

十四、	订阅管理
为了达到更好的网站宣传效果，向用户宣传用户关心的信息以及商品信息，本系统提供了订阅系统，他可以由用户自行选择自己感兴趣的信息或者商品版块（用户所订阅的版块可以根据具体的客户要求进行定制），选择后，系统会根据管理员配置的周期通过邮件自动发送到用户的邮箱中。
系统实现了邮件群发功能。邮件服务器IP、端口、用户名和密码都可以动态配置。
用户选择了订阅的版块后，系统会根据管理员配置的周期定期生成用户邮件地址列表，进行邮件发送，而不需要任何的人工操作，方便了客户使用。

十五、	BBS
基于栏目模块设计的一个简单的BBS系统，主要供后台管理员使用。实现了基本的发贴回贴、封IP、设置论坛栏目等功能。

6.1.1.5	业务表现层、系统接口层
业务表现层和系统接口层是网客通对外的接口，下面分别进行介绍。

6.1.1.5.1	业务表现层
业务表现层就是网客通最终对客户的接口，平台以网页的方式提供各种业务供客户使用。相当于View（视图），与应用层（Model）、Servlet（Controller）组成Model / View / Controller（MVC)结构。主要是用JSF架构实现。

6.1.1.5.2	系统接口层
系统接口层是网客通对外部系统的接口。提供各种数据导入导出，数据查询等功能。
网客通平台主要使用WebService提供系统接口。
实际上，Web Service的主要目标是跨平台的可互操作性。为了达到这一目标，Web Service 完全基于XML（可扩展标记语言）、XSD（XML Schema）等独立于平台、独立于软件商户的标准，是创建可互操作的、分布式应用程序的新平台。使用Web Service有以下优点。
1.	跨防火墙的通信
出于安全性考虑，服务器通常只对公网开放80（HTTP）端口，WebService使用Http协议进行传输，正好能自由穿越防火墙。
	.	应用程序集成
在企业中会有其他的应用程序，比如说MIS、CRM等，这些应用可能是建立在不同的平台之上，比如说.Net。那么网客通和这些平台集成的话就会存在很大的问题，因为我们采用的是J2EE。解决这应用程序集成的最佳方案就是WebService了。通过Web Service，应用程序可以用标准的方法把功能和数据“暴露”出来，供其它应用程序使用。
	.	B2B的集成
同样的，将上面的一个问题扩充到企业和企业之间，跨公司的商务交易集成通常叫做B2B集成。不同企业所采用的平台就更加五花八门了。
Web Service是B2B集成成功的关键。通过Web Service，公司可以把关键的商务应用“暴露”给指定的商户和客户。
用Web Service来实现B2B集成的最大好处在于可以轻易实现互操作性。只要把商务逻辑“暴露”出来，成为Web Service，就可以让任何指定的合作伙伴调用这些商务逻辑，而不管他们的系统在什么平台上运行，使用什么开发语言。这样就大大减少了花在B2B集成上的时间和成本。
	.	软件和数据重用
软件重用是一个很大的主题，重用的形式很多，重用的程度有大有小。最基本的形式是源代码模块或者类一级的重用，另一种形式是二进制形式的组件重用。
Web Service在允许重用代码的同时，还可以重用代码背后的数据。
	.1.2	架构特点
我们的技术架构有以下特点：
		层次清楚，多层的结构，每一层的作用都有明确的规定；
		具有很强的稳定性，多层结构，每一层都相对稳定，只要接口不变，每一层的改变都不影响其他层；
		基于组件技术，力求将变化封装在组件内部；
		适应能力强，同步、异步都能处理，既能满足快速反映的业务的需求，又能满足大数据量、复杂的、异步的业务的需求；
		与OS、中间件平台、数据库系统无关。
		具有很好的可扩展性。模块化使得系统很容易在纵向和水平两个方向拓展：一方面可以将系统升级为更大、更有力的平台，同时也可以适当增加规模来增强系统的网络应用。在扩充或修改功能时，基本不会破坏原有结构的稳定性。
	.1.3	系统设计原则
网上商城系统工程建设是一个长期而复杂的过程，为保证整个工程建设目标的实现，系统的方案设计将坚持如下基本原则：
	.1.3.1	先进性原则
由于IT技术发展的速度惊人。因此，在网上商城项目进行系统总体规划时，我们选择业界到目前为止先进和成熟的技术作为整个系统的技术架构，以保证系统有不断发展和扩充的余地。
系统总体设计的先进性原则主要体现在以下几方面：
		系统结构选择当前先进的J2EE多层B/S架构进行系统开发；
		软件的设计中利用先进的面向对象技术、设计模式和组件技术来提高软件的通用性和复用性；
	.1.3.2	实用性、操作性原则
衡量一个系统的好坏决不是看它投入了多少、如何的先进，而是看它是否真正满足业务需求，是否真正实用。因此，在进行系统的建设时，始终不忘实用性原则，努力保证投资花在实处，保证建设出来的系统切切实实是所需要的，而不是一个富丽堂皇的空架子，光有一个外表而没有实际的内容。
实用性是每个信息系统在建设过程中所必须考虑的，从实际应用的角度来看，这个性能更加重要。为了提高系统的实用性，本系统考虑如下几个方面：
A、设计上充分考虑当前各业务层次、各环节管理中数据处理的便利和可行，把满足用户业务管理作为第一要素进行考虑；
B、采取总体设计、分步实施的技术方案，在总体设计的前提下，系统实施时先进行业务处理层及低层管理，稳步向中高层管理及全面自动化过渡。这样做可以使系统始终与业务实际需求紧密连在一起，不但增加了系统的实用性，而且可使系统建设保持很好的连贯性；
C、.全部人机操作设计均充分考虑不同使用者的实际需要；
D、用户接口及界面设计充分考虑人体结构特征及视觉特征进行优化设计，界面尽可能美观大方，操作简便实用。
		统一及一致性原则
在统一的用户界面风格前提下，实现各GUI中各类按钮、图标、文字（字体、大小）、热键（快捷键）的统一和一致，达到便于使用、便于学习、交互友好的目的。
		人机工程及标准化原则
在保证界面风格统一、一致的基础上，按照人机工程原理，遵循IBM 和 Microsoft的界面设计标准，将界面的布局（包括按钮、菜单、显示框等）设计成符合操作者习惯的形式，并在界面颜色的搭配上满足操作者长时间工作要求，提供一个人性化的人机操作环境，以保证用户使用的舒适性。
		业务引导及易用性原则
充分考虑业务的管理需求，在界面的菜单及功能的组合设计中，将界面的操作顺序按业务归类，以便操作的有效引导，保证软件的易用性。同时，在各功能名称的用词、信息提示文字等方面，使用政府审批业务的规范化、习惯化用词，以保证软件使用者的习惯性，符合现有政府审批管理模式，有利于操作者在较快的时间熟练用好软件。
		友好及方便性原则
鼠标、键盘的灵活输入方式；热键的使用，以保证各种业务数据信息的录入界面，更新维护界面和记录增删界面及部门内部信息查询界面和信息统计报表界面等使用的方便性、友好性，确保各种业务信息数据都能通过用户界面方便地、快速录入。

	.1.3.3	投资保护原则
系统建设充分考虑目前已实施的业务系统的实际情况，充分利用原系统资源，在实现新系统建设同时保护原有系统的投资。
任何一个系统的建设，如果不能合理和有效地利用以前的投资，这样的系统应该算不了成功或绝对的成功。因此，在进行该系统建设时，充分考虑如何利用以前的信息系统、网络和其他设备，并对以前实施的应用系统进行整合，一方面保证原有的设备可以重新利用，另一方面保证以前的应用重获新生。在真正意义上做到既完成了新系统的建设又保护了原有设备和系统的投资。

	.1.3.4	安全性、可靠性原则
考虑到网上商城系统工程建设项目安全性、可靠性的需求，在系统设计中，应充分注意系统的安全性和可靠性，采用多种安全防范技术和措施，保障系统的信息安全，保障系统长期稳定可靠运行，同时在系统设计要充分考虑系统运行性能，达到“简便、实用、快捷、安全、准确”的目的。

 

6.2	运行环境要求
运营环境包括以下几方面的因素：
	软件环境，包括操作系统和数据库系统、其他系统软件支持等。
	硬件系统，包括服务器配置，备份设备，安全设备等
	网络环境，包括网络带宽，网络拓扑结构设计
以上各因素需要根据系统未来发展的定位，企业人力配置，系统对接需求来具体考虑。因此，在此我们只是简单提出建议。下面我们就着重来分析商城系统建设对硬件环境和网络环境的要求。
6.2.1	软件环境
在软件环境建议方面，本系统基于JAVA架构开发，因此可适应大部分的操作系统，主要涉及到以下几方面的内容：
1.	操作系统：Window Server 2003 / Redhat EntMISrise Linux Advanced Server 4等；
	.	Java虚拟机：SUN J2SDK 5.0 / BEA JRockit 5.0
	.	应用服务器：Tomcat6.X(首选) / BEA Weblogic / JBOSS 4
	.	数据库： Oracle / MYSQL
我们建议采用分步分阶段建设的方式，逐步扩大硬件与服务器的容量配置，满足不断发展的业务与数据处理要求。
	.2.2	硬件环境
我们建议采用分步分阶段建设的方式，逐步扩大硬件与服务器的容量配置，满足不断发展的业务与数据处理要求。
		基本配置
CPU：目前主流CPU都符合系统运作要求。CPU影响平台的运算工作，速度越快越好， 
内存：Java应用对内存要求比较高，最少需要4G
硬盘：容量应该在80G以上，推荐使用磁盘阵列提高系统的速度和安全性。

基本配置为两台服务器，一台作为Web服务器、一台作为数据库服务器。
	系统集群扩展
基于对商城用户访问量的预期要求，采用系统集群技术来对系统进行扩展来满足大访问量大流量的要求。集群包括web的集群和数据库的集群，我们可以根据系统运行情况，决定对系统的哪部分进行扩容。系统的扩容需要视运营情况来最终决定一个能够满足运行需求的配置。
系统集群网络架构：

	网络环境
网络环境方面，主要需要考虑到的是网络带宽和网络拓扑结构设计等相关的问题。例如，服务器托管及网络带宽要求。建议采用服务器托管的形式。为解决网通和电信南北互通的问题，建议把服务器托管在具有网通和电信带宽的双线机房解决互联互通。







[^1]: 参见文档《网上商城业务分析>